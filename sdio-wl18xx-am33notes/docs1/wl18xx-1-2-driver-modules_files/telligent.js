(function(){var V,s;(function(f){var e={},p=function(l){var n=e[l];if(n==f)throw"Module not defined or loaded: "+l;if(n.compiled)return n.compiled;var h=[];if(n.dependencies&&0<n.dependencies.length)for(var b=0;b<n.dependencies.length;b++)h.push(p(n.dependencies[b]));n.compiled=n.factory.apply(this,h.concat(n.extraArguments));if(!n.compiled)throw"Module defined but not loadable: "+l;return n.compiled};V=function(e,n){var h=e,b=n,d=2;h.splice||(b=h,h=f,d--);for(var d=Array.prototype.slice.call(arguments,
d),a=[],c=0;c<h.length;c++)a.push(p(h[c]));b.apply(this,a.concat(d))};s=function(l,n,h){var b=n,d=h,a=3;b.splice||(d=b,b=f,a--);a=Array.prototype.slice.call(arguments,a);e[l]={dependencies:b,factory:d,extraArguments:a||[]}}})();s("components","component.bookmark component.collapseexpand component.like component.links component.moderate component.page component.rate component.searchresult component.tag component.theater component.webpreview component.tourtip component.viewhtml component.previewhtml component.masonry component.resizedimage component.tip component.select".split(" "),
function(){return{}});s("component.bookmark",["module.ui"],function(f,e,p,l){e.telligent.evolution.ui.components.bookmark={setup:function(){},add:function(f,h){f.empty();var b={contentId:h.contentid,contentTypeId:h.contenttypeid,typeId:h.bookmarktypeid,initialState:"true"==h.value,contentTypeName:h.contenttypename,onBookmark:function(b,a,c,k){e.telligent.evolution.post({url:e.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/bookmark.json?ContentId={ContentId}&ContentTypeId={ContentTypeId}"+(c?"&TypeId="+
c:""),data:{ContentId:b,ContentTypeId:a},dataType:"json",success:function(a){k()}})},onUnbookmark:function(b,a,c,k){e.telligent.evolution.del({url:e.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/bookmark.json?ContentId={ContentId}"+(c?"&TypeId="+c:""),data:{ContentId:b},dataType:"json",success:function(a){k()}})}};h.configuration.deleteBookmarkText&&(b.deleteBookmarkText=h.configuration.deleteBookmarkText);h.configuration.addBookmarkText&&(b.addBookmarkText=h.configuration.addBookmarkText);h.configuration.processingText&&
(b.processingText=h.configuration.processingText);h.configuration.addBookmarkCssClass&&(b.addBookmarkCssClass=h.configuration.addBookmarkCssClass);h.configuration.deleteBookmarkCssClass&&(b.deleteBookmarkCssClass=h.configuration.deleteBookmarkCssClass);h.configuration.processingCssClass&&(b.processingCssClass=h.configuration.processingCssClass);e(f).evolutionBookmark(b)}};return{}},jQuery,window);s("component.collapseexpand",["module.ui"],function(f,e,p,l){e.telligent.evolution.ui.components.collapseexpand=
{setup:function(){},add:function(f,h){var b=e("<a></a>").attr({href:"#"}).text(h.collapsetext),d=!1;b.click(function(){d?(f.slideUp(),b.text(h.collapsetext)):(f.slideDown(),b.text(h.expandtext));d=!d;return!1});f.removeClass().before(b).hide()}};return{}},jQuery,window);s("component.like",["module.ui","module.messaging"],function(f,e,p,l,n){var h=function(b,d,a,c){p.telligent.evolution.get({url:p.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/likes.json",data:{ContentId:b,ContentTypeId:d,TypeId:a,
SortBy:"Date",SortOrder:"Descending",PageSize:1,PageIndex:0},cache:!1,dataType:"json",success:function(a){c.call(this,{count:a.TotalCount,latestLike:0<a.Likes.length?a.Likes[0]:null})}})};p.telligent.evolution.messaging.subscribe("ui.like",function(b){(b.typeId?p('.ui-like[data-contentid="'+b.contentId+'"][data-contenttypeid="'+b.contentTypeId+'"][data-typeid="'+b.typeId+'"]'):p('.ui-like[data-contentid="'+b.contentId+'"][data-contenttypeid="'+b.contentTypeId+'"]')).attr("data-initialstate",b.liked.toString()).attr("data-initialcount",
b.count.toString()).attr("data-initialmessage",b.message.toString())});p.telligent.evolution.ui.components.like={setup:function(){p.fn.evolutionLike.delegatePopups({containerSelector:".content-fragment",delegatedSelector:".ui-like",onList:function(b,d,a,c,k,g){p.telligent.evolution.get({url:p.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/likes.json",data:{ContentId:b,ContentTypeId:d,TypeId:a,SortBy:"Date",SortOrder:"Descending",PageSize:k||20,PageIndex:g||0},cache:!1,dataType:"json",success:function(a){p.telligent.evolution.batch(function(){p.each(a.Likes,
function(a,c){p.telligent.evolution.get({url:p.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/ui/image.json",data:{url:c.User.AvatarUrl,maxWidth:32,maxHeight:32,resizeMethod:"ZoomAndCrop"}}).done(function(a){c.userAvatarHtml=a.Html})})}).done(function(){c({likers:p.map(a.Likes,function(a){return{displayName:a.User.DisplayName,profileUrl:a.User.ProfileUrl,avatarHtml:a.userAvatarHtml}}),hasMorePages:(a.PageIndex+1)*a.PageSize<a.TotalCount})})}})},onOptions:function(b){b=p.telligent.evolution.ui.data(b);
return{contentId:b.contentid,contentTypeId:b.contenttypeid,typeId:b.configuration.LikeTypeId}}})},add:function(b,d){var a="true"===d.readonly;p(b).evolutionLike({contentId:d.contentid,contentTypeId:d.contenttypeid,initialState:d.initialstate,initialMessage:d.initialmessage,initialCount:d.initialcount,format:a?d.format.replace("{toggle}",""):d.format,typeId:d.configuration.LikeTypeId,onLike:function(a,b,g,d){p.fn.evolutionTip.hide();var q={ContentId:a,ContentTypeId:b};null!==g&&0<g.length&&(q.TypeId=
g);p.telligent.evolution.post({url:p.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/likes.json",data:q,cache:!1,dataType:"json",success:function(r){h(a,b,g,d)}})},onUnlike:function(a,b,g,d){p.fn.evolutionTip.hide();var q={ContentId:a};null!==g&&0<g.length&&(q.TypeId=g);p.telligent.evolution.del({url:p.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/like.json",data:q,cache:!1,dataType:"json",success:function(r){h(a,b,g,d)}})}})}};return{}},jQuery,window);s("component.links",["module.ui","lib.dynamicLinks",
"lib.sheetProvider","lib.util"],function(f,e,p,l,n,h,b){function d(b,g,d){!0===b.data("linkshown")?(b.data("linkshown",!1),n.fn.uilinks.hide()):(n.telligent.evolution.messaging.publish("ui.links.show"),n(window).width()<q.minWidth?c(g,d):a(b,g))}function a(a,c){a.css({position:"relative "});for(var b=n(document.createElement("ul")),g=0;g<c.length;g++){var d=n(document.createElement("li"));d.append(n(c[g].element).css("float","none").get(0));b.append(d)}b.on("mouseleave",function(){n.fn.uilinks.hide();
a.data("linkshown",!1)});m?m.glowPopUpPanel("hide").glowPopUpPanel("empty","").glowPopUpPanel("append",b).glowPopUpPanel("show",a):m=n("<div></div>").glowPopUpPanel({cssClass:"links-popup-panel",zIndex:1500,hideOnDocumentClick:!0}).glowPopUpPanel("append",b).glowPopUpPanel("show",a).on("glowPopUpPanelHidden",function(){a.data("linkshown",!1)});a.data("linkshown",!0)}function c(a,c){var b=a.slice(0);b.push(c);p.actionSheet.show({links:n.map(b,function(a){return a.element})});p.actionSheet.content().on("click",
"a",function(a){p.actionSheet.hide()});c.element.on("click",function(a){a.preventDefault();p.actionSheet.hide();n.telligent.evolution.messaging.publish("ui.links.hide");return!1});var g=n.telligent.evolution.messaging.subscribe("sheet.closed",function(){n.each(a,function(a,c){k(n(c.element))});n.telligent.evolution.messaging.unsubscribe(g)})}function k(a){a.is('[class^="ui-"]')&&!a.hasClass("ui-tourtip")?a.empty().remove():a.detach()}function g(a,c,b){clearTimeout(a.reflowWaitTimeout);n(h).width()<
c.width()?(a.reflowWaitCheckCount++,10>a.reflowWaitCheckCount&&(a.reflowWaitTimeout=setTimeout(function(){g(a,c,b)},250))):b.render()}var m;n.fn.uilinks=function(){var a=this.data("_dynamic_links"),c=Array.prototype.slice.call(arguments,0),b=c[0];if(!a)return this;if("add"==b)b=c[1],c=n.extend({},{className:null,selected:!1},c[2]||{}),a.addLink({element:b,className:c.className,selected:c.selected});else if("insert"==b){var b=c[1],g=c[2],c=n.extend({},{className:null,selected:!1},c[3]||{});a.addLink({element:b,
className:c.className,selected:c.selected},g)}else"remove"==b?a.removeLink(c[1]):"show"==b?(c=c[1]||a.moreLink().element,d(c,a.links(!0),a.cancelLink())):"hide"==b&&n.fn.uilinks.hide();return this};n.fn.uilinks.hide=function(){n.telligent.evolution.messaging.publish("ui.links.hide");p.actionSheet.hide();m&&m.glowPopUpPanel("hide")};var q={setup:function(){},add:function(a,c){a=n(a);var b=a.find("> li, > ul > li"),m=c.maxlinks,q=c.minlinks,f=null;a.removeClass("ui-links");var z={parent:a,links:[],
onShowMore:function(a,c){d(f,a,c)}};m&&(z.maxLinks=parseInt(m,10));q&&(z.minLinks=parseInt(q,10));z.direction=c.direction;for(m=0;m<b.length;m++){var q=n(b[m]),B=q.children();k(B);var l=B.is("[data-selected]");B.is("[data-more]")?(f=B,z.moreLink={element:B,selected:l,className:q.get(0).className}):B.is("[data-cancel]")?z.cancelLink={element:B,selected:l,className:q.get(0).className}:z.links.push({element:B,selected:l,className:q.get(0).className})}a.empty();var p=new e(z);a.show();c.reflowWaitCheckCount=
0;c.reflowWaitTimeout=null;g(c,a,p);a.data("_dynamic_links",p);n(window).on("resized",function(a,c){c.oldWidth!=c.newWidth&&p.render()});n.telligent.evolution.messaging.subscribe("mobile.orientationchange",function(){h.setTimeout(function(){p.render()},300)})},minWidth:570};n.telligent=n.telligent||{};n.telligent.evolution=n.telligent.evolution||{};n.telligent.evolution.ui=n.telligent.evolution.ui||{};n.telligent.evolution.ui.components=n.telligent.evolution.ui.components||{};return n.telligent.evolution.ui.components.links=
q},jQuery,window);s("component.masonry",["module.ui","plugin.evolutionMasonry"],function(f,e,p,l,n){f={setup:function(){},add:function(h,b){p(h).evolutionMasonry({columnClass:b.columnclass||p.fn.evolutionMasonry.defaults.columnClass}).css({visibility:"visible"})}};p.telligent=p.telligent||{};p.telligent.evolution=p.telligent.evolution||{};p.telligent.evolution.ui=p.telligent.evolution.ui||{};p.telligent.evolution.ui.components=p.telligent.evolution.ui.components||{};return p.telligent.evolution.ui.components.masonry=
f},jQuery,window);s("component.moderate",["module.ui"],function(f,e,p,l){var n=function(h,b,d){e.telligent.evolution.post({url:e.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/abusereports.json",data:{ContentId:h,ContentTypeId:b},cache:!1,dataType:"json",success:function(a){d(a)}})};e.telligent.evolution.ui.components.moderate={setup:function(){},add:function(h,b){h=e(h);var d={contentId:b.contentid,contentTypeId:b.contenttypeid,supportsAbuse:"true"===b.supportsabuse,initialState:"true"===b.initialstate,
onReport:n};if(b.configuration&&b.configuration.AdditionalLinks){var a=e.parseJSON(b.configuration.AdditionalLinks);if(!d.supportsAbuse&&0===a.length)return;d.onGetAdditionalLinks=function(c){c(a)}}else if(b.configuration&&b.configuration.AdditionalLinksUrl){if(!d.supportsAbuse&&0===b.configuration.AdditionalLinksUrl.length)return;d.onGetAdditionalLinks=function(a){e.telligent.evolution.get({url:b.configuration.AdditionalLinksUrl,cache:!1,dataType:"json",success:function(b){a(b.links||[])}})}}if(d.supportsAbuse||
d.onGetAdditionalLinks)b.configuration&&b.configuration.LinkClassName&&(d.linkClassName=b.configuration.LinkClassName),h.evolutionModerate(d)}};return{}},jQuery,window);s("component.page",["module.ui"],function(f,e,p,l){var n={};e.telligent.evolution.ui.components.page={setup:function(){},add:function(h,b){var d={currentPage:parseInt(b.currentpage,10),pageSize:parseInt(b.pagesize,10),totalItems:parseInt(b.totalitems,10),showPrevious:"undefined"===typeof b.configuration.ShowPrevious?!1:"true"===b.configuration.ShowPrevious,
showNext:"undefined"===typeof b.configuration.ShowNext?!1:"true"===b.configuration.ShowNext,showFirst:"undefined"===typeof b.configuration.ShowFirst?!0:"true"===b.configuration.ShowFirst,showLast:"undefined"===typeof b.configuration.ShowLast?!0:"true"===b.configuration.ShowLast,showIndividualPages:"undefined"===typeof b.configuration.ShowIndividualPages?!0:"true"===b.configuration.ShowIndividualPages,numberOfPagesToDisplay:"undefined"===typeof b.configuration.NumberOfPagesToDisplay?5:parseInt(b.configuration.NumberOfPagesToDisplay,
10),pageKey:b.pagekey,hash:b.configuration.Target,baseUrl:b.configuration.BaseUrl||window.location.href,template:"undefined"!==typeof b.configuration.Template?b.configuration.Template:' <% foreach(links, function(link, i) { %>      <% if(link.type === "first") { %>          <a href="<%: link.url %>" class="first" data-type="first" data-page="<%= link.page %>" data-selected="false"><span>&#171;</span></a>      <% } else if(link.type === "previous") { %>          <a href="<%: link.url %>" class="previous" data-type="previous" data-page="<%= link.page %>" data-selected="false"><span>&#60;</span></a>      <% } else if(link.type === "page") { %>          <a href="<%: link.url %>" class="page<%= link.selected ? " selected" : "" %>" data-type="page" data-page="<%= link.page %>" data-selected="<%= link.selected ? "true" : "false" %>"><span><%= link.page %></span></a>      <% } else if(link.type === "next") { %>          <a href="<%: link.url %>" class="next" data-type="next" data-page="<%= link.page %>" data-selected="false"><span>&#62;</span></a>      <% } else if(link.type === "last") { %>          <a href="<%: link.url %>" class="last" data-type="last" data-page="<%= link.page %>" data-selected="false"><span>&#187;</span></a>      <% } %>      <% if(i < (links.length - 1)) { %>          <span class="separator"></span>      <% } %>  <% }); %> '};
b.pagedcontenturl&&(n[b.pagedcontentpagingevent]={onPage:function(a,c,d){d=d||{};d[b.pagekey]=a;a=e.telligent.evolution.url.modify({url:b.pagedcontenturl,query:d});e.telligent.evolution.get({url:a,cache:!1,success:function(a){c(a)}})}},e.extend(d,{onPage:function(a,c,d){n[b.pagedcontentpagingevent].onPage(a,c,d)},refreshOnAnyHashChange:"true"===b.loadonanyhashchange,pagedContentContainer:"#"+b.pagedcontentwrapperid,pagedContentPagingEvent:b.pagedcontentpagingevent,pagedContentPagedEvent:b.pagedcontentpagedevent,
transition:b.configuration.Transition,transitionDuration:"undefined"===typeof b.configuration.TransitionDuration?200:parseInt(b.configuration.TransitionDuration,10)}));e(h).evolutionPager(d);if("true"===b.loadingindicator){var a=e("#"+b.pagedcontentwrapperid),c=e("<div></div>").css({backgroundColor:"#fff",position:"absolute",opacity:0.75,zIndex:1});e.telligent.evolution.messaging.subscribe(b.pagedcontentpagingevent,function(){var b=a.offset();c.hide().appendTo("body").css({width:a.width(),height:a.height(),
top:b.top,left:b.left}).show()});e.telligent.evolution.messaging.subscribe(b.pagedcontentpagedevent,function(){c.hide()})}}};return{}},jQuery,window);s("component.previewhtml",["module.ui"],function(f,e,p,l){function n(b,d,a,c){b={url:b,width:0,height:0,outputIsPersisted:!1};d&&(b.width=d);a&&(b.height=a);c&&(b.outputIsPersisted=c);return e.telligent.evolution.get({url:jQuery.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/ui/preview.json",data:b})}function h(b,d){var a=b.parent().width();a>d.width&&
(a=d.width);n(d.url,a,d.height,d.persist).done(function(a){b.html(a.Html)})}e.telligent.evolution.ui.components.previewhtml={setup:function(){},add:function(b,d){h(b,d);e(window).on("resized",function(){h(b,d)})}};return{}},jQuery,window);s("component.rate",["module.ui"],function(f,e,p,l){e.telligent.evolution.ui.components.rate={setup:function(){},add:function(f,h){var b=e.extend({},{isReadOnly:"true"===h.readonly,value:parseFloat(h.initialvalue),ratingCount:parseFloat(h.initialcount)});b.value*=
e.fn.evolutionStarRating.defaults.maxRating;b.onRate=function(b){h.contentid&&h.contenttypeid&&(b/=e.fn.evolutionStarRating.defaults.maxRating,b={ContentId:h.contentid,ContentTypeId:h.contenttypeid,Value:b},h.ratingtypeid&&(b.TypeId=h.ratingtypeid),e.telligent.evolution.post({url:e.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/ratings.json",data:b,success:function(a){a={ContentId:h.contentid};h.ratingtypeid&&(a.TypeId=h.ratingtypeid);e.telligent.evolution.get({url:e.telligent.evolution.site.getBaseUrl()+
"api.ashx/v2/rateditem.json",data:a,success:function(a){a&&a.RatedItem&&a.RatedItem.AverageValue?e(f).evolutionStarRating("option",{value:a.RatedItem.AverageValue*e.fn.evolutionStarRating.defaults.maxRating,ratingCount:a.RatedItem.Count}):e(f).evolutionStarRating("option",{value:0,ratingCount:0})}})}}))};0==b.ratingCount&&b.isReadOnly||e(f).evolutionStarRating(b)}};return{}},jQuery,window);s("component.resizedimage",["module.ui"],function(f,e,p,l){e.telligent.evolution.ui.components.resizedimage=
{setup:function(){},add:function(f,h){f.removeClass("ui-resizedimage");e.telligent.evolution.media.previewHtml(h.src,{width:h.width||0,height:h.height||0,resizeMethod:h.resizemethod||"ZoomAndCrop",success:function(b){b=e(b.html);b.attr("style")&&f.attr("style",b.attr("style"));f.attr("src",b.attr("src"))}})}};return{}},jQuery,window);s("component.searchresult",["module.ui","module.template"],function(f,e,p,l,n){var h=p.telligent.evolution.template.compile('<% foreach(properties, function(property) { %> <li class="property-item"><%= property %></li> <% }); %> '),
b=function(b,a){p.telligent.evolution.get({url:b,dataType:"json",success:function(c){c&&a(h(c))}})};p.telligent.evolution.ui.components.searchresult={setup:function(){},add:function(d,a){if(a.detailsurl){var c=null,k=d.find("ul.details"),g=k.html();d.bind("mouseenter",function(g){null!==c?k.html(c):b(a.detailsurl,function(a){c=a;k.html(c)})}).bind("mouseleave",function(a){k.html(g)})}}};return{}},jQuery,window);s("component.select",["module.ui"],function(f,e,p,l){var n=null,h=null;e.telligent.evolution.ui.components.select=
{setup:function(){},add:function(b,d){b.removeClass("ui-select");if(!n){var a=e('<span class="uiselect"><span>measure</span></span>').css({display:"none"}).appendTo(b.parent());n=a.height();h=parseInt(a.css("border-top-width")||"0")+parseInt(a.css("border-bottom-width")||"0");a.remove()}if(b.is("select")&&570<e(window).width()){var a=b.find("option").length*n,c=b.width();150>c&&(c=150);b.show().glowDropDownList({selectedItemWidth:c+20,selectedItemHeight:n,itemsWidth:c+20,itemsHeight:a+h+4,buttonImageUrl:null,
className:"uiselect"})}}};return{}},jQuery,window);s("component.tag",["module.ui"],function(f,e,p,l){var n=function(h,b,d){var a=e(d);a.html("");if(h){var c=!0;e.each(h.split(/,/),function(d,g){var m=e.trim(g);m&&(c?c=!1:a.append(", "),b?a.append(e("<a>").attr("rel","nofollow tag").attr("href",b.replace(/{tag}/g,e.telligent.evolution.url.encodePathComponent(e.telligent.evolution.html.decode(m)))).text(m)):a.append(m))})}};e.telligent.evolution.ui.components.tag={setup:function(){},add:function(h,
b){var d=jQuery("<span></span>");e(h).append(d);n(b.tags,b.urlformat,d);var a=null;"true"!==b.readonly&&(a=e('<a href="javascript:void(0);" class="internal-link edit-tags"></a>'),e(h).append(a),a.evolutionInlineTagEditor({allTags:e.grep(b.selectabletags.split(","),function(a){return a}),currentTags:e.grep(b.tags.split(","),function(a){return a}),onSave:function(a,k){var g={Tags:a&&0<a.length?a.join(","):"",ContentId:b.contentid,ContentTypeId:b.contenttypeid};b.tagtypeid&&(g.TypeId=b.tagtypeid);e.telligent.evolution.put({url:e.telligent.evolution.site.getBaseUrl()+
"api.ashx/v2/contenttags.json",data:g,success:function(a){n(g.Tags,b.urlformat,d);k()}})}}))}};return{}},jQuery,window);s("component.theater",["module.ui"],function(f,e,p,l){var n=function(){return{add:function(a,c,b,d,k,u){a={ContentId:a,ContentTypeId:c,Body:d};"undefined"!==typeof b&&null!==b&&(a.CommentTypeId=b);e.telligent.evolution.post({url:e.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/comments.json",data:a,cache:!1,success:k,error:u})},del:function(a,c,b){e.telligent.evolution.del({url:e.telligent.evolution.site.getBaseUrl()+
"api.ashx/v2/comments/{CommentId}.json",data:{CommentId:a},cache:!1,success:c,error:b})}}}(),h=function(a,c){e.telligent.evolution.get({url:a,cache:!1,success:function(a){c(a)}})},b=function(a){var c=a.content.find(".content-item.action.likes");e.telligent.evolution.messaging.subscribe("ui.like",function(b){if(b.contentId!==a.contentId||"undefined"!==typeof a.typeId&&(""!==a.typeId&&"00000000-0000-0000-0000-000000000000"!==a.typeId)&&b.typeId!==a.typeId){var d=a.content.find('li.comment[data-commentid="'+
b.contentId+'"][data-contenttypeid="'+b.contentTypeId+'"]');0<b.count?d.addClass("with-likes"):d.removeClass("with-likes")}else 0<b.count?c.removeClass("without-likes").addClass("with-likes"):c.removeClass("with-likes").addClass("without-likes")})},d=function(a){a.content.find(".internal-link.comment").bind("click",function(c){c.preventDefault();a.content.find(".comment-form").show().find("textarea").focus()});a.content.off("focus",".comment-form textarea").on("focus",".comment-form textarea",function(b){a.content.find(".comment-form").addClass("with-avatar");
b=e(b.target);b.data("theater_composer_inited")||(b.data("theater_composer_inited",!0),b.evolutionComposer({plugins:["mentions","hashtags"]}),b.evolutionComposer("onkeydown",function(b){13===b.which&&(b=e(b.target).evolutionComposer("val"),0<e.trim(b).length&&(a.content.find(".comment-form textarea").attr("disabled",!0).blur(),n.add(a.contentId,a.contentTypeId,a.typeId,b,function(a){e.evolutionTheater.refresh(c);e.telligent.evolution.messaging.publish("activity.commentadded",a)},function(c){a.content.find(".comment-form textarea").evolutionComposer("val",
"").trigger("keydown").trigger("keyup").removeAttr("disabled").closest(".comment-form").removeClass("with-avatar")})));return!0}))});a.content.delegate(".comment-form textarea","blur",function(c){a.content.find(".comment-form").removeClass("with-avatar")})},a=function(a){a.content.find(".internal-link.start-conversation").bind("click",function(a){a.preventDefault();a=e(a.target).data("conversationurl");e.glowModal(a,{width:550,height:360})})},c=function(a,c){var b=e("<div></div>").html(c).find("ul.content-list.comments");
a.find("ul.content-list.comments").replaceWith(b)},k=function(a){a.content.find(".content-item.comment").bind("evolutionModerateLinkClicked",function(a,b){var d=e(this).data("commentid");n.del(d,function(a){e.evolutionTheater.refresh(c);e.telligent.evolution.messaging.publish("activity.commentremoved",a)},function(a){})})};e.telligent.evolution.ui.components.theater={setup:function(){},add:function(c,m){c=e(c);c.bind("click",function(q){!0!==c.data("disabletheater")&&(q.preventDefault(),e(window).width()<
(m.minwidth||600)||e.evolutionTheater.show({content:function(a){h(m.theaterurl,a)},nextContent:function(a){var c=a.find("a[data-nexttheaterurl]").data("nexttheaterurl");if(c&&0<c.length)return function(a){h(c,a)}},previousContent:function(a){var c=a.find("a[data-previoustheaterurl]").data("previoustheaterurl");if(c&&0<c.length)return function(a){h(c,a)}},loaded:function(c){var g;g=e(c);c=g.find(".activity-story");g={content:g,story:c};null!==c&&e.extend(g,{contentId:c.data("contentid"),contentTypeId:c.data("contenttypeid"),
typeId:c.data("typeid")});b(g);d(g);a(g);k(g)}}))})}};return{}},jQuery,window);s("component.tip",["module.ui"],function(f,e,p,l){e.telligent.evolution.ui.components.tip={setup:function(){},add:function(f,h){e(f).evolutionTip({attribute:h.tipcontent||e.fn.evolutionTip.defaults.attribute})}};return{}},jQuery,window);s("component.tourtip",["module.ui","module.tourtips"],function(f,e,p,l,n){p.telligent.evolution.ui.components.tourtip={setup:function(){},add:function(h,b){p.telligent.evolution.tourTips.register({key:b.tourtipkey,
message:b.tourtipmessage,index:b.tourtipindex,element:h.get(0)})}};return{}},jQuery,window);s("component.viewhtml",["module.ui","module.messaging"],function(f,e,p,l,n){function h(a,b,d,m){a={url:a,width:0,height:0,outputIsPersisted:!1};b&&(a.width=b);d&&(a.height=d);m&&(a.outputIsPersisted=m);return p.telligent.evolution.get({url:jQuery.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/ui/view.json",data:a})}function b(a,k,g){l.clearTimeout(k.reflowWaitTimeout);if("none"==a.css("display")||"none"==
a.parent().css("display")||document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen||document.fullscreenElement)l.setTimeout(function(){b(a,k,g)},499);else if(!g||"viewable"==k.resizedBy){var m=p(l).width(),q=a.parent().width(),r=a.parent().height(),v="parent",u=r;if(m<q)k.reflowWaitCheckCount++,10>k.reflowWaitCheckCount&&(k.reflowWaitTimeout=setTimeout(function(){b(a,k,g)},250));else{0==q&&(q=a.parents(".layout-region-inner").width());q>k.width&&(q=k.width);if(0==r||"parent"!=k.resizedBy||
r>d)u=d,r=Math.round(0.8*d),v="viewable";r>k.height&&0<k.height&&(u=r=k.height,v="configured");k.resizedBy=v;if(u!=k.lastHeight||q!=k.lastHeight)if(m=a.width(),v=a.height(),!(q==k.lastWidth&&u<=k.lastHeight&&(v<=u||0==u)||u==k.lastHeight&&q<=k.lastWidth&&(m<=q||0==q))){var w=[],t=!0;a.children().each(function(){p(this);var a=(this.nodeName||"").toLowerCase();"video"==a||"audio"==a||"embed"==a||"object"==a?w.push(this):"script"!=a&&("style"!=a&&"meta"!=a)&&(t=!1)});t&&0<a.children().length?(p.each(w,
function(){var a=p(this),c=a.width()||1,b=a.height()||1;c/q>b/r?a.attr({width:q+"px !important",height:b*q/c+"px !important"}):a.attr({width:c*r/b+"px !important",height:r+"px !important"})}),a.trigger("rendered")):h(k.url,q,r,k.persist).done(function(b){k.lastHtml!=b.Html&&(a.html(b.Html),k.lastHtml=b.Html,a.trigger("rendered"))});k.lastHeight=u;k.lastWidth=q}}}}var d,a=!1;p.telligent.evolution.ui.components.viewhtml={setup:function(){d=p(window).height();p(window).on("resized",function(){a||(d=
p(window).height())});p.telligent.evolution.messaging.subscribe("window.scrollableheight",function(c){d=c.height;a=!0})},add:function(a,d){d.resizedBy="parent";d.lastWidth=-1;d.lastHeight=-1;d.lastHtml="";d.reflowWaitCheckCount=0;d.reflowWaitTimeout=null;b(a,d,!1);p(window).on("resized",function(){b(a,d,!1)});p.telligent.evolution.messaging.subscribe("window.scrollableheight",function(g){b(a,d,!0)})}};return{}},jQuery,window);s("component.webpreview",["module.ui"],function(f,e,p,l){e.telligent.evolution.ui.components.webpreview=
{setup:function(){},add:function(f,h){var b=h.configuration.url,d,a;"undefined"!==typeof h.configuration.maximagewidth&&(d=h.configuration.maximagewidth);"undefined"!==typeof h.configuration.maximageheight&&(a=h.configuration.maximageheight);f.hasClass("preview")||(f.parents(".ui-theater").data("disabletheater",!0),0>h.configuration.url.indexOf(e.telligent.evolution.site.getBaseUrl(!0))&&f.parents(".ui-theater").attr("target","_blank"));e.telligent.evolution.preview.load(b,{maxImageWidth:d,maxImageHeight:a,
success:function(a){a&&(a.excerpt||a.imageUrl)&&(a=e.telligent.evolution.preview.render(a,{template:e.telligent.evolution.preview.defaults.template}),"undefined"!==typeof a&&(null!==a&&0<a.length)&&f.html(a))}})}};return{}},jQuery,window);s("composers",["composer.hashtags","composer.mentions","composer.urlhighlight","composer.autocomplete"],function(){return{}});s("composer.autocomplete",["plugin.evolutionComposer"],function(f,e,p,l){var n={},h=null,b=function(){};f=function(){return{init:function(a){b=
a.settings.onSuggestionList||e.fn.evolutionComposer.plugins.autocomplete.defaults.onSuggestionList;selectSuggestion=a.settings.onSuggestionSelect||e.fn.evolutionComposer.plugins.autocomplete.defaults.onSuggestionSelect;a.input.bind(d.selectedEventName,function(){selectSuggestion(d.selection());a.release()});a.input.bind({blur:function(){setTimeout(function(){a.release()},500)}})},onTransform:function(a){},shouldActivate:function(a){return(a=a.currentWord())&&a.value&&3<=a.value.length?!0:!1},onActivate:function(a){a.data("_autocomplete_composer_active",
!0);e(document).bind("click.autocomplete",function(){a.release();e(document).unbind(".autocomplete")})},onDeactivate:function(a){a.data("_autocomplete_composer_active",!1);d.hide();a.input.focus()},val:function(a,c){return a},onkeydown:function(a,c){if(27===c.which)return a.release(),!1;if(13===c.which||9===c.which){var b=d.selection();b&&selectSuggestion(b);a.release();return!1}return 38===c.which?(d.moveHighlightUp(),!1):40===c.which?(d.moveHighlightDown(),!1):!0},onkeypress:function(a,c){return!0},
oninput:function(a,c){clearTimeout(h);d.loading(a.input);h=setTimeout(function(){var c=a.val();if(1<c.length){var g=function(c){null!==c&&0<c.length?d.show(a.input,c,a.settings.suggestionHeader):a.release()};"undefined"!==typeof n[c]?a.data("_autocomplete_composer_active")&&g(n[c]):b(c,function(b){a.data("_autocomplete_composer_active")&&(n[c]=b,a.val()==c&&g(b))})}else a.release()},500);return!0},defaults:{}}}();var d=function(){var a=null,c=null,b=null,d=null,m=null,q=function(r){d=r;if(null===
a){a=e('<div class="composer-suggestion-selector popup-list content"></div>').hide().appendTo(e("body"));b=e('<span class="heading"></span>').appendTo(a);c=e('<ul class="content-list content suggestions"></ul>').appendTo(a);m=e('<li class="loading">...</li>');var q=0,h=["<strong>&bull;</strong>&bull;&bull;","&bull;<strong>&bull;</strong>&bull;","&bull;&bull;<strong>&bull;</strong>"];setInterval(function(){q+=1;3===q&&(q=0);m.get(0).innerHTML=h[q]},175);a.delegate("li","click",function(c){null!==d&&
(a.find("li.highlight").removeClass("highlight"),e(this).addClass("highlight"),d.trigger(v.selectedEventName))})}},r=function(){if(null!==d){var c=d.offset(),b=e(d);a.css({width:b.outerWidth()-2,top:c.top+b.outerHeight()-1,left:c.left})}},v={selectedEventName:"SUGGESTION_SELECTED",show:function(d,g,m){b.html(m);q(d);r();a.hide();c.empty();e.each(g,function(a,b){var d=e('<li class="content-item suggestion">'+b.viewHtml+"</li>");d.data("suggestionData",b);c.append(d)});a.show()},hide:function(){null!==
a&&(a.hide(),c.empty())},loading:function(b){q(b);r();a.hide();c.empty().append(m);a.show()},moveHighlightUp:function(){var c=a.find("li.suggestion");if(0!==c.length){var b=c.length;e.each(c,function(a,c){e(c).hasClass("highlight")&&(b=a,e(c).removeClass("highlight"))});0>b-1&&(b=c.length);e(c.get(b-1)).addClass("highlight")}},moveHighlightDown:function(){var c=a.find("li.suggestion");if(0!==c.length){var b=-1;e.each(c,function(a,c){e(c).hasClass("highlight")&&(b=a,e(c).removeClass("highlight"))});
b+1>=c.length&&(b=-1);e(c.get(b+1)).addClass("highlight")}},selection:function(){var c=a.find("li.suggestion");if(0===c.length)return null;var b=c.filter("li.suggestion.highlight");return null!==b&&0<b.length?b.data("suggestionData"):e(c.get(0)).data("suggestionData")}};return v}();e.fn.evolutionComposer.plugins.autocomplete=f;e.fn.evolutionComposer.plugins.autocomplete.defaults={onSuggestionList:function(a,c){c(null)},onSuggestionSelect:function(a){}};return{}},jQuery,window);s("composer.hashtags",
["plugin.evolutionComposer"],function(f,e,p,l){f=function(){for(var h=null,b={},d=function(a){var c=a.data("_tagged_tags");if("undefined"===typeof c||null===c)c=[],a.data("_tagged_tags",c);return c},a=function(a){return a.currentWord({additionalWhiteSpaceSymbols:"()\"'<>.,".split("")})},c=function(c,b,g,r,m){var q=d(c)||[];q[q.length]=b;g&&(g=a(c),c.replace(g.start,g.stop+1,b.decodedName+(r?" ":"")),b=g.start+(b.decodedName+(r?" ":"")).length,r=c.input.get(0),r.setSelectionRange?r.setSelectionRange(b,
b):r.createTextRange&&(r=r.createTextRange(),r.collapse(!0),r.moveEnd("character",b),r.moveStart("character",b),r.select()));k(c);c.data("_hashtag_composer_active",!1);n.hide();c.input.focus();m&&c.release()},k=function(a){var c=d(a).reverse(),b=a.val();a.clearHighlights(a.settings.highlightClass||m);var g={};e.each(c,function(d,r){if(r&&null!==r.decodedName&&0<r.decodedName.length){var k=b.indexOf(r.decodedName);if(0>k||g[k])c.splice(d,1);else for(;0<=k;)a.addHighlight({start:k,stop:r.decodedName.length+
k,className:a.settings.highlightClass||m}),g[k]=!0,k=b.indexOf(r.decodedName,k+1)}});a.renderHighlights()},g=function(a){return 2<a.length&&0===a.indexOf("#")&&!h.test(a.substr(1))&&isNaN(parseInt(a[1],10))},m="composer-hashtag-highlight",q=function(){},r=null,v=null,u=/\[tag:([^\]]+)\]/gi,h=RegExp("["+"-_~`!@#$%^&*()=+{[}]\\|;:'\",<.>/? ".replace("]","\\]")+"]","i"),w=0;33>w;w++)b["-_~`!@#$%^&*()=+{[}]\\|;:'\",<.>/? ".charCodeAt(w)]=!0;return{init:function(a){q=a.settings.onTagList||e.fn.evolutionComposer.plugins.hashtags.defaults.onTagList;
a.input.bind(n.selectedEventName,function(){c(a,n.selection(),!0,!0,!0)});a.input.bind("blur",function(){setTimeout(function(){a.release()},500)})},onTransform:function(a,b){if(b)for(var d=a.val(),g=u.exec(d);null!==g&&0<=g.index&&null!==g&&1<g.length;){var r={token:"[tag:"+g[1]+"]",name:"#"+g[1],decodedName:"#"+e.telligent.evolution.html.decode(g[1])};a.val(a.val().replace(g[0],r.name));c(a,r,!1);g=u.exec(d)}k(a)},shouldActivate:function(c){return g(a(c).value)},onActivate:function(a){a.data("_hashtag_composer_active",
!0);e(document).bind("click.ui-composer-hashtags",function(){a.release();e(document).unbind(".ui-composer-hashtags")})},onDeactivate:function(b){var d=a(b);g(d.value)&&c(b,{decodedName:d.value,name:d.value,token:"[tag:"+d.value.substr(1)+"]"},!0,!1,!1);b.data("_hashtag_composer_active",!1);n.hide();b.input.focus()},val:function(a,c){var b=d(c);e.each(b,function(c,b){a=a.replace(RegExp(e.telligent.evolution.regex.encode(b.decodedName),"g"),b.token)});return a},onkeydown:function(a,b){if(27===b.which||
32===b.which)a.release();else if(13===b.which||9===b.which){var d=n.selection();if(d)return c(a,d,!0,!0,!0),!1;a.release()}else{if(38===b.which)return n.moveHighlightUp(),!1;if(40===b.which)return n.moveHighlightDown(),!1}return!0},onkeypress:function(a,c){"undefined"!==typeof b[c.which]&&a.release();return!0},oninput:function(c,b){if(!g(a(c).value))return c.release(),!0;if(c.currentWord().value==v&&c.data("_hashtag_composer_active"))return!0;clearTimeout(r);n.loading(c.input);r=setTimeout(function(){var b=
v=c.currentWord().value;g(b)?2<=b.length&&q(b.substr(1),function(d){if(c.data("_hashtag_composer_active")){d&&(d=e.map(d,function(a){return{name:a.name,token:a.token,decodedName:e.telligent.evolution.html.decode(a.name)}}));var r=a(c).value;r==b&&g(r)&&null!==d&&0<d.length?n.show(c.input,d,b):n.hide()}}):c.release()},500);return!0}}}();var n=function(){var h=null,b=null,d=null,a=function(a){b=a;if(null===h){h=e('<ul class="composer-hashtag-selector"></ul>').hide().appendTo(e("body"));d=e('<li class="loading">...</li>');
var c=0,q=["<strong>&bull;</strong>&bull;&bull;","&bull;<strong>&bull;</strong>&bull;","&bull;&bull;<strong>&bull;</strong>"];setInterval(function(){c+=1;3===c&&(c=0);d.get(0).innerHTML=q[c]},175);h.delegate("li","click",function(a){null!==b&&(h.find("li.highlight").removeClass("highlight"),e(this).addClass("highlight"),b.trigger(k.selectedEventName))})}},c=function(){if(null!==b){var a=b.offset(),c=e(b);h.css({width:c.outerWidth()-2,top:a.top+c.outerHeight()-1,left:a.left})}},k={selectedEventName:"HASHTAG_SELECTED",
show:function(b,d,k){a(b);c();h.hide().empty();var r=RegExp(e.telligent.evolution.regex.encode(e.telligent.evolution.html.encode(k)),"i");e.each(d,function(a,c){var b=c.name.match(r),b=null!==b?e("<li>"+c.name.replace(r,"<strong>"+b[0]+"</strong>")+"</li>"):e("<li>"+c.name+"</li>");b.data("tagData",c);h.append(b)});h.show()},hide:function(){null!==h&&h.hide().empty()},loading:function(b){a(b);c();h.hide().empty().append(d).show()},moveHighlightUp:function(){var a=h.find("li");if(0!==a.length){var c=
a.length;e.each(a,function(a,b){e(b).hasClass("highlight")&&(c=a,e(b).removeClass("highlight"))});0>c-1&&(c=a.length);e(a.get(c-1)).addClass("highlight")}},moveHighlightDown:function(){var a=h.find("li");if(0!==a.length){var c=-1;e.each(a,function(a,b){e(b).hasClass("highlight")&&(c=a,e(b).removeClass("highlight"))});c+1>=a.length&&(c=-1);e(a.get(c+1)).addClass("highlight")}},selection:function(){var a=h.find("li");if(0===a.length)return null;var c=a.filter("li.highlight");return null!==c&&0<c.length?
c.data("tagData"):e(a.get(0)).data("tagData")}};return k}();e.fn.evolutionComposer.plugins.hashtags=f;e.fn.evolutionComposer.plugins.hashtags.defaults={onTagList:function(h,b){e.telligent.evolution.get({url:e.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/hashtags.json?IncludeFields=Token,PreviewHtml",data:{QueryText:h,PageSize:5},cache:!1,dataType:"json",success:function(d){d.HashTags&&0<d.HashTags.length?(d=e.map(d.HashTags,function(a){return{name:a.PreviewHtml,token:a.Token}}),b(d)):b(null)}})}};
return{}},jQuery,window);s("composer.mentions",["plugin.evolutionComposer"],function(f,e,p,l){f=function(){var h={};allowedSpacesKey="_allowed_spaces";isActiveKey="_hashtag_composer_active";caretPosition=0;getMentions=function(b){var d=b.data("_mentioned_mentionables");if("undefined"===typeof d||null===d)d=[],b.data("_mentioned_mentionables",d);return d};setCursorPosition=function(b,d){var a=b.input.get(0);a.setSelectionRange?a.setSelectionRange(d,d):a.createTextRange&&(a=a.createTextRange(),a.collapse(!0),
a.moveEnd("character",d),a.moveStart("character",d),a.select())};mentionMentionable=function(b,d,a){var c=getMentions(b)||[];c[c.length]=d;a&&(a=effectiveCurrentWord(b),b.replace(a.start,a.stop+1,d.decodedName+" "),allowedSpaces(b,0),setCursorPosition(b,a.start+(d.decodedName+" ").length));b.release();updateHighlights(b)};updateHighlights=function(b){var d=getMentions(b),a=b.val();b.clearHighlights(b.settings.highlightClass||mentionHighlightClass);e.each(d,function(c,k){if(k&&null!==k.decodedName&&
0<k.decodedName.length){var g=a.indexOf(k.decodedName);if(0>g)d.splice(c,1);else for(;0<=g;)b.addHighlight({start:g,stop:k.decodedName.length+g,className:b.settings.highlightClass||mentionHighlightClass}),g=a.indexOf(k.decodedName,g+1)}});b.renderHighlights()};mentionHighlightClass="composer-mentionable-mention-highlight";getMentionables=function(){};getContent=getMentionablesTimeout=null;allowedSpaces=function(b,d){return"undefined"!==typeof d?(b.data("_allowed_spaces",d),d):b.data("_allowed_spaces")||
0};effectiveCurrentWord=function(b){var d=b.val().substring(0,caretPosition),a=null;e.each(h,function(c,b){if(null!==b&&0<b.length&&d.match("@"+e.telligent.evolution.regex.encode(c)+"$"))return a="@"+c,!1});if(null!==a){var c=d.length-a.length;allowedSpaces(b,a.split(" ").length-1);return{value:a,start:c,stop:c+a.length}}return b.currentWord({caretPosition:caretPosition,allowedWhiteSpaceBeforeCaret:allowedSpaces(b),additionalWhiteSpaceSymbols:"()\"'<>.,".split("")})};collectRawTokens=function(b){for(var d=
b.val(),a=[];null!==(tokens=rToken.exec(d));)a.push({match:tokens,contentTypeId:tokens[2],contentId:tokens[1]});0<a.length&&getContent&&getContent(a,function(a){e.each(a,function(a,c){var d={token:c.match[0],name:c.name,decodedName:c.name};b.val(b.val().replace(d.token,d.name));mentionMentionable(b,d,!1)});b.input.trigger("input")})};rToken=/\[mention:([^:]+):([^\]]+)\]/gi;return{init:function(b){getMentionables=b.settings.onMentionableList||e.fn.evolutionComposer.plugins.mentions.defaults.onMentionableList;
getContent=b.settings.onListContent||e.fn.evolutionComposer.plugins.mentions.defaults.onListContent;b.input.bind(n.selectedEventName,function(){mentionMentionable(b,n.selection(),!0)});b.input.bind({blur:function(){setTimeout(function(){b.release()},500)},keydown:function(){caretPosition=b.caretPosition()+1}})},onTransform:function(b,d){d&&collectRawTokens(b);updateHighlights(b)},shouldActivate:function(b){return 0===effectiveCurrentWord(b).value.indexOf("@")},onActivate:function(b){b.data(isActiveKey,
!0);e(document).bind("click.mentions",function(){b.release();e(document).unbind(".mentions")})},onDeactivate:function(b){b.data(isActiveKey,!1);n.hide();b.input.focus();allowedSpaces(b,0)},val:function(b,d){var a=getMentions(d);e.each(a,function(a,d){b=b.replace(d.decodedName,d.token)});return b},onkeydown:function(b,d){if(32===d.which)allowedSpaces(b,allowedSpaces(b)+1);else{if(27===d.which)return b.release(),!1;if(13===d.which||9===d.which){var a=n.selection();a?mentionMentionable(b,a,!0):b.release();
return!1}if(38===d.which)return n.moveHighlightUp(),!1;if(40===d.which)return n.moveHighlightDown(),!1}return!0},onkeypress:function(b,d){return!0},oninput:function(b,d){clearTimeout(getMentionablesTimeout);n.loading(b.input);getMentionablesTimeout=setTimeout(function(){var a=effectiveCurrentWord(b).value.substring(1);if(1<a.length){var c=function(c){null!==c&&0<c.length?n.show(b.input,c,a):b.release()};"undefined"!==typeof h[a]?b.data(isActiveKey)&&c(h[a]):getMentionables(a,function(d){b.data(isActiveKey)&&
(d&&(d=e.map(d,function(a){return{name:a.name,token:a.token,decodedName:e.telligent.evolution.html.decode(a.name)}})),h[a]=d,effectiveCurrentWord(b).value.substring(1)==a&&c(d))})}else b.release()},500);return!0}}}();var n=function(){var h=null,b=null,d=null,a=function(a){b=a;if(null===h){h=e('<ul class="composer-mentionable-selector"></ul>').hide().appendTo(e("body"));d=e('<li class="loading">...</li>');var c=0,q=["<strong>&bull;</strong>&bull;&bull;","&bull;<strong>&bull;</strong>&bull;","&bull;&bull;<strong>&bull;</strong>"];
setInterval(function(){c+=1;3===c&&(c=0);d.get(0).innerHTML=q[c]},175);h.delegate("li","click",function(a){null!==b&&(h.find("li.highlight").removeClass("highlight"),e(this).addClass("highlight"),b.trigger(k.selectedEventName))})}},c=function(){if(null!==b){var a=b.offset(),c=e(b);h.css({width:c.outerWidth()-2,top:a.top+c.outerHeight()-1,left:a.left})}},k={selectedEventName:"MENTIONABLE_SELECTED",show:function(b,d,k){a(b);c();h.hide().empty();var r=RegExp(e.telligent.evolution.regex.encode(e.telligent.evolution.html.encode(k)),
"i");e.each(d,function(a,c){var b=c.name.match(r),b=null!==b?e("<li>"+c.name.replace(r,"<strong>"+b[0]+"</strong>")+"</li>"):e("<li>"+c.name+"</li>");b.data("mentionableData",c);h.append(b)});h.show()},hide:function(){null!==h&&h.hide().empty()},loading:function(b){a(b);c();h.hide().empty().append(d).show()},moveHighlightUp:function(){var a=h.find("li");if(0!==a.length){var c=a.length;e.each(a,function(a,b){e(b).hasClass("highlight")&&(c=a,e(b).removeClass("highlight"))});0>c-1&&(c=a.length);e(a.get(c-
1)).addClass("highlight")}},moveHighlightDown:function(){var a=h.find("li");if(0!==a.length){var c=-1;e.each(a,function(a,b){e(b).hasClass("highlight")&&(c=a,e(b).removeClass("highlight"))});c+1>=a.length&&(c=-1);e(a.get(c+1)).addClass("highlight")}},selection:function(){var a=h.find("li");if(0===a.length)return null;var c=a.filter("li.highlight");return null!==c&&0<c.length?c.data("mentionableData"):e(a.get(0)).data("mentionableData")}};return k}();e.fn.evolutionComposer.plugins.mentions=f;e.fn.evolutionComposer.plugins.mentions.defaults=
{onListContent:function(h,b){e.telligent.evolution.batch(function(){e.each(h,function(b,a){e.telligent.evolution.get({url:e.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/genericcontent/{contentId}/{contentTypeId}.json",data:{contentId:a.contentId,contentTypeId:a.contentTypeId}}).then(function(c){a.name=c.Content.HtmlName})})}).then(function(){b(h)})},onMentionableList:function(h,b){e.telligent.evolution.get({url:e.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/mentionables.json?IncludeFields=Token,PreviewHtml",
data:{QueryText:h,PageSize:20},cache:!1,dataType:"json",success:function(d){d.Mentionables&&0<d.Mentionables.length?(d=e.map(d.Mentionables,function(a){return{name:a.PreviewHtml,token:a.Token}}),b(d)):b(null)}})}};return{}},jQuery,window);s("composer.urlhighlight",["plugin.evolutionComposer"],function(f,e,p,l){var n=/(\b(http):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;f=function(){var h={init:function(b){b.highlighClassName=b.highlighClassName||h.defaults.highlighClassName},onTransform:function(b){var d;
d=(b.val()||"").match(n);d=null!==d&&0<d.length?d[0]:null;if(null!==d){var a;a=b.data("_composer_urlpreview_data");if(null===a||"undefined"===typeof a)a={},b.data("_composer_urlpreview_data",a);var c=b.val().indexOf(d);if(0<=c&&"undefined"===typeof a.lastRange||a.lastRange.start!==c||a.lastRange.stop!==c+d.length)a.lastRange={start:c,stop:c+d.length},b.clearHighlights(b.highlighClassName),b.addHighlight({start:c,stop:c+d.length,className:b.highlighClassName}),b.renderHighlights()}else b.clearHighlights(b.highlighClassName)},
shouldActivate:function(b){return!1},val:function(b,d){return b},onkeydown:function(b,d){return!0},oninput:function(b,d){return!0},defaults:{highlighClassName:"composer-url-highlight",loadingText:"..."}};return h}();e.fn.evolutionComposer.plugins.urlhighlight=f;return{}},jQuery,window);s("events","events.gestures events.hashchange events.notifications events.pointers events.scroll events.textinput events.resized".split(" "),function(){return{}});s("events.gestures",["events.pointers"],function(f,
e,p){function l(a){return(new Date).getTime()-(a||(new Date).getTime())}function n(a,c,b,d){a=180*Math.atan2(c-d,b-a)/Math.PI;0>a&&(a+=360);return a}function h(a){if(315<a||45>=a)return"right";if(45<a&&135>=a)return"up";if(135<a&&225>=a)return"left";if(225<a&&315>=a)return"down"}function b(a,c,b){if(a.selector){var d=e(c.originalEvent.target);if(d.is(a.selector)||0<d.closest(a.selector).length)return b.call(this,c)}else return b.call(this,c)}function d(a,c,b,d){b.target=a.target;d?c.trigger(b):c&&
c.triggerHandler(b);return a.cancelBubble==k?!0:a.cancelBubble}function a(a,r){var k;a.on(q.start+c,function(c){return b(r,c,function(){k&&p.clearTimeout(k.tapHoldDurationout);k={startTime:(new Date).getTime(),startPageX:c&&c.pointers&&1<=c.pointers.length?c.pointers[0].pageX:0,startPageY:c&&c.pointers&&1<=c.pointers.length?c.pointers[0].pageY:0,held:!1,tapHoldDurationout:null,lastTap:k?k.lastTap:0};k.tapHoldDurationout=p.setTimeout(function(){k.held=!0;d(c,a,{type:g.taphold,pointers:c.pointers,originalEvent:c,
duration:l(k.startTime||(new Date).getTime())})},m.tapHoldDuration)})});a.on(q.move+c,function(c){return b(r,c,function(){if(k){var b=Math.abs(Math.sqrt(Math.pow((c&&c.pointers&&1<=c.pointers.length?c.pointers[0].pageX:0)-k.startPageX,2)+Math.pow((c&&c.pointers&&1<=c.pointers.length?c.pointers[0].pageY:0)-k.startPageY,2)));k.tapHoldDurationout&&b>=m.tapHoldMaxDistance&&p.clearTimeout(k.tapHoldDurationout);if(k.panning||c&&c.pointers&&1===c.pointers.length&&b>m.panMinDistance){var b=n(k.startPageX,
k.startPageY,c&&c.pointers&&1<=c.pointers.length?c.pointers[0].pageX:0,c&&c.pointers&&1<=c.pointers.length?c.pointers[0].pageY:0),r=h(b),b={type:g.panStart,pointers:c?c.pointers:[],originalEvent:c,angle:b,direction:r,pageX:c&&c.pointers&&1<=c.pointers.length?c.pointers[0].pageX:0,pageY:c&&c.pointers&&1<=c.pointers.length?c.pointers[0].pageY:0};k.panning||(k.panning=!0,d(c,a,b,!0));b.type=g.pan;d(c,a,b,!0)}}})});a.on(q.end+c,function(c){return b(r,c,function(){if(k){p.clearTimeout(k.tapHoldDurationout);
var b=l(k.startTime||(new Date).getTime()),r=Math.abs(Math.sqrt(Math.pow((c&&c.pointers&&1<=c.pointers.length?c.pointers[0].pageX:0)-k.startPageX,2)+Math.pow((c&&c.pointers&&1<=c.pointers.length?c.pointers[0].pageY:0)-k.startPageY,2)));if(!k.held&&b<=m.tapMaxDuration&&r<=m.tapMaxDistance)b={type:g.tap,pointers:c?c.pointers:[],originalEvent:c,duration:b},d(c,a,b),r=(new Date).getTime(),k.lastTap&&r-k.lastTap<=m.doubleTapMaxDuration?(b.type=g.doubleTap,d(c,a,b),k.lastTap=0):k.lastTap=r;else if(k.panning&&
d(c,a,{type:g.panEnd,pointers:c?c.pointers:[],originalEvent:c,pageX:c&&c.pointers&&1<=c.pointers.length?c.pointers[0].pageX:0,pageY:c&&c.pointers&&1<=c.pointers.length?c.pointers[0].pageY:0},!0),c&&c.pointers&&1===c.pointers.length&&r/b>=m.swipeMinVelocity){var q=n(k.startPageX,k.startPageY,c&&c.pointers&&1<=c.pointers.length?c.pointers[0].pageX:0,c&&c.pointers&&1<=c.pointers.length?c.pointers[0].pageY:0),r=h(q),b={type:g.swipe,pointers:c?c.pointers:[],originalEvent:c,duration:b,angle:q,direction:r,
pageX:c&&c.pointers&&1<=c.pointers.length?c.pointers[0].pageX:0,pageY:c&&c.pointers&&1<=c.pointers.length?c.pointers[0].pageY:0};d(c,a,b,!0);b.type+=r;d(c,a,b,!0)}else k={}}})})}var c="._gesture_events_namespace",k,g={tap:"tap",taphold:"taphold",doubleTap:"doubletap",swipe:"swipe",swipeUp:"swipeup",swipeDown:"swipedown",swipeRight:"swiperight",swipeLeft:"swipeleft",panStart:"panstart",pan:"pan",panEnd:"panend"},m={tapHoldDuration:400,tapHoldMaxDistance:1,tapMaxDuration:350,tapMaxDistance:10,swipeMinVelocity:0.5,
panMinDistance:10,doubleTapMaxDuration:250},q={start:"pointerstart",move:"pointermove",end:"pointerend"};if(e.telligent&&e.telligent.evolution&&e.telligent.evolution._SUPPRESS_GESTURES)return{eventNamespace:c.substring(1)};window.onorientationchange===k&&(e.event.special.orientationchange={setup:function(){var a=e(window),c,b=function(){a.trigger("orientationchange")};window.addEventListener("resize",function(a){p.clearTimeout(c);c=p.setTimeout(b,100)},!1)}});var r={"-webkit-touch-callout":"none",
"-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)"};e.each(g,function(b,d){e.event.special[d]={add:function(c){var b=e(this);d===g.taphold&&b.css(r);b.data("._gesture_events_bound")||(b.data("._gesture_events_bound",!0),a(b,c))},remove:function(a){a=e(this);a.off(c);a.removeData("._gesture_events_bound")}}});e.gestures={defaults:m};return{eventNamespace:c.substring(1)}},jQuery,
window);s("events.hashchange",function(f,e){var p="onhashchange"in e&&(void 0===document.documentMode||7<document.documentMode),l=e.location.href,n=f(e),h;p||(f.event.special.hashchange={setup:function(){h||(h=setInterval(function(){e.location.href!==l&&(l=e.location.href,n.trigger("hashchange"))},f.hashChangeSettings.interval))}});f.hashChangeSettings={interval:10};return{}},jQuery,window);s("events.textinput",function(f,e,p){var l=!f.browser.msie&&"oninput"in document.createElement("input")&&"oninput"in
document.createElement("textarea");f.event.special.textinput={setup:function(){var e=f(this);if(l)e.bind("input",function(b){e.trigger("textinput",{which:b.which})});else{var h;e.bind({keydown:function(b){h=e.val()},keyup:function(b){var d=e.val();d!==h&&e.trigger("textinput",{which:b.which});h=d}})}}};return{}},jQuery,window);s("events.notifications",["module.messaging"],function(f,e,p){e.telligent.evolution.messaging.subscribe("socket.connected",function(){e.telligent.evolution.sockets.notifications.on("received",
function(f){e.telligent.evolution.messaging.publish("notification.raised",f)});e.telligent.evolution.sockets.notifications.on("read",function(f){e.telligent.evolution.messaging.publish("notification.read",f)})});return{}},jQuery,window);s("events.pointers",["lib.util"],function(f,e,p,l){function n(a,c){this.pageX=a;this.pageY=c}function h(a){return[new n(a.pageX,a.pageY)]}function b(a){if(!a||!a.length)return[];for(var c=[],b=0;b<a.length;b++)c[c.length]=new n(a[b].pageX,a[b].pageY);return c}function d(a){return[new n(a.originalEvent.pageX,
a.originalEvent.pageY)]}function a(a,c,b,d){a&&a.length&&a.triggerHandler({type:c,pointers:b,originalEvent:d,target:d.target})}function c(a,c,b){if(a.selector){var d=e(c.originalEvent.target);if(d.is(a.selector)||0<d.closest(a.selector).length)return b.call(this,c)}else b.call(this,c)}var k={start:"pointerstart",move:"pointermove",end:"pointerend"},g={pointerMoveThrottle:10};if(e.telligent&&e.telligent.evolution&&e.telligent.evolution._SUPPRESS_POINTERS)return{eventNamespace:"_pointer_events_namespace"};
p=[{test:function(){return"onmspointerdown"in window},add:function(b,m){var q=!1;b.on("MSPointerDown._pointer_events_namespace",function(g){c(m,g,function(){a(b,k.start,d(g),g);q=!0})});b.on("MSPointerMove._pointer_events_namespace",f.throttle(function(g){c(m,g,function(){q&&a(b,k.move,d(g),g)})},g.pointerMoveThrottle));b.on("MSPointerUp._pointer_events_namespace",function(g){c(m,g,function(){q=!1;a(b,k.end,d(g),g)})});b.on("MSPointerCancel._pointer_events_namespace",function(g){c(m,g,function(){q=
!1;a(b,k.end,d(g),g)})})},remove:function(a){a.off("._pointer_events_namespace")}},{test:function(){return"ontouchstart"in window},add:function(d,m){var q=!1;d.on("touchstart._pointer_events_namespace",function(g){c(m,g,function(){a(d,k.start,b(g.originalEvent.touches),g);q=!0})});d.on("touchmove._pointer_events_namespace",f.throttle(function(g){c(m,g,function(){q&&a(d,k.move,b(g.originalEvent.touches),g)})},g.pointerMoveThrottle));d.on("touchend._pointer_events_namespace",function(g){c(m,g,function(){q=
!1;a(d,k.end,b(g.originalEvent.changedTouches),g)})});d.on("touchcancel._pointer_events_namespace",function(g){c(m,g,function(){q=!1;a(d,k.end,b(g.originalEvent.changedTouches),g)})})},remove:function(a){a.off("._pointer_events_namespace")}},{test:function(){return"onmousedown"in document},add:function(b,d){var m=!1;b.on("mousedown._pointer_events_namespace",function(g){c(d,g,function(){a(b,k.start,h(g),g);m=!0})});b.on("mousemove._pointer_events_namespace",f.throttle(function(g){c(d,g,function(){m&&
a(b,k.move,h(g),g)})},g.pointerMoveThrottle));b.on("mouseup._pointer_events_namespace",function(g){c(d,g,function(){m=!1;a(b,k.end,h(g),g)})});b.on("mouseleave._pointer_events_namespace",function(g){c(d,g,function(){m&&a(b,k.end,h(g),g);m=!1})})},remove:function(a){a.off("._pointer_events_namespace")}}];var m;for(l=0;l<p.length;l++)!m&&p[l].test()&&(m=p[l]);if(m){for(var q in k)e.event.special[k[q]]={add:function(a){var c=e(this);c.data("._pointer_events_bound")||(c.data("._pointer_events_bound",
!0),m.add(c,a))},remove:function(a){a=e(this);m.remove(a);a.removeData("._pointer_events_bound")}};e.pointer={defaults:g};return{eventNamespace:"_pointer_events_namespace"}}},jQuery,window);s("events.resized",function(f,e,p){f.event.special.resized={setup:function(l){function n(){k=h.width();g=h.height();if(Math.abs(k-a)>d||Math.abs(g-c)>d){var b={oldWidth:a,oldHeight:c,newWidth:k,newHeight:g};a=h.width();c=h.height();h.trigger("resized",b)}}var h=f(window),b,d=0,a=0,c=0,k,g;(function(){var b=f("<div></div>").css({position:"absolute",
width:"100px",height:"100px",overflow:"scroll",left:"-200px"});f("body").append(b);try{var g=b.get(0);d=g.offsetWidth-g.clientWidth}catch(r){d=0}b.remove();a=h.width();c=h.height()})();h.on("resize",function(){e.clearTimeout(b);b=e.setTimeout(n,f.event.special.resized.defaults.throttle)})}};f.event.special.resized.defaults={throttle:150};return{}},jQuery,window);s("events.scroll",function(f,e){(function(){var e={};f.event.special.scrollend={setup:function(l){e=f.extend({padding:150,delay:250,initialLoadAttempts:10,
initialLoadDelay:1E3},l)},add:function(){var l=f(this);if(!l.data("_scrollend_init")){l.data("_scrollend_init",!0);var n=this===document,h=n?f(window):l,b=!1,d=-1,a=0,c=!1,k=function(){return n?f("body").prop("scrollHeight")||h.height()+1:h.prop("scrollHeight")||h.height()+1};h.on("scroll",function(){b=!0});setInterval(function(){if(b){var a;a=n?f(l).height()-f(l).scrollTop()-f(h).height()<=e.padding:l.scrollTop()+l.innerHeight()+e.padding>=l[0].scrollHeight;a?l.trigger("scrollend"):b=!1}},e.delay);
setInterval(function(){if(c){var b=h.height();b>d&&(d=b,k()<=d&&(a=0,c=!1))}else d=h.height(),k()<=d+10&&a<e.initialLoadAttempts?(a++,l.trigger("scrollend")):c=!0},e.initialLoadDelay)}}}})();(function(){var e={};f.event.special.scrolltop={setup:function(l){e=f.extend({padding:150,delay:250},l)},add:function(){var l=f(this);if(!l.data("_scrolltop_init")){l.data("_scrolltop_init",!0);var n=!1;(this===document?f(window):l).on("scroll",function(){n=!0});setInterval(function(){n&&(l.scrollTop()<=e.padding&&
l.trigger("scrolltop"),n=!1)},e.delay)}}}})();return{}},jQuery,window);s("lib","lib.actionSheet lib.dynamicLinks lib.messageLinks lib.scrollFix lib.sheet lib.sheetProvider lib.util lib.touchEventAdapter lib.globalConfiguration".split(" "),function(){return{}});s("lib.actionSheet",function(f,e,p){function l(h,b){var d=f(document.createElement("li"));d.append(b);h.append(d)}function n(h,b){var d=f(document.createElement("ul"));d.addClass("action-sheet");for(var a=0;a<b.length;a++)l(d,b[a]);d.on("click",
"a",function(a){h.sheet.hide()});h.sheet.show(d);h.content=d}return function(h){h=h||{};h.sheet=h.sheet;return{show:function(b){b=b||{};b.links=b.links||[];n(h,b.links||[])},hide:function(){h.sheet.hide()},content:function(){return h.content}}}},jQuery,window);s("lib.dynamicLinks",["lib.scrollFix","lib.actionSheet"],function(f,e,p,l,n){function h(a){return a.outerWidth()+parseInt(a.css("marginLeft"),10)+parseInt(a.css("marginRight"),10)+3}function b(a){"vertical"==a.direction?(a.parent.empty(),a.listWrapper=
p(document.createElement("div")).addClass("container").appendTo(a.parent),a.list=p(document.createElement("ul")).appendTo(a.listWrapper).css(g)):(a.parent.css({overflow:"hidden"}).empty(),a.listWrapper=p(document.createElement("div")).css(k).addClass("container").appendTo(a.parent),a.parentWidth=a.listWrapper.outerWidth(),a.list=p(document.createElement("ul")).appendTo(a.listWrapper).css(g),a.listWrapper.on("pan swipe pointerend",function(a){"left"!=a.direction&&"right"!=a.direction||a.stopPropagation()}),
f.preventBounce(a.listWrapper))}function d(a){a.additionalLinks=[];a.accumulatedWidth=0;a.preScrollTo=0;if("vertical"==a.direction){a.moreLink!=n&&(a.list.append(a.moreLink.element),a.moreLink.element.detach());for(var c=0;c<a.links.length;c++){var b=a.links[c];if(c>a.maxLinks-1)a.additionalLinks.push(b);else{var d=p(document.createElement("li")).append(b.element);d.addClass(b.className).appendTo(a.list)}}}else{a.moreLinkWidth=0;a.moreLink!=n&&(a.moreLink.element.css(m),a.list.append(a.moreLink.element),
a.moreLinkWidth=h(a.moreLink.element),a.moreLink.element.detach());for(var g=c=0;c<a.links.length;c++)if(b=a.links[c],d=p(document.createElement("li")).append(b.element),0!=d.children().length){d.css({display:"inline"}).addClass(b.className);d.appendTo(a.list);b.element.css(m);var k=h(b.element);b.selected&&(a.preScrollTo=a.accumulatedWidth);a.accumulatedWidth+k>a.parentWidth&&g+1<=a.minLinks?a.accumulatedWidth+=k:0<a.additionalLinks.length||(a.accumulatedWidth+k+a.moreLinkWidth>a.parentWidth||g+
1>a.maxLinks)&&g+1>a.minLinks?(d.detach(),a.additionalLinks.push(b)):a.accumulatedWidth+=k;g++}}}function a(a){if("vertical"==a.direction)0<a.additionalLinks.length&&(a.moreLink&&a.onShowMore)&&(p(document.createElement("li")).append(a.moreLink.element).addClass(a.moreLink.className).appendTo(a.list),a.moreLink.element.off(c).on("click"+c,function(c){a.onShowMore(a.additionalLinks,a.cancelLink);return!1})),a.list.css({visibility:"visible"});else{0<a.additionalLinks.length&&(a.moreLink&&a.onShowMore)&&
(p(document.createElement("li")).css({display:"inline"}).append(a.moreLink.element).addClass(a.moreLink.className).appendTo(a.list),a.accumulatedWidth+=a.moreLinkWidth,a.moreLink.element.off(c).on("click"+c,function(c){a.onShowMore(a.additionalLinks,a.cancelLink);return!1}));a.list.css({width:a.accumulatedWidth>a.parentWidth?a.accumulatedWidth:a.parentWidth,visibility:"visible"});a.listWrapper.get(0).scrollLeft=a.preScrollTo-a.preScrollOffset;var b=a.list.height();0!=b&&(a.parent.css({height:b}),
a.listWrapper.css({height:b+20}))}}var c="._dynamicLinks",k={overflow:"hidden","overflow-x":"auto"},g={visible:"hidden","list-style":"none",padding:"0px",margin:"0px",overflow:"hidden"},m={"float":"left"},q=function(c){var g=p.extend({},q.defaults,c||{});return{render:function(){b(g);d(g);a(g)},addLink:function(c,k){k!=n?g.links.splice(k,0,c):g.links[g.links.length]=c;b(g);d(g);a(g)},removeLink:function(c){g.links=p.grep(g.links,function(a){return!p(a.element).is(c)});b(g);d(g);a(g)},links:function(a){return a?
g.additionalLinks:g.links},cancelLink:function(){return g.cancelLink},moreLink:function(){return g.moreLink}}};q.defaults={preScrollOffset:10,minLinks:0,maxLinks:50,direction:"vertical",parent:null,links:[],moreLink:null,cancelLink:null,onShowMore:function(a,c){}};return q},jQuery,window);s("lib.globalConfiguration",function(){return{baseUrl:"",authorizationCookieName:"AuthorizationCookie",defaultErrorMessage:"An error occured while communicating with the server.",defaultMultiErrorMessagePrefix:"The following errors occured while communicating with the server:\t ",
isRemote:!1,remoteUrlEncodePattern:"",accessingUserId:0,accessingUserIsSystemAccount:!0}});s("lib.messageLinks",function(f,e,p){return function(e){e=e||{};var n=f(e.parent);return{handle:function(h){n.on(h||"click","a[data-messagename]",function(b){b.preventDefault();b.stopPropagation();b.stopImmediatePropagation();f.telligent.evolution.messaging.publish(f(this).data("messagename"),{target:this})})}}}},jQuery,window);s("lib.scrollFix",function(f,e,p){function l(f){var h,b=f.get(0);f.on("pointerstart",
function(d){h=b.scrollTop;0>=h&&(b.scrollTop=1);h+b.offsetHeight>=b.scrollHeight&&(b.scrollTop=b.scrollHeight-b.offsetHeight-1);originalScrollLeft=b.scrollLeft;0>=originalScrollLeft&&(b.scrollLeft=1);originalScrollLeft+b.offsetWidth>=b.scrollWidth&&(b.scrollLeft=b.scrollWidth-b.offsetWidth-1)})}return{preventBounce:function(e){e=e||f("body").children().first();l(e)},fix:function(e){e.on("touchmove.scrollfix mousemove.scrollfix mspointermove.scrollfix",function(h){h.originalEvent.preventDefault()})},
unfix:function(e){e.off(".scrollfix")}}},jQuery,window);s("lib.sheet",["lib.scrollFix","module.messaging"],function(f,e,p,l,n){function h(a){a.inited||(a.inited=!0,a.backDrop=p(document.createElement("div")).css({backgroundColor:a.backgroundColor,opacity:0.01,zIndex:100,position:"fixed",top:0,left:0,display:"none","-webkit-transform":"translate3d(0,0,0)","-webkit-backface-visibility":"hidden",transform:"translate3d(0,0,0)"}).appendTo(a.parent),a.sheet=p(document.createElement("div")).css({zIndex:101,
position:"fixed",left:0,top:0,display:"none","-webkit-transform":"translate3d(0,0,0)","-webkit-backface-visibility":"hidden",transform:"translate3d(0,0,0)"}).appendTo(a.parent).addClass(a.cssClass),a.sheet.on("click","a",function(){var a=p(this);(a=a.attr("href")||a.closest("[href]").attr("href"))&&(1<a.length&&p.telligent&&p.telligent.evolution&&p.telligent.evolution.mobile)&&p.telligent.evolution.mobile.load(a)}),k(a))}function b(a){a.windowWidth=0<window.innerWidth?window.innerWidth:screen.width;
a.windowHeight=0<window.innerHeight?window.innerHeight:screen.height;a.visible?(a.backDrop.css({width:a.windowWidth,height:a.windowHeight}),a.sheet.css({width:a.windowWidth,maxHeight:a.maxHeightPerent*a.windowHeight})):(a.backDrop&&a.backDrop.css({width:a.windowWidth,height:a.windowHeight}),a.sheet&&a.sheet.css({width:a.windowWidth,maxHeight:a.maxHeightPerent*a.windowHeight}))}function d(a,c,b){b=b||a.animationDuration;a.backDrop.evolutionTransform({opacity:a.backDrop.css("opacity")}).evolutionTransform({opacity:0.01+
c*a.backgroundOpacity},{duration:b,easing:a.animationEasing});a.sheet.evolutionTransform({y:a.windowHeight-c*a.sheet.outerHeight(),x:0},{duration:b,easing:a.animationEasing});1<=c?a.onOpened&&(l.clearTimeout(a.openedTimeout),a.openedTimeout=l.setTimeout(function(){a.onOpened.apply(this);l.clearTimeout(a.openedTimeout)},b)):0>=c&&a.onClosed&&(l.clearTimeout(a.closedTimeout),a.closedTimeout=l.setTimeout(function(){a.onClosed.apply(this);l.clearTimeout(a.closedTimeout)},b))}function a(a,c){a.visible||
(p("body").css({height:"100%",overflow:"scroll"}),a.visible=!0,a.onOpening&&a.onOpening.apply(this),h(a),b(a),a.sheet.empty().append(c),a.sheet.evolutionTransform({y:a.windowHeight,x:0}),a.backDrop.get(0).style.display="block",a.sheet.get(0).style.display="block",d(a,1))}function c(a,c){a.visible&&(p("body").css({height:"100%",overflow:"visible"}),a.visible=!1,c=c||a.animationDuration,a.onClosing&&a.onClosing.apply(this),d(a,0),l.setTimeout(function(){a.visible||(a.visible=!1,a.backDrop.get(0).style.display=
"none",a.sheet.get(0).style.display="none")},c))}function k(a){a.backDrop.on("tap",function(){c(a)})}return function(d){d=d||{};d.maxHeightPerent=d.maxHeightPerent||0.85;d.parent=p(d.parent);d.cssClass=d.cssClass||"sheet";d.backgroundColor=d.backgroundColor||"#333";d.backgroundOpacity=d.backgroundOpacity||0.5;d.animationDuration=d.animationDuration||250;d.animationEasing=d.animationEasing||"cubic-bezier(0.160, 0.060, 0.450, 0.940)";d.visible=!1;p.telligent.evolution.messaging.subscribe("mobile.orientationchange",
function(){l.setTimeout(function(){b(d)},300)});return{show:function(c){a(d,c)},hide:function(){c(d)}}}},jQuery,window);s("lib.sheetProvider",function(f,e,p){return{}},jQuery,window);s("lib.touchEventAdapter",["lib.util","events.gestures","events.pointers"],function(f,e,p,l,n,h){function b(a,c){g||(document.createEventObject?(trigger=document.createEventObject(),trigger.synthesized=!0,a.fireEvent("on"+c,trigger)):(trigger=document.createEvent("HTMLEvents"),trigger.initEvent(c,!0,!0),trigger.synthesized=
!0,a.dispatchEvent(trigger)))}function d(){var a=new Date;l("body").on("tap",function(c){if(g)return c.preventDefault(),c.stopPropagation(),!1;if("INPUT"==c.target.nodeName||"TEXTAREA"==c.target.nodeName||"SELECT"==c.target.nodeName||"FILE"==c.target.nodeName){if("INPUT"==c.target.nodeName&&"checkbox"==c.target.type.toLowerCase()||"radio"==c.target.type.toLowerCase()){var d=l(c.target);d.is(":checked")?setTimeout(function(){d.prop("checked",!1).trigger("change")},25):setTimeout(function(){d.prop("checked",
!0).trigger("change")},25)}else{if("SELECT"==c.target.nodeName)return!0;l(c.target).focus()}c.stopPropagation();c.stopImmediatePropagation();c.preventDefault();return!1}a=new Date;b(c.target,"click");c.stopPropagation();c.stopImmediatePropagation();c.preventDefault()});document.addEventListener("click",function(c){if(g)return c.preventDefault(),c.stopPropagation(),!1;var b=new Date-a;return(c.clientX||c.clientY||c.pageX||c.pageY||c.x||c.y)&&!c.synthesized&&350>b?(c.preventDefault(),c.stopPropagation(),
!1):!0},!0)}function a(){var a={mouseenter:"taphold",mouseover:"taphold",mouseleave:"pointerend",mousedown:"pointerstart",mouseup:"pointerend"};l.fn.on=l.fn.bind=c(l.fn.on,a,!0);l.fn.trigger=c(l.fn.trigger,a,!1);l.fn.off=l.fn.unbind=c(l.fn.off,a,!1)}function c(a,c,b){return function(){var d=Array.prototype.slice.call(arguments,0);if(b&&1===d.length&&l.isPlainObject(d[0])){var g=d[0];l.each(c,function(a,c){g[a]!=h&&(g[c]=g[a],delete g[a])});return a.call(this,g)}if("string"!=typeof d[0])return a.apply(this,
d);eventParts=d[0].split(".",2);if(2==eventParts.length&&(eventParts[1]==e.eventNamespace||eventParts[1]==p.eventNamespace))return a.apply(this,d);c[eventParts[0]]&&(eventParts[0]=c[eventParts[0]],d[0]=eventParts.join("."));return a.apply(this,d)}}function k(){var a={after:function(){g=!0;setTimeout(function(){g=!1},m)}};n.alert=f.wrap(n.alert,a);n.confirm=f.wrap(n.confirm,a)}var g=!1,m=250,q="ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints,r="_evolutionForceTouchRemap"in
window,v=l.telligent&&l.telligent.evolution&&l.telligent.evolution._SUPPRESS_TOUCH_MOUSE_EVENTS,u=l.telligent&&l.telligent.evolution&&l.telligent.evolution._SUPPRESS_TOUCH_CLICK_EVENTS,w=n!=n.parent,t=/chrom(e|ium)/.test(navigator.userAgent.toLowerCase()),y=/android/.test(navigator.userAgent.toLowerCase()),z=/windows nt/.test(navigator.userAgent.toLowerCase()),B="MouseEvent"in window&&(!("ontouchstart"in window)||z),x=parseInt((/Chrome\/([0-9]+)/.exec(navigator.userAgent)||["0","0"])[1],10),A=document.querySelector&&
document.querySelector('meta[name=viewport][content*="width=device-width"]')!==h,D=document.querySelector&&document.querySelector('meta[name=viewport][content*="user-scalable=no"]')!==h;return{adapt:function(){if(q||r)B||v||a(),u||(w||t&&y&&32<=x&&A||t&&y&&32>x&&A&&D)||(k(),d()),l(function(){l("body").addClass("touch")})}}},jQuery,window);s("lib.util",function(f){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return{throttle:function(e,l){var n,h;return function(){var b=
this;attemptAt=(new Date).getTime();args=arguments;n&&n+(l||50)>attemptAt?(f.clearTimeout(h),h=f.setTimeout(function(){n=attemptAt;e.apply(b,args)},l||50)):(n=attemptAt,e.apply(b,args))}},debounce:function(e,f){var n;return function(){var h=this,b=arguments;clearTimeout(n);n=setTimeout(function(){e.apply(h,b)},f||10)}},wrap:function(e,f){return function(){try{f.before&&f.before.apply(this,arguments)}catch(n){}var h=e.apply(this,arguments);try{f.after&&f.after.apply(this,arguments)}catch(b){}return h}},
guid:function(){return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}}},window);s("modules","module.emailDigest module.administrationToolbar module.configuration module.editableGroup module.html module.language module.maxlength module.media module.messaging module.navigationConfirmation module.notifications module.preview module.regex module.sockets module.template module.ui module.url module.tourtips module.rest".split(" "),function(){return{}});s("module.emailDigest",function(f,e,p){f.telligent||
(f.telligent={});f.telligent.evolution||(f.telligent.evolution={});var l=function(e,h){0>h||(0<h&&""!=e.subscriptionId&&(""==e.context||"undefined"===e.contextId)?_showMessage(e,e.errorMessage):f.telligent.evolution.post({url:e.emailDigestUrl,data:{subscriptionId:e.subscriptionId,frequency:h,context:e.context,contextId:e.contextId},success:function(b){b=eval("("+b+")");var d=null;"create"==b.action?(e.subscriptionId=b.subscriptionId,e.frequency=h,1==h?d=e.dailyMessage:7==h&&(d=e.weeklyMessage)):"update"==
b.action?(e.frequency=h,1==h?d=e.dailyMessage:7==h&&(d=e.weeklyMessage)):"delete"==b.action&&(e.subscriptionId="",e.frequency=0,"group"==e.context&&(d=e.unsubscribeGroupMessage));b.warnings&&0<b.warnings.length?_showMessage(e,b.warnings[0],"warning"):d&&_showMessage(e,d,"success");b={subscriptionId:e.subscriptionId,frequency:e.frequency,context:e.context,contextId:e.contextId,action:b.action};f(document).trigger("emailDigestSubscriptionChange",[b])},error:function(b,d,a){_showMessage(e,e.errorMessage,
"error")}}))};_showMessage=function(e,h,b){f.telligent.evolution.notifications.show(h,{type:b,duration:5E3})};f.telligent.evolution.emailDigest={register:function(e){f("#"+e.selectPopupId).glowPopUpPanel({cssClass:"Panel",position:"updown",zIndex:100,hideOnDocumentClick:!0});f("#"+e.rollupWrapperId).click(function(){var h=f(this),b="",d="",a="";1==e.frequency?b="email-digest-selected":7==e.frequency?d="email-digest-selected":a="email-digest-selected";var c=h.outerWidth(),k=h.outerHeight(),h=h.offset(),
b="<div class='email-digest-selectWrapper' style=\"min-width: "+(c-2)+'px;"><div frequency="1" class="email-digest-selectable '+e.selectableTag+" "+b+'"><span style="display: block; white-space: nowrap;">'+e.popupDaily+'</span></div><div frequency="7" class="email-digest-selectable '+e.selectableTag+" "+d+'"><span style="display: block; white-space: nowrap;">'+e.popupWeekly+'</span></div><div frequency="0" class="email-digest-selectable '+e.selectableTag+" "+a+'"><span style="display: block; white-space: nowrap;">'+
e.popupUnsubscribe+"</span></div></div>";f("#"+e.selectPopupId).glowPopUpPanel("hide").glowPopUpPanel("html",b).glowPopUpPanel("show",h.left+4,h.top+5,c,k-10,!1)});f("."+e.selectableTag).live("click",function(){var h=f(this);h.hasClass("email-digest-selected")||(h=h.attr("frequency"),l(e,h))});f(document).bind("emailDigestSubscriptionChange",function(h,b){if(b.context==e.context&&b.contextId==e.contextId){var d="";"create"==b.action||"update"==b.action?("1"==b.frequency?d=e.rollupDaily:"7"==b.frequency&&
(d=e.rollupWeekly),e.subscriptionId=b.subscriptionId):(d=e.rollupUnsubscribed,e.subscriptionId="");e.frequency=b.frequency;f("#"+e.rollupTextId).html(d)}})}};return{}},jQuery,window);s("module.administrationToolbar",function(f,e,p){f.telligent||(f.telligent={});f.telligent.evolution||(f.telligent.evolution={});f.telligent.evolution.administrationToolbar={get:function(){var e;e=f(".admin-bar");0<e.length||(e=f("form"),1<e.length&&(e=f("body")),e.prepend(f('<div class="admin-bar-header"></div><div class="admin-bar site"></div><div class="admin-bar-footer"></div>')),
e=f(".admin-bar"));return e}};return{}},jQuery,window);s("module.configuration",["lib.globalConfiguration"],function(f,e,p,l){function n(b,d,a){for(b+="";b.length<d;)b=a+b;return b}var h=e.fn.filter;e.fn.filter=function(){arguments&&(0<arguments.length&&"string"==typeof arguments[0])&&(arguments[0]=arguments[0].replace(/:\[/g,"["));return h.apply(this,arguments)};document.cookie=".te.dpr="+(Math.round(window.devicePixelRatio||1)||1);l={formatDate:function(b){try{return[n(b.getFullYear(),4,"0"),"-",
n(b.getMonth()+1,2,"0"),"-",n(b.getDate(),2,"0"),"T",n(b.getHours(),2,"0"),":",n(b.getMinutes(),2,"0"),":",n(b.getSeconds(),2,"0")].join("")}catch(d){}return""},parseDate:function(){var b=(new Date).getTimezoneOffset();return function(d){var a,c=new Date;if(null===d||""===d)return c;if(null!=(a=/\/Date\((\d+)(?:-(\d+))?\)\//.exec(d)))return new Date(parseInt(a[1],10));if(null!=(a=/(\d{4,4})\-(\d{2,2})\-(\d{2,2})(?:T(\d{2,2}):(\d{2,2}):(?:(\d{2,2})(?:\.(\d{0,3}))?))([zZ]|([+\-])(((\d\d):(\d\d))|(\d\d\d\d)))?/.exec(d))){d=
[c.getFullYear(),c.getMonth()+1,c.getDate(),c.getHours(),c.getMinutes(),c.getSeconds(),c.getMilliseconds()];for(c=1;c<a.length&&8>c;c++)""!=a[c]&&void 0!=a[c]&&(d[c-1]=parseInt(a[c],10));d=new Date(d[0],d[1]-1,d[2],d[3],d[4],d[5],d[6]);if(a[8]){var k,g;"z"==a[8]||"Z"==a[8]?(k=0,g=1):a[9]&&a[12]&&a[13]?(k=60*parseInt(a[12],10)+parseInt(a[13],10),g="+"==a[9]?1:-1):a[9]&&a[10]&&(k=60*parseInt(a[10].substring(0,2),10)+parseInt(a[10].substring(2),10),g="+"==a[9]?1:-1);d=new Date(d.getTime()+-6E4*(g*k+
b))}return d}throw"Invalid date format";}}(),site:{configure:function(b){e.extend(f,b);e.telligent.evolution.user={accessing:{id:f.accessingUserId,isSystemAccount:f.accessingUserIsSystemAccount}};e.fn.glowDateTimeSelector&&e.extend(e.fn.glowDateTimeSelector.defaults,{monthNames:f.monthNames,dayNames:f.dayNames,calendarButtonImageUrl:e.telligent.evolution.site.getBaseUrl()+"utility/images/glow/DateTimeSelectorCalendar.gif"});e.glowModal&&(e.extend(e.glowModal.defaults,{loadingHtmlUrl:"about:blank",
windowCssClasses:["modal"],windowTitleCssClasses:["modal-title","modal-title-2","modal-title-3","modal-title-4"],windowCloseCssClasses:["modal-close"],windowContentCssClasses:["modal-content","modal-content-2"],windowMaskCssClasses:["modal-mask"],windowFooterCssClasses:["modal-footer","modal-footer-2","modal-footer-3"],windowResizeCssClasses:["modal-resize"],zIndex:200001}),p.Telligent_Modal={GetWindowOpener:function(b,a){return e.glowModal.opener(b,a)},IsShown:function(b){return e.glowModal.visible(b)},
Resize:function(b,a,c,k){e.glowModal.resize(b,a,c,k)},MoveTo:function(b,a,c){e.glowModal.moveTo(b,a,c)},Open:function(b,a,c,k,g,m,q,r,h){e.glowModal(b,{width:a,height:c,onClose:k,x:g,y:m,ignoreCloseAndAnimation:q,isManuallyresized:r,openerWindow:h})},Close:function(b,a){e.glowModal.close(b,a)},Refresh:function(b){e.glowModal.refresh(b)}});e.fn.glowDropDownList&&e.extend(e.fn.glowDropDownList.defaults,{buttonImageUrl:e.telligent.evolution.site.getBaseUrl()+"utility/images/glow/DropDownListButton.gif"});
e.fn.glowColorSelector&&e.extend(e.fn.glowColorSelector.defaults,{blendImageUrl:e.telligent.evolution.site.getBaseUrl()+"utility/images/glow/ColorSelectorSv.png",hueBlendImageUrl:e.telligent.evolution.site.getBaseUrl()+"utility/images/glow/ColorSelectorHue.png"});e.fn.glowMultiUpload&&e.extend(e.fn.glowMultiUpload.defaults,{swfUrl:e.telligent.evolution.site.getBaseUrl()+"utility/images/glow/Moxie.swf",silverlightUrl:f.silverlightFileUploadEnabled?e.telligent.evolution.site.getBaseUrl()+"utility/images/glow/Moxie.xap":
"",runtimes:f.silverlightFileUploadEnabled?"html5,silverlight,flash":"html5,flash"});e.fn.glowUpload&&e.extend(e.fn.glowUpload.defaults,{swfUrl:e.telligent.evolution.site.getBaseUrl()+"utility/images/glow/Moxie.swf",silverlightUrl:f.silverlightFileUploadEnabled?e.telligent.evolution.site.getBaseUrl()+"utility/images/glow/Moxie.xap":"",runtimes:f.silverlightFileUploadEnabled?"html5,silverlight,flash":"html5,flash"})},getBaseUrl:function(b){if(!0===b){b=p.location.href+"";var d=b.indexOf("/",9);if(0<
d)return b.substr(0,d)+f.baseUrl}return f.baseUrl}}};e.telligent=e.telligent||{};e.telligent.evolution=e.telligent.evolution||{};e.extend(e.telligent.evolution,l);return{}},jQuery,window);s("module.editableGroup",function(f,e,p){f.telligent||(f.telligent={});f.telligent.evolution||(f.telligent.evolution={});var l={},n=function(a,c,b){if(a.isSaving)if(c+1<a.widgets.length){var d=a.widgets[c+1];d.save?(d=d.save(function(){n(a,c+1,b)},function(){h(a,c+1,b)}),!1===d?h(a,c+1,b):!0===d&&n(a,c+1,b)):n(a,
c+1,b)}else b.success&&(a.isSaving=!1,b.success())},h=function(a,c,b){a.isSaving&&(a.isSaving=!1,b.error&&b.error())},b=function(a,c,b){if(a.isValidating){a.widgets[c].valid=!0;var d=0;f.each(a.widgets,function(a,c){!0!==c.valid&&d++});0==d&&(a.isValidating=!1,b.success&&b.success())}},d=function(a,c,b){a.isValidating&&(a.widgets[c].valid=!1,a.isValidating=!1,b.error&&b.error())};f.telligent.evolution.editableGroup={register:function(a,c){var b=l[a];b||(b={widgets:[],isSaving:!1,isValidating:!1},
l[a]=b);b.widgets[b.widgets.length]=f.extend({},c||{},{valid:!1,saved:!1})},save:function(a,c){f.telligent.evolution.editableGroup.validate(a,{success:function(){var b=l[a];b&&0<b.widgets.length?(b.isSaving=!0,n(b,-1,c)):c&&c.success&&c.success()},error:function(){c.error&&c.error()}})},validate:function(a,c){var k=l[a];k&&0<k.widgets.length?(f.each(k.widgets,function(a,c){c.valid=p}),k.isValidating=!0,f.each(k.widgets,function(a,m){if(m.validate){var q=m.validate(function(){b(k,a,c)},function(){d(k,
a,c)});!1===q?d(k,a,c):!0===q&&b(k,a,c)}else b(k,a,c)})):c&&c.success&&c.success()}};return{}},jQuery,window);s("module.html",function(f,e,p){f.telligent||(f.telligent={});f.telligent.evolution||(f.telligent.evolution={});f.telligent.evolution.html={encode:function(e){return e?f("<div/>").text(e).html():e},decode:function(e){if(!e)return e;e=e.replace(/<[^>]*>/g," ");return f("<div/>").html(e).text()}};return{}},jQuery,window);s("module.language",function(f,e,p){var l={},n={};agoLastRefresh=(new Date).getTime();
buildCacheKey=function(b,d){return b.toString()+"-"+d};loadFormattedDate=function(b,d,a){var c=l;"agodate"==d&&(6E4<(new Date).getTime()-agoLastRefresh&&(n={},agoLastRefresh=(new Date).getTime()),c=n);var k=c[buildCacheKey(b,d)];"undefined"===typeof k?f.telligent.evolution.get({url:h.defaults.dateEndpoint,data:{date:f.telligent.evolution.formatDate(b),format:d},success:function(g){g&&(a&&"undefined"!==typeof g&&null!==g&&g.formattedDate)&&(c[buildCacheKey(b,d)]=g.formattedDate,a(g.formattedDate))}}):
a(k)};var h={formatDate:function(b,d){loadFormattedDate(b,"date",d)},formatDateAndTime:function(b,d){loadFormattedDate(b,"datetime",d)},formatAgoDate:function(b,d){loadFormattedDate(b,"agodate",d)},defaults:{dateEndpoint:""}};f.telligent||(f.telligent={});f.telligent.evolution||(f.telligent.evolution={});f.telligent.evolution.language=h;return{}},jQuery,window);s("module.maxlength",function(f,e,p){return{shim:function(){f("textarea[maxlength]").live("keyup change",function(){var e=f(this),n=e.attr("maxlength"),
h=e.val();h.length>n&&e.val(h.substr(0,n))})}}},jQuery,window);s("module.media",function(f,e,p){var l=function(e,b,d){var a=f.extend({},n.defaults,d||{});e={url:e,view:b};a.width&&(e.width=a.width);a.height&&(e.height=a.height);f.telligent.evolution.get({url:a.endpoint,data:e,success:function(c){c&&a.success&&a.success(c)},error:function(c,b,d){a.error&&a.error(c,b,d)}})},n={previewHtml:function(e,b){l(e,"preview",b)},viewHtml:function(e,b){l(e,"view",b)},defaults:{endpoint:""}};f.telligent||(f.telligent=
{});f.telligent.evolution||(f.telligent.evolution={});f.telligent.evolution.media=n;return{}},jQuery,window);s("module.messaging",function(f,e,p){function l(c){if(!c)throw"subscriptionId is required when unsubscribing a message";if(isNaN(c)){if(c&&a[c]){for(var b=0;b<a[c].length;b++)l(a[c][b]);a[c].length=0}}else n(c)}function n(a){if("undefined"!==typeof d[String(a)]){var k=d[String(a)],g=-1,m=b[k.message];f.each(m,function(a,c){c===k&&(g=a)});0<=g&&m.splice(g,1);0===m.length&&delete b[k.message];
delete d[String(a)]}}var h=0,b={},d={},a={};e={publish:function(a,d){if(!a)throw"messageName is required when publishing a message";if(null!==a&&0!==a.length){var g=b[a];g&&f.each(g,function(a,c){if(null!==c.handler)try{c.handler.call(this,d)}catch(b){}})}},subscribe:function(c,k,g){if(!c)throw"messageName is required when subscribing to a message";if(null===c||0===c.length)return 0;"undefined"===typeof b[c]&&(b[c]=[]);var m=k;g==p&&(g=k,m="content");k={message:c,handler:g,namespace:m,id:++h};b[c][b[c].length]=
k;d[String(k.id)]=k;a[m]||(a[m]=[]);return a[m][a[m].length]=k.id},unsubscribe:l};f.telligent||(f.telligent={});f.telligent.evolution||(f.telligent.evolution={});return f.telligent.evolution.messaging=e},jQuery,window);s("module.navigationConfirmation",function(f,e,p){f.telligent||(f.telligent={});f.telligent.evolution||(f.telligent.evolution={});var l={message:"",enabled:!1,ignoreClick:!1},n=function(){if(!l.ignoreClick)return l.message};f.telligent.evolution.navigationConfirmation={configure:function(e){l=
f.extend(l,e)},enable:function(){l.enabled||(window.onbeforeunload=n,l.enabled=!0,f(document).bind("customizepage",function(){l.ignoreClick=!0}))},register:function(e){f(e).click(function(){l.ignoreClick=!0})},ignoreClick:function(){l.ignoreClick=!0}};return{}},jQuery,window);s("module.notifications",["lib.util"],function(f,e,p,l){function n(c,m){var q=e.grep(c.notifications,function(a){return a.id===m.id});if(null!==q&&1===q.length)return q=q[0],b(c,q).then(function(){q.view.remove();q.message=m.message;
q.cssClass=m.cssClass;q.duration=m.duration;k(c,q);q.suppressPositionAnimation=!0;h(c);d(c,q);g(c,q)}),q;c.notifications.length===c.limit&&a(c,c.notifications[c.notifications.length-1]);c.notifications.unshift(m);k(c,m);h(c);d(c,m);g(c,m);return m}function h(a){var c=a.margin;e.each(a.notifications,function(b,d){d.suppressPositionAnimation?(d.view.css({bottom:c+"px",opacity:0}),d.suppressPositionAnimation=!1):d.view.animate({bottom:c+"px"},a.animationDuration);0<d.measuredHeight&&(c+=d.measuredHeight+
a.margin)})}function b(a,c){c.onHide&&c.onHide.apply(c);return e.Deferred(function(b){c.view.fadeOut(a.animationDuration,b.resolve)}).promise()}function d(a,c){c.onShow&&c.onShow.apply(c);return e.Deferred(function(b){c.view.fadeTo(a.animationDuration,a.opacity,b.resolve)}).promise()}function a(a,c){c.removing=!0;c.measuredHeight=0;h(a);b(a,c).then(function(){c.view.remove();a.notifications=e.grep(a.notifications,function(a){return a!==c})})}function c(c,b){p.clearTimeout(b.removeTimeout);p.clearInterval(b.hideSupressedWaitInterval);
p.setTimeout(function(){c.removalSuppressed?b.hideSupressedWaitInterval=p.setInterval(function(){c.removalSuppressed||(p.clearInterval(b.hideSupressedWaitInterval),a(c,b))},1E3):a(c,b)},b.duration)}function k(a,c){c.active=!!c.onClick;c.view=e(a.template(c)).css({position:"fixed",left:a.margin+"px",bottom:a.margin+"px",zIndex:1E4,width:c.width}).hide().appendTo(a.parent);c.measuredHeight=c.view.outerHeight()}function g(b,g){g.view.find("a.close").on("click",function(c){c.preventDefault();c.stopPropagation();
g.onClose?(c=g.onClose.apply(g))?c.then(function(){a(b,g)}):a(b,g):a(b,g)});g.view.on("click",function(){g.onClick&&g.onClick.apply(g)});g.view.on("mouseenter",function(){b.entered=!0;b.removalSuppressed=!0;g.removing&&(g.view.stop(),g.removing=!1,d(b,g),h(b),c(b,g));g.onOver&&g.onOver.apply(g)});g.view.on("mouseleave",function(){b.entered=!1;p.setTimeout(function(){b.entered||(b.removalSuppressed=!1)},500);g.onOut&&g.onOut.apply(g)})}var m,q={show:function(a,b){if(!m){var d=e.extend({},q.defaults,
{},{removalSuppressed:!1,notifications:[]});d.template=e.telligent.evolution.template.compile(d.template);m=d}d=e.extend({},q.show.defaults,b||{});d.message=a;d.cssClass=d.type||"";d.id||(d.id=f.guid());c(m,n(m,d));return d.id},hide:function(c){if(m&&c)if(e.isFunction(c))e.each(m.notifications,function(c,b){a(m,b)}),c();else{var b=e.grep(m.notifications,function(a){return a.id===c});b&&0!=b.length&&a(m,b[0])}}};q.show.defaults={duration:5E3,width:200,type:"",id:null,onClick:null,onClose:null,onShow:null,
onHide:null,onOver:null,onOut:null};q.defaults={template:'<div class="push-notification <%: cssClass %> <% if(active) { %>active<% } %>">  <a href="#" class="close">x</a>   <%= message %> </div> ',parent:"body",margin:5,animationDuration:250,opacity:0.95,limit:10};e.telligent=e.telligent||{};e.telligent.evolution=e.telligent.evolution||{};e.telligent.evolution.notifications=q;return{}},jQuery,window);s("module.preview",function(f,e,p){var l=function(e,b){var d=f.extend({},n.defaults,b||{});f.telligent.evolution.get({url:d.endpoint,
data:{url:e,maxImageWidth:"undefined"!==typeof b.maxImageWidth?b.maxImageWidth:d.maxImageWidth,maxImageHeight:"undefined"!==typeof b.maxImageHeight?b.maxImageHeight:d.maxImageHeight},success:function(a){a&&d.success&&"undefined"!==typeof a&&null!==a?d.success(a):d.error&&d.error(a)},error:function(a,c,b){d.error&&d.error(a,c,b)}})},n={load:function(e,b){l(e,b)},render:function(e,b){if(null!==e&&"undefined"!==typeof e&&"undefined"!==typeof e.url&&0!==e.url.length&&"undefined"!==typeof e.title&&0!==
e.title.length){var d=f.extend({},n.defaults,b);return f.telligent.evolution.template.compile(d.template)(e)}},defaults:{endpoint:"",maxImageWidth:90,maxImageHeight:90,template:'<div class="abbreviated-post-header shared-link"></div><div class="abbreviated-post shared-link <% if(imageUrl !== null && imageUrl.length > 0){ %> with-image <% } %>">   <h4 class="post-name"><a href="<%: url %>" <% if(url.indexOf(jQuery.telligent.evolution.site.getBaseUrl(true)) < 0) { %>class="external-link" target="_blank"<% } %> rel="nofollow"><%= title %></a></h4>   <% if(siteName !== null && siteName.length > 0){ %>       <div class="post-application">           <span class="label"></span>           <span class="value"><a href="<%: url %>" <% if(url.indexOf(jQuery.telligent.evolution.site.getBaseUrl(true)) < 0) { %>class="external-link" target="_blank"<% } %> rel="nofollow"><%= siteName %></a></span>       </div>   <% } %>   <% if(imageUrl !== null && imageUrl.length > 0){ %>       <div class="post-thumbnail">           <a href="<%: url %>" <% if(url.indexOf(jQuery.telligent.evolution.site.getBaseUrl(true)) < 0) { %>class="external-link" target="_blank"<% } %> rel="nofollow"><%= resizedImageHtml %></a>       </div>   <% } %>   <% if(excerpt !== null && excerpt.length > 0){ %>       <div class="post-summary">           <%= excerpt %>      </div>   <% } %></div><div class="abbreviated-post-footer shared-link"></div>'}};
f.telligent||(f.telligent={});f.telligent.evolution||(f.telligent.evolution={});f.telligent.evolution.preview=n;return{}},jQuery,window);s("module.regex",function(f,e,p){f.telligent||(f.telligent={});f.telligent.evolution||(f.telligent.evolution={});f.telligent.evolution.regex={encode:function(e){return e?e.replace(/[\-\[\]\{\}\(\)\*\+\?\.\,\\\^\$\|\#\s]/g,"\\$&"):e}};return{}},jQuery,window);s("module.rest",["lib.globalConfiguration"],function(f,e,p,l){function n(a){var c;a:{c=f.authorizationCookieName+
"=";for(var b=document.cookie.split(";"),d=0;d<b.length;d++){for(var g=b[d];" "==g.charAt(0);)g=g.substring(1,g.length);if(0==g.indexOf(c)){c=g.substring(c.length,g.length);break a}}c=null}null!=c&&(a.setRequestHeader("Authorization-Code",c),a.setRequestHeader("Rest-Authorization-Code",c))}function h(a){a&&"~/"==a.substr(0,2)&&(a=f.baseUrl+a.substr(2));f.isRemote&&(f.remoteUrlEncodePattern&&a&&-1<a.lastIndexOf("/~/"))&&(a=a.substr(0,a.lastIndexOf("/~/")+3)+a.substr(a.lastIndexOf("/~/")+3).replace(RegExp(f.remoteUrlEncodePattern,
"gi"),function(a,c,b){return"_"+a.substr(1)}));return a}function b(a,c){var b=a,d=c;b&&(c&&"string"!==typeof c)&&(d={},e.each(c,function(a,c){var g=RegExp("{"+a+"}","gim");b.match(g)?b=b.replace(g,p.encodeURIComponent(c)):d[a]=c}));return{url:b,data:d}}function d(a,c,b){var d=c,g=null;try{var m=e.isPlainObject(a)?a:e.parseJSON(a);if(m&&m.Errors&&e.isArray(m.Errors)&&0<m.Errors.length){var k=[];e.each(m.Errors,function(a,c){var b=c.split(":",2);1===b.length?k.push(b[0].replace(u,"")):0<=e.inArray(b[0],
v)&&k.push(b[1].replace(u,""))});1===k.length||1<k.length&&e.telligent.evolution.notifications===l?d=k[0]:1<k.length&&(g=k[0],d=b,d+="<ul>",e.each(k,function(a,c){d+="<li>"+c+"</li>"}),d+="</ul>")}if(null===d||""===e.trim(d))d=c}catch(q){}return g||d}function a(a,c){var g=b(a.url,a.data);a.url=h(g.url);a.data=g.data;var k=a.beforeSend,q=a.error,r=e.extend({},{defaultErrorMessage:f.defaultErrorMessage,defaultMultiErrorMessagePrefix:f.defaultMultiErrorMessagePrefix},a);e.extend(a,{type:"GET"===c?c:
"POST",beforeSend:function(a){k!==l&&k(a);n(a);"PUT"!==c&&"DELETE"!==c||a.setRequestHeader("Rest-Method",c)},error:function(a,c,b){if(0!==a.readyState&&0!==a.status)if(c=d(a.responseText,r.defaultErrorMessage,r.defaultMultiErrorMessagePrefix),q!==l)m(q,this,[a,c,b]);else try{e.telligent.evolution.notifications.show(c,{type:"error"})}catch(g){alert(c)}}});return e.ajax(a)}function c(){var a=++t;w[a]={dfd:e.Deferred(),reqs:[]};setTimeout(function(){delete w[a]},y);return a}function k(a,c){var d=w[a];
if(d===l)return e.Deferred(function(c){c.reject('Batch "'+a+'" not found')}).promise();if(0===d.reqs.length)return d.dfd.resolve(),d.dfd.promise();var k=e.extend({},B,c),q={Sequential:k.sequential};e.each(d.reqs,function(a,c){var d=c.options.url.replace(/\.xml/i,".json"),d=b(d,c.options.data);"GET"==c.verb?d.url=e.telligent.evolution.url.modify({url:d.url,query:d.data||{}}).split("#")[0]:q["_REQUEST_"+a+"_DATA"]=e.param(d.data||{});q["_REQUEST_"+a+"_URL"]=h(d.url);q["_REQUEST_"+a+"_METHOD"]=c.verb});
e.ajax({url:e.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/batch.json",type:"POST",data:q,beforeSend:function(a){k.beforeSend&&k.beforeSend(a);n(a)}}).done(function(c,b){g(d,c.BatchResponses,this,b);d.dfd.resolveWith(this,[c]);delete w[a]}).fail(function(c,b,k){0!==c.readyState&&0!==c.status&&(c.responseJSON&&c.responseJSON.BatchResponses?g(d,c.responseJSON.BatchResponses,c,b):e.each(d.reqs,function(a,d){d.options.error&&m(d.options.error,d.options,[c,b,k]);d.dfd.rejectWith(d.options,[c,b,k])}),
d.dfd.rejectWith(this,[c,b,k]),delete w[a])});return d.dfd.promise()}function g(a,c,b,g){e.each(c,function(c,k){var q=a.reqs[c];if(200===k.StatusCode)q.options.success&&m(q.options.success,q.options,[k.BatchResponse,g,b]),q.dfd.resolveWith(q.options,[k.BatchResponse,g,b]);else{var r=d(k.BatchResponse,q.options.defaultErrorMessage,q.options.defaultMultiErrorMessagePrefix);if(q.options.error)m(q.options.error,b,[k,r,g]);else try{e.telligent.evolution.notifications.show(r,{type:"error"})}catch(h){alert(r)}q.dfd.rejectWith(b,
[k,r,g])}q.options.complete&&m(q.options.complete,q.options,[b,g])})}function m(a,c,b){if(a)if(e.isArray(a))for(var d=0;d<a.length;d++)a[d].apply(c,b);else a.apply(c,b)}function q(b,d){null!==z&&(b.batch=z);if(b&&b.batch){var g;g=b.batch;w[g]===l&&(g=c());g=w[g];var k={options:e.extend({},{defaultErrorMessage:f.defaultErrorMessage,defaultMultiErrorMessagePrefix:f.defaultMultiErrorMessagePrefix},b),verb:d,dfd:e.Deferred()};g.reqs.push(k);return k.dfd.promise()}return a(b,d)}function r(a,b){if(a){if(null!==
z)throw"Batched REST requests cannot be nested.";var d=c();z=d;try{a.apply(this)}finally{z=null}return k(d,b)}}var v=["RecordNotFound","BadRequest","Conflict","Unauthorized","Unknown"],u=/(?:<|>)/g,w={},t=0,y=6E4,z=null,B={sequential:!1,beforeSend:null};r.create=c;r.process=k;var x={get:function(a){return q(a,"GET")},post:function(a){return q(a,"POST")},put:function(a){return q(a,"PUT")},del:function(a){return q(a,"DELETE")},writeAuthorizationHeader:n,ensureRemoteUrlEncoding:h,batch:r};e.telligent=
e.telligent||{};e.telligent.evolution=e.telligent.evolution||{};e.extend(e.telligent.evolution,x);p.TelligentUtility||(p.TelligentUtility={WriteAuthorizationHeader:function(a){e.telligent.evolution.writeAuthorizationHeader(a)}});return x},jQuery,window);s("module.sockets.configurableLongPolling",function(f,e,p){var l={longPollDelay:0};return{configure:function(n){var h=f.extend({},l,n||{}),b=f.signalR,d=f.signalR.events,a=f.signalR.changeState,c=f.signalR.isDisconnecting,k=b.transports._logic;b.transports.longPolling=
{name:"longPolling",supportsKeepAlive:!1,reconnectDelay:3E3,init:function(a,b){var d=this,r,h=function(b){!1===c(a)&&(a.log("Server ping failed because '"+b+"', re-trying ping."),a._.pingLoopId=e.setTimeout(r,d.reconnectDelay))};a.log("Initializing long polling connection with server.");r=function(){k.pingServer(a).done(b).fail(h)};r()},start:function(g,m,q){var r=this,v=function(){u=v=f.noop;g.log("Longpolling connected.");m();q=null},u=function(){return q?(q(),q=null,g.log("LongPolling failed to connect."),
!0):!1},w=g._,t=0,l=function(c){e.clearTimeout(w.reconnectTimeoutId);w.reconnectTimeoutId=null;!0===a(g,b.connectionState.reconnecting,b.connectionState.connected)&&(g.log("Raising the reconnect event."),f(c).triggerHandler(d.onReconnect))};g.pollXhr&&(g.log("Polling xhr requests already exists, aborting."),g.stop());w.reconnectTimeoutId=null;w.pollTimeoutId=null;r.init(g,function(){g.messageId=null;w.pollTimeoutId=e.setTimeout(function(){(function B(a,q){var m=null!==a.messageId,n=k.getUrl(a,r.name,
m,!q);!0!==c(a)&&(g.log("Opening long polling request to '"+n+"'."),a.pollXhr=f.ajax(f.extend({},f.signalR.ajaxDefaults,{xhrFields:{withCredentials:g.withCredentials},url:n,type:"GET",dataType:g.ajaxDataType,contentType:g.contentType,success:function(b){var d=0,q,m,r;g.log("Long poll complete.");t=0;try{q=g._parseResponse(b)}catch(n){k.handleParseFailure(a,b,n.message,u);return}null!==w.reconnectTimeoutId&&l();v();q&&(m=k.maximizePersistentResponse(q));k.processMessages(a,q);h&&0<h.longPollDelay?
d=h.longPollDelay:m&&"number"===f.type(m.LongPollDelay)&&(d=m.LongPollDelay);m&&m.Disconnect||!0===c(a)||((r=m&&m.ShouldReconnect)&&k.ensureReconnectingState(a),0<d?w.pollTimeoutId=e.setTimeout(function(){B(a,r)},d):B(a,r))},error:function(c,q){e.clearTimeout(w.reconnectTimeoutId);w.reconnectTimeoutId=null;"abort"===q?g.log("Aborted xhr requst."):u()||(t++,g.state!==b.connectionState.reconnecting&&(g.log("An error occurred using longPolling. Status = "+q+".  Response = "+c.responseText+"."),f(a).triggerHandler(d.onError,
[c.responseText])),(g.state!==b.connectionState.connected&&g.state!==b.connectionState.reconnecting||k.verifyLastActive(g))&&k.ensureReconnectingState(a)&&(w.pollTimeoutId=e.setTimeout(function(){r.init(a,function(){B(a,!0)})},r.reconnectDelay)))}})),m&&!0===q&&(w.reconnectTimeoutId=e.setTimeout(function(){l(a)},Math.min(1E3*(Math.pow(2,t)-1),36E5))))})(g);e.setTimeout(function(){v()},250)},250)})},lostConnection:function(a){throw Error("Lost Connection not handled for LongPolling");},send:function(a,
c){k.ajaxSend(a,c)},stop:function(a){e.clearTimeout(a._.pollTimeoutId);e.clearTimeout(a._.reconnectTimeoutId);delete a._.pollTimeoutId;delete a._.reconnectTimeoutId;a.pollXhr&&(a.pollXhr.abort(),a.pollXhr=null,delete a.pollXhr)},abort:function(a,c){k.ajaxAbort(a,c)}}}}},jQuery,window);s("module.sockets",["module.sockets.configurableLongPolling"],function(f,e,p,l){function n(){return p.navigator.userAgent.match(/(iPod|iPhone|iPad)/)&&p.navigator.userAgent.match(/AppleWebKit/)}var h={},b=null,d;d=n()?
["longPolling","foreverFrame"]:["serverSentEvents","longPolling","foreverFrame"];var a=0,c=!1,k=0,g=null,m=0,q=function(a){m++;12<m||(clearTimeout(k),k=setTimeout(function(){a.start({transport:d});clearTimeout(k)},5E3))},r=function(a,c,b){if(a=h[a+"|"+c]){var d=b&&0<b.length?e.parseJSON(b):null;e.each(a,function(a,c){try{c(d)}catch(b){}})}},v=function(k){e.connection&&(f.configure({longPollDelay:n()?5E3:0}),e.each(k.sockets,function(c,d){v[d.name]={on:function(a,c){var b=d.fullName+"|"+a;h[b]=h[b]||
[];h[b].push(c)},off:function(a){delete h[d.fullName+"|"+a]},send:function(c,g){if(a==e.signalR.connectionState.connected){var k=e.telligent.evolution.url.serializeQuery(e.extend(g,{_s:d.fullName,_m:c}));b.send(k)}}}}),e.ajaxPrefilter(function(a,c,b){0===a.url.indexOf(k.endpoint)&&e.telligent.evolution.writeAuthorizationHeader(b)}),0<k.sockets.length&&(b=e.connection(k.endpoint),b.received(function(a){a=e.telligent.evolution.url.parseQuery(a);r(a._s,a._m,a._d)}),b.error(function(c){a=e.signalR.connectionState.disconnected;
b.stop()}),b.stateChanged(function(c){a=c.newState;a==e.signalR.connectionState.disconnected&&q(b)}),b.disconnected(function(){}),b.reconnected(function(){a=e.signalR.connectionState.connected}),b.start({transport:d,callback:function(){c||(c=!0,e.telligent.evolution.messaging.publish("socket.connected"));clearInterval(g);g=setInterval(function(){a==e.signalR.connectionState.connected&&b.send("_KEEP_ALIVE")},6E4);m=0}})))};e.telligent=e.telligent||{};e.telligent.evolution=e.telligent.evolution||{};
e.telligent.evolution.sockets=e.telligent.evolution.sockets||v;return{}},jQuery,window);s("module.template",function(f,e,p){var l={},n={open:"<%",close:"%>"},h=function(b,a){var c=f.extend({},n,a||{}),k=RegExp("\\"+c.open+"=([\\s\\S]+?)"+c.close,"g"),g=RegExp("\\"+c.open+":([\\s\\S]+?)"+c.close,"g"),c=RegExp("\\"+c.open+"(.*?)"+c.close,"g"),k=" var source = [];  with(data){with(extraHelpers){with(defaultHelpers){  source.push('"+b.replace(/[\r\n]/g,"").replace(k,"'); source.push(String($1)); source.push('").replace(g,
"'); source.push(escape(String($1))); source.push('").replace(c,"'); $1 source.push('")+"');  }}}  return source.join('');",g=new Function("defaultHelpers","extraHelpers","data",k);g.compiledSource="function(defaultHelpers, extraHelpers, data) { "+k+" } ";return g},b={compile:function(d,a,c){var k=l[d];if("undefined"===typeof k){var g=null!==document.getElementById(d)?document.getElementById(d).innerHTML:d,m=h(g,c);l[d]=k=function(c){return m.call(this,b.helpers||{},a||{},c||{})};k.source={raw:g,
compiled:m.compiledSource}}return k},helpers:{foreach:function(b,a){if(b&&0<b.length&&a)for(var c=0;c<b.length;c++)a(b[c],c)},escape:function(b){var a=/&/g,c=/</g,k=/>/g,g=/\"/g;return function(b){return b.replace(a,"&amp;").replace(c,"&lt;").replace(k,"&gt;").replace(g,"&quot;")}}()}};f.telligent=f.telligent||{};f.telligent.evolution=f.telligent.evolution||{};f.telligent.evolution.template=b;return{}},jQuery,window);s("module.tourtips",["module.configuration"],function(f,e,p,l){function n(){function a(c){return e.telligent.evolution.user.accessing.id+
":"+c}function c(a){return"tourtip_:"+a}var b=e.telligent.evolution.user.accessing.isSystemAccount?p.sessionStorage:p.localStorage;return{get:function(d){if(b)return JSON.parse(b.getItem(c(a(d))))},set:function(d,g){b&&b.setItem(c(a(d)),JSON.stringify(g))},remove:function(d){b&&b.removeItem(c(a(d)))}}}function h(){m&&(p.clearTimeout(c),c=p.setTimeout(h,g));var k=[],r=[];e.each(a,function(a,c){var b=q.get(c.key);b&&!b.read?k.push(c):b||r.push(c)});a.length=0;if(0<r.length)if(e.telligent.evolution.user.accessing.isSystemAccount)e.each(r,
function(a,c){k.push(c)}),b(k);else{var f={},t=[];e.each(r,function(a,c){t.push(c.key);f[c.key]=c});m=!0;d.list(t).then(function(a){m=!1;e.each(a.TourTips,function(a,c){q.set(c.Key,{read:c.Read});if(!c.Read){var b=f[c.Key];b&&k.push(b)}});b(k)})}else b(k)}function b(a){q=q||n();var c=q.get(r);c&&0<c&&c>(new Date).getTime()||(a=a.sort(function(a,c){return a.index-c.index}),e.telligent.evolution.messaging.publish("ui.tourtips",{tips:a}))}var d={mark:function(a,c){return(c?e.telligent.evolution.post:
e.telligent.evolution.del)({url:e.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/tourtips/{key}.json?IncludeFields=Key,Read",data:{key:a}})},list:function(a){return e.telligent.evolution.get({url:e.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/tourtips.json?IncludeFields=Key,Read",data:{Keys:a.join(",")}})}},a=[],c,k=0,g=1E3,m=!1,q,r="suppressUntil";e.telligent=e.telligent||{};e.telligent.evolution=e.telligent.evolution||{};e.telligent.evolution.tourTips={register:function(b){q=q||n();b&&
(b.index==l&&(b.index=k++),a.push(b),p.clearTimeout(c),c=p.setTimeout(h,g))},mark:function(a,c){q.set(a,{read:c});return e.telligent.evolution.user.accessing.isSystemAccount?e.Deferred(function(a){a.resolve()}).promise():d.mark(a,c)},suppress:function(a){q=q||n();a&&0<a?q.set(r,(new Date).getTime()+a):q.remove(r)}};return{}},jQuery,window);s("module.ui",["lib.util"],function(f,e,p,l){var n={};parseData=function(h){h=h.get(0);for(var b={},d=0;d<h.attributes.length;d++){var a=h.attributes[d];if(0===
a.name.indexOf("data-")){var c=a.name.substring(5);b[c]="configuration"===c?e.telligent.evolution.url.parseQuery(a.value):a.value}}return b};api={components:{},render:function(h){h=e(h||document);for(var b in api.components){var d=api.components[b],a=e(".ui-"+b,h);h.hasClass(".ui-"+b)&&a.add(h);a&&(0<a.length&&"undefined"!==typeof d.setup&&!n[b])&&(d.setup.call(this),n[b]=!0);a&&(0<a.length&&"undefined"!==typeof d.add)&&a.each(function(){var a=e(this);a.data("_telligent_evolution_ui_render_add."+
b)||(d.add.call(a,a,api.data(a)),a.data("_telligent_evolution_ui_render_add."+b,!0))})}},data:function(h){if(!h)return{};h=e(h);var b=h.data("_telligent_evolution_ui_data");if(null===b||"undefined"===typeof b)b=parseData(h),h.data("_telligent_evolution_ui_data",b);return b}};e.telligent||(e.telligent={});e.telligent.evolution||(e.telligent.evolution={});e.telligent.evolution.ui=api;e.each(["html","append","prepend"],function(h,b){e.fn[b]=f.wrap(e.fn[b],{after:function(){e.telligent.evolution.ui.render(this)}})});
e.each(["after","before"],function(h,b){e.fn[b]=f.wrap(e.fn[b],{after:function(){e.telligent.evolution.ui.render(this.parent())}})});return api},jQuery,window);s("module.url",function(f,e,p){var l=null,n=function(b,a,c,k,g){if(!b)return b;var m=/(?:\.config|\.ascx|\.asax|\.cs|\.vb)$/i.test(b);return b.replace(a,function(a,e,h){if(" "==a)return c;if("."!=a||m||h==b.length-1||"."==b.substr(h+1,1)){e=[];e[e.length]=g;for(h=0;h<a.length;h++){var f=a.charCodeAt(h).toString(16)+"",w=f.length;4==w?(e.push(f.substr(2,
2).toUpperCase()),e.push(f.substr(0,2).toUpperCase())):3==w?(e.push(f.substr(1,2).toUpperCase()),e.push("0"),e.push(f.substr(0,1).toUpperCase())):2==w&&(e.push(f.toUpperCase()),e.push("00"))}e[e.length]=g;return e.join("")}return k})},h=function(b,a,c,k){return b?b.replace(a,function(a,b,d){if(1==a.length){if(a==c)return" ";if(a==k)return"."}else{a=a.substr(1,a.length-2);if(0!=a.length%4)return"";b=[];for(d=0;d<a.length;d+=4)b[b.length]=String.fromCharCode(parseInt(a.substr(d+2,2)+a.substr(d,2),16));
return b.join("")}}):b},b={parseQuery:function(b){var a=b.split("?"),c={};b=(1<a.length?a[1]:b).split("#")[0].split("&");f.each(b,function(a,b){b=b.split("=");2===b.length&&(c[b[0]]=decodeURIComponent(b[1].replace(/\+/gi," ")))});return c},serializeQuery:function(b){b=b||{};var a=[];f.each(b,function(c,b){a[a.length]=encodeURIComponent(c)+"="+encodeURIComponent(b)});return a.join("&")},modify:function(d){d=f.extend({url:e.location.href,query:null,hash:e.location.hash,protocol:e.location.protocol},
d);var a=[d.url.split("?")[0].split("#")[0]],c;"string"===typeof d.query&&(d.query=b.parseQuery(d.query));(c=b.serializeQuery(f.extend(b.parseQuery(d.url),d.query)))&&0<c.length&&(a[a.length]="?"+c);d.hash&&0<d.hash.length&&(a[a.length]=(0!==d.hash.indexOf("#")?"#":"")+d.hash);return a.join("")},hashData:function(d,a){var c=!1,k="";f.isPlainObject(a)?(c=a.overrideCurrent,k=a.prefix||""):c=a;if(k){var g={},m;for(m in d)g[k+m]=d[m];d=g}if("undefined"===typeof d){d={};var c=e.location.href.split("#"),
q="";2<c.length&&(f.each(c,function(a,c){0<a&&(1<a&&(q+="#"),q+=c)}),c=[c[0],q]);2===c.length&&(d=b.parseQuery(c[1]));return d}c||(d=f.extend(b.hashData(),d));e.location.href=e.location.href.split("#")[0]+"#"+b.serializeQuery(d)},encode:function(b){return encodeURIComponent(b)},decode:function(b){return decodeURIComponent(b)},encodePathComponent:function(b){return n(b,/([^A-Za-z0-9 \.]+|\.| )/g,"+","-","_")},decodePathComponent:function(b){return h(b,/((?:_(?:[0-9a-f][0-9a-f][0-9a-f][0-9a-f])+_)|\-|\+)/ig,
"+","-")},encodeFileComponent:function(b){return n(b,/([^A-Za-z0-9 \.]+|\.| )/g,"-",".","_")},decodeFileComponent:function(b){return h(b,/((?:_(?:[0-9a-f][0-9a-f][0-9a-f][0-9a-f])+_)|_|\-)/ig,"-",".")},navigateTo:function(b){var a=f("base");if(0<a.length){l||(l=f("<a></a>").css({position:"absolute",left:"-1000px"}),f("body").append(l));var c=l.attr({href:b})[0];try{e.document.createEvent?c.dispatchEvent(function(a){a.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null);return a}(document.createEvent("MouseEvents"))):
c.dispatchEvent(new MouseEvent("click",{view:e,bubbles:!0,cancelable:!0}))}catch(k){(a=a.attr("target"))?e.open(b,a):e.document.location=b}}else e.document.location=b}};f.telligent||(f.telligent={});f.telligent.evolution||(f.telligent.evolution={});f.telligent.evolution.url=b;return{}},jQuery,window);s("plugins","plugin.evolutionBookmark plugin.evolutionComposer plugin.evolutionHighlight plugin.evolutionInlineTagEditor plugin.evolutionLike plugin.evolutionModerate plugin.evolutionPager plugin.evolutionResize plugin.evolutionStarRating plugin.evolutionTagTextBox plugin.evolutionTheater plugin.evolutionToggleLink plugin.evolutionTransform plugin.evolutionUserFileTextBox plugin.validation plugin.evolutionTextEditor plugin.evolutionScrollSlider plugin.evolutionMasonry plugin.evolutionTip".split(" "),
function(){return{}});s("plugin.evolutionBookmark",function(f,e,p){var l=function(a){a.toggle=f("<a></a>").attr({href:"#"});a.element.append(a.toggle);a.toggle.evolutionToggleLink({onHtml:"<span></span>"+f.telligent.evolution.html.encode(n(a,a.settings.deleteBookmarkText)),offHtml:"<span></span>"+f.telligent.evolution.html.encode(n(a,a.settings.addBookmarkText)),processingHtml:"<span></span>"+f.telligent.evolution.html.encode(n(a,a.settings.processingText)),changeState:function(c){b(c,a)},onTitle:n(a,
a.settings.deleteBookmarkText),offTitle:n(a,a.settings.addBookmarkText),processingTitle:n(a,a.settings.processingText),onCssClass:a.settings.deleteBookmarkCssClass,offCssClass:a.settings.addBookmarkCssClass,processingCssClass:a.settings.processingCssClass,val:a.settings.initialState})},n=function(a,c){return c.replace(/\{content_type_name\}/gi,a.settings.contentTypeName)},h=function(a,c){f.telligent.evolution.messaging.publish("ui.bookmark",{contentId:a.settings.contentId,contentTypeId:a.settings.contentTypeId,
typeId:a.settings.typeId,bookmarked:c})},b=function(a,c){if(a)c.settings.onBookmark(c.settings.contentId,c.settings.contentTypeId,c.settings.typeId,function(){h(c,!0)});else c.settings.onUnbookmark(c.settings.contentId,c.settings.contentTypeId,c.settings.typeId,function(){h(c,!1)})},d=function(a){f.telligent.evolution.messaging.subscribe("ui.bookmark",function(c){c.contentId===a.settings.contentId&&c.contentTypeId===a.settings.contentTypeId&&c.typeId===a.settings.typeId&&a.toggle&&a.toggle.evolutionToggleLink("val",
c.bookmarked)})};f.fn.evolutionBookmark=function(a){var c=f.extend({},f.fn.evolutionBookmark.defaults,a||{});return this.each(function(){var a={element:f(this),toggle:null,settings:c};l(a);d(a)})};f.fn.evolutionBookmark.defaults={contentId:"",contentTypeId:"",typeId:"",initialState:!1,contentTypeName:"",onBookmark:function(a,c,b,d){},onUnbookmark:function(a,c,b,d){},deleteBookmarkText:"Unbookmark {content_type_name}",addBookmarkText:"Bookmark this {content_type_name}",processingText:"...",addBookmarkCssClass:"internal-link favorite-off",
deleteBookmarkCssClass:"internal-link favorite-on",processingCssClass:"internal-link processing"};return{}},jQuery,window);s("plugin.evolutionComposer",["events.textinput"],function(f,e,p,l){var n=function(a,c){a=e(a);var b=a.data("__COMPOSER_CONTEXT");!b&&c&&(b=h(a,c),a.data("__COMPOSER_CONTEXT",b));return b},h=function(a,c){var g=e.extend({},e.fn.evolutionComposer.defaults,c||{}),g={input:a,settings:g,plugins:e.map(g.plugins,function(a){return"string"==typeof a?e.fn.evolutionComposer.plugins[a]:
a}),ranges:[],activePlugin:!1};g.pluginContext=b(g);g.input.evolutionHighlight();d(g);return g},b=function(a){return{settings:a.settings,input:a.input,data:function(c,b){return"undefined"!==typeof b?a.input.data(c,b):a.input.data(c)},val:function(c){return"undefined"!==typeof c?a.input.val(c):a.input.val()},release:function(){a.activePlugin.onDeactivate&&a.activePlugin.onDeactivate.call(a.input,a.pluginContext);a.activePlugin=!1},caretPosition:function(){return q(a.input)},currentWord:function(c){c=
e.extend({allowedWhiteSpaceBeforeCaret:0,allowedWhiteSpaceAfterCaret:0},c||{});var b=c.caretPosition||q(a.input),d="",k=e(a.input).val(),r="",h=0,f=b,v=0;if(b<k.length&&"\n"!==k[b]&&"\t"!==k[b]){r=k.substring(b);h=g(r);0>h&&(h=r.indexOf("\n"));0>h&&(h=r.indexOf("\t"));0>h&&(h=r.length);for(v=0;v<c.allowedWhiteSpaceAfterCaret;v++)if(0<h){var l=k.substring(b+h+1);nextWhiteSpaceIndex=g(l);nextWhiteSpaceIndex=-1===nextWhiteSpaceIndex?l.length:nextWhiteSpaceIndex;if(0<nextWhiteSpaceIndex)h+=nextWhiteSpaceIndex+
1;else break}0<h&&(f=0,d+=r.substring(0,h))}if(0<b&&"\n"!==k[b-1]&&"\t"!==k[b-1]){r=k.substring(0,b);h=m(r);for(v=0;v<c.allowedWhiteSpaceBeforeCaret;v++)if(0<h)if(b=m(k.substring(0,h)),b!==h)h=b;else break;h===r.length&&(h=r.lastIndexOf("\n"));h===r.length&&(h=r.lastIndexOf("\t"));h===r.length&&(h=r.length-1);h<r.length-1&&(f=h+1,d=r.substring(f)+d)}if(c.additionalWhiteSpaceSymbols)for(v=0;v<d.length;v++)if(-1==e.inArray(d[v],c.additionalWhiteSpaceSymbols)){d=d.substring(v);f+=v;break}return{value:d,
start:f,stop:f+d.length}},replace:function(c,b,d){var g=a.input.val();a.input.val(g.substring(0,c)+d+g.substring(b))},clearHighlights:function(c){var b=[];e.each(a.ranges,function(a,d){c&&d.className===c||b.push(d)});a.ranges=b;a.input.evolutionHighlight({ranges:a.ranges})},addHighlight:function(c){a.ranges.push(c)},renderHighlights:function(){a.input.evolutionHighlight({ranges:a.ranges})}}},d=function(b){b.input.bind({keypress:function(c){a(b,"onkeypress",c)},keydown:function(c){a(b,"onkeydown",
c)},textinput:function(d){c(b,d);a(b,"oninput",d);k(b,!1)}})},a=function(a,c,b){var d=!0;a.activePlugin&&a.activePlugin[c]&&(d=a.activePlugin[c].call(b.target,a.pluginContext,b));d?a[c]&&((d=a[c].call(b.target,b))||b.preventDefault()):b.preventDefault()},c=function(a,c){a.activePlugin||e.each(a.plugins,function(c,b){if(b.shouldActivate&&!0===b.shouldActivate.call(a.input,a.pluginContext))return a.activePlugin=b,b.onActivate&&b.onActivate.call(a.input,a.pluginContext),!1})},k=function(a,c){e.each(a.plugins,
function(b,d){d.onTransform&&d.onTransform.call(a.input,a.pluginContext,c)})},g=function(a){var c=[];e.each([" ","\t","\n"],function(b,d){var g=a.indexOf(d);0<=g&&c.push(g)});c.sort();return 0<c.length?c[0]:-1},m=function(a){var c=[];e.each([" ","\t","\n"],function(b,d){var g=a.lastIndexOf(d);0<=g&&c.push(g)});c.sort();return 0<c.length?c[c.length-1]:-1},q=function(a){a=a.get(0);if(a.selectionStart)return a.selectionStart;if(document.selection){var c=document.selection.createRange();if(null===c)return 0;
a=a.createTextRange();var b=a.duplicate();a.moveToBookmark(c.getBookmark());b.setEndPoint("EndToStart",a);return b.text.length}return 0},r=function(a){"undefined"!==typeof e.fn.evolutionResize&&a.input.evolutionResize().bind("evolutionResize",function(){a.input.evolutionHighlight("resize",a.input.width(),a.input.height())})},v={init:function(a){return this.filter("textarea").each(function(){var c=e(this),b=n(c,a);r(b);b.input.evolutionHighlight("resize",b.input.width(),b.input.height());if(null!==
b){e.each(b.plugins,function(a,d){d.init&&d.init.call(c,b.pluginContext)});b.settings.focus&&setTimeout(function(){c.focus()},10);var d=e.trim(b.input.val());0<d.length&&v.val.call(b.input,d)}})},val:function(a){if("undefined"!==typeof a){var c=n(this);c&&(c.input.val(a),k(c,!0),c.input.trigger("input"))}else{var c=n(this),b="";c&&(b=c.input.val(),e.each(c.plugins,function(a,d){d.val&&(b=d.val.call(c.input,b,c.pluginContext))}));return b}return this},onkeydown:function(a){var c=n(this);c&&(c.onkeydown=
a);return this},oninput:function(a){var c=n(this);c&&(c.oninput=a);return this},resize:function(a,c){var b=n(this);b&&b.input.evolutionHighlight("resize",a,c);return this}};e.fn.evolutionComposer=function(a){if(v[a])return v[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)e.error("Method "+a+" does not exist on jQuery.evolutionComposer");else return v.init.apply(this,arguments)};e.fn.evolutionComposer.defaults={plugins:[],focus:!0};e.fn.evolutionComposer.plugins={};
return{}},jQuery,window);s("plugin.evolutionHighlight",function(f,e,p){var l=function(a,b){var d=a.data("_HIGHLIGHTER_CONTEXT");if("undefined"===typeof d||null===d)d={selection:a.filter("textarea"),settings:f.extend({},f.fn.evolutionHighlight.defaults,b||{})},n(d),a.data("_HIGHLIGHTER_CONTEXT",d);return d},n=function(a){a.wrapper=f("<div></div>");a.mirror=f("<div></div>");var b={position:"relative",width:a.selection.outerWidth(),height:a.selection.outerHeight()};f.each(["margin-left","margin-right",
"margin-top","margin-bottom"],function(d,g){b[g]=a.selection.css(g);a.selection.css(g,0)});var d={position:"absolute",top:"0px",left:"0px",zIndex:"0",borderTopColor:"transparent",borderBottomColor:"transparent",borderLeftColor:"transparent",borderRightColor:"transparent",backgroundColor:a.selection.css("backgroundColor"),color:"transparent",width:a.selection.width(),height:a.selection.height(),overflow:"hidden",whiteSpace:"normal"};f.each(a.settings.styles,function(b,k){d[k]=a.selection.css(k)});
var m={position:"absolute",top:"0px",left:"0px",zIndex:"1",backgroundColor:"transparent",width:a.selection.width(),height:a.selection.height()};a.wrapper.css(b).addClass("highlighter");a.mirror.css(d);a.selection.css(m);a.mirror.css("color",a.mirror.css("background-color"));a.selection.before(a.wrapper);a.wrapper.append(a.selection);a.wrapper.append(a.mirror)},h=/\s\s/gi,b=/\n/gi,d=function(a){var d={};f.each(a.settings.ranges,function(a,c){d[c.start]=d[c.start]||[];d[c.start].push(c);d[c.stop]=d[c.stop]||
[];d[c.stop].push(c)});var g=f.telligent.evolution.html.encode(a.selection.val());newValue=[];for(var m=spanDepth=0;m<g.length;m++)"undefined"!==typeof d[m]&&f.each(d[m],function(a,c){c.start===m?(newValue[newValue.length]='<span class="'+c.className+'" style="white-space:normal;">',spanDepth++):(newValue[newValue.length]="</span>",spanDepth--)}),newValue[newValue.length]=g.charAt(m);0<spanDepth&&(newValue[newValue.length]="</span>");var g=newValue.join("").replace(b,"<br />").replace(h,"&nbsp; "),
q=document.createElement("span");q.innerHTML=g;a.mirror.empty().get(0).appendChild(q)},a={init:function(a){var b=l(this,a);b.settings=f.extend({},f.fn.evolutionHighlight.defaults,a||{});d(b);return this},clear:function(){var a=l(this,null);if(null!==a)return a.mirror.html(""),this},resize:function(a,b){var d=l(this,null);if(null!==d){var m={width:a,height:b};d.mirror.css(m);d.selection.css(m);d.wrapper.css({width:d.selection.outerWidth(),height:d.selection.outerHeight()});return this}},css:function(a){var b=
l(this,null);if(null!==b)return b.wrapper.css(a),this}};f.fn.evolutionHighlight=function(c){if(a[c])return a[c].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof c&&c)f.error("Method "+c+" does not exist on jQuery.evolutionHighlight");else return a.init.apply(this,arguments)};f.fn.evolutionHighlight.defaults={ranges:[],styles:"border-top-width border-top-style border-bottom-width border-bottom-style border-right-width border-right-width-value border-right-style border-right-style-value border-left-width border-left-width-value border-left-style border-left-style-value font-family font-size font-size-adjust font-stretch font-style font-variant font-weight padding-bottom padding-left padding-right padding-top letter-spacing line-height text-align text-indent word-spacing".split(" ")};
return{}},jQuery,window);s("plugin.evolutionInlineTagEditor",function(f,e,p){var l={},n=function(b,a){if(b.internal.isInitialized){for(var c=a.split(/[,;]/g),k=[],g=0;g<c.length;g++){var m=f.trim(c[g]);m&&(k[k.length]=m)}b.settings.onSave(k,function(){b.settings.currentTags=k})}},h=function(d){return this.each(function(){var a={settings:f.extend({},f.fn.evolutionInlineTagEditor.defaults,d||{}),internal:{state:f(this)}};f(this).data("evolutionTagInlineEditor_context",a);f(this).html()||f(this).text(a.settings.editButtonText);
b(a)})},b=function(b){var a=f("<div></div>").addClass(b.settings.editorCssClass).attr("style","display: none;"),c=f('<label for="tag-area"></label>').hide(),k=f('<textarea id="tag-area"></textarea>').attr("cols","40").attr("rows","2");if(b.settings.allTags&&0<b.settings.allTags.length)var g=f('<input type="button" />').val(b.settings.selectTagsText);var m=f('<input type="button" />').val(b.settings.saveTagsText),q=f('<input type="button" />').val(b.settings.cancelText),e=f('<div style="white-space: nowrap; padding-top: 4px;"><table width="100%" cellspacing="0" cellpadding="0" border="0"><tbody><td align="left"></td><td align="right"></td></tr></tbody></table></div>');
e.find("td:eq(1)").append(m);e.find("td:eq(1)").append(q);g&&e.find("td:first").append(g);a.append(c);a.append(k);a.append(e);k.evolutionTagTextBox({allTags:b.settings.allTags});a.glowPopUpPanel({cssClass:b.settings.editorCssClass,position:"updown",zIndex:500,hideOnDocumentClick:!1});f(b.internal.state).bind("click.evolutionInlineTagEditor",function(c){a.glowPopUpPanel("hide").glowPopUpPanel("show",f(this));k.val(0<b.settings.currentTags.length?b.settings.currentTags.join(", "):"");return!1});m.bind("click.evolutionInlineTagEditor",
function(c){n(b,k.attr("value"));a.glowPopUpPanel("hide");return!1});q.bind("click.evolutionInlineTagEditor",function(c){a.glowPopUpPanel("hide");return!1});g&&g.bind("click.evolutionInlineTagEditor",function(a){k.evolutionTagTextBox("openTagSelector");return!1});b.internal.state.after(a);b.internal.isInitialized=!0};f.fn.evolutionInlineTagEditor=function(b){if(b in l)return l[b].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof b&&b)f.error("Method "+b+" does not exist on jQuery.fn.evolutionInlineTagEditor");
else return h.apply(this,arguments)};f.extend(f.fn.evolutionInlineTagEditor,{defaults:{allTags:[""],currentTags:[""],editorCssClass:"tags-editor",editButtonText:"Edit",selectTagsText:"Select Tags",saveTagsText:"Save",cancelText:"Cancel",onSave:function(b,a){}}});return{}},jQuery,window);s("plugin.evolutionLike",function(f,e,p){var l=!1,n=function(a){var c=a.settings.format;a.hasCount&&(c=c.replace(/\{count\}/gi,'<span class="like-count who-likes"></span>'));a.hasToggle&&(c=c.replace(/\{toggle\}/gi,
'<span class="like-toggle"><a href="#" class="internal-link"></a></span>'));a.hasMessage&&(c=c.replace(/\{message\}/gi,'<span class="like-message"></span>'));a.element.html(c);a.hasCount&&(a.countWrapper=a.element.find("span.like-count"),a.countWrapper.html(a.settings.initialCount),a.countWrapper.attr("data-count",a.settings.initialCount));a.hasToggle&&(a.toggleLink=a.element.find("span.like-toggle a"),a.toggleLink.evolutionToggleLink({onHtml:"<span></span>"+a.settings.unlikeText,offHtml:"<span></span>"+
a.settings.likeText,onTitle:"",offTitle:"",processingHtml:"<span></span>...",changeState:function(c){b(c,a)},onCssClass:"internal-link like-on",offCssClass:"internal-link like-off",processingCssClass:"internal-link processing",val:"true"===a.settings.initialState}));a.hasMessage&&(a.messageWrapper=a.element.find("span.like-message"),a.messageWrapper.html(a.settings.initialMessage))},h=function(a,c,b){var d="";if(0<c.count){var m=0;b?1===c.count?d=a.settings.whoLikesAccessingText:2===c.count?(d=a.settings.whoLikesAccessingTwoText,
m=-1):2<c.count&&(d=a.settings.whoLikesAccessingMultipleText,m=-1):1===c.count?d=a.settings.whoLikesOtherText:2===c.count?(m=-1,d=a.settings.whoLikesOtherTwoText):2<c.count&&(m=-1,d=a.settings.whoLikesOtherMultipleText);d=d.replace(/\{count\}/gi,c.count+m);d=d.replace(/\{user_profile_url\}/gi,c.latestLike.User.ProfileUrl);d=d.replace(/\{user_display_name\}/gi,c.latestLike.User.DisplayName)}f.telligent.evolution.messaging.publish("ui.like",{contentId:a.settings.contentId,contentTypeId:a.settings.contentTypeId,
typeId:a.settings.typeId,count:c.count,liked:b,message:d})},b=function(a,c){if(a)c.settings.onLike(c.settings.contentId,c.settings.contentTypeId,c.settings.typeId,function(a){h(c,a,!0)});else c.settings.onUnlike(c.settings.contentId,c.settings.contentTypeId,c.settings.typeId,function(a){h(c,a,!1)})},d=function(a){f.telligent.evolution.messaging.subscribe("ui.like",function(c){c.contentId===a.settings.contentId&&(c.contentTypeId===a.settings.contentTypeId&&c.typeId===a.settings.typeId)&&(a.hasToggle&&
a.toggleLink.evolutionToggleLink("val",c.liked),a.hasCount&&(a.countWrapper.html(c.count),a.countWrapper.attr("data-count",c.count)),a.hasMessage&&a.messageWrapper.html(c.message))})};f.fn.evolutionLike=function(a){var c=f.extend({},f.fn.evolutionLike.defaults,a||{});return this.each(function(){var a={element:f(this),settings:c,hasCount:0<=c.format.indexOf("{count}"),hasToggle:0<=c.format.indexOf("{toggle}"),hasMessage:0<=c.format.indexOf("{message}")};n(a);d(a)})};f.fn.evolutionLike.delegatePopups=
function(a){if(!l){l=!0;var c=f.extend({},f.fn.evolutionLike.defaults,a||{}),b=f.telligent.evolution.template.compile(c.likersTemplate),d=f.telligent.evolution.template.compile(c.likersPopupTemplate),m=function(a,b,d){c.onList(a.contentId,a.contentTypeId,a.typeId,function(a){d(a)},a.pageSize,b)},q=function(a,q){var e=0,h=f(b(a)),t=f(d({likers:h,hasMorePages:a.hasMorePages,showMoreText:c.modalShowMoreText})),l=t.find("ul"),n=t.find(".show-more"),B=c.onOptions(f(q).closest(c.delegatedSelector));l.html(h);
n.on("click",function(a){a.preventDefault();e++;m(B,e,function(a){l.append(b(a));a.hasMorePages?n.show():n.hide();l.scrollTop(l[0].scrollHeight)})});f.glowModal({title:c.modalTitleText,html:t,width:450,height:"100%"})};(function(){f(c.containerSelector).on("click",c.delegatedSelector+" .who-likes",function(a){var b=f(this);a=c.onOptions(f(b).closest(c.delegatedSelector));m(a,0,function(a){q(a,b)})})})()}};f.fn.evolutionLike.defaults={contentId:"",contentTypeId:"",typeId:"",initialState:!1,initialMessage:"",
initialCount:0,format:"",onLike:function(a,c,b,d){},onUnlike:function(a,c,b,d){},likeText:"Like",unlikeText:"Unlike",whoLikesOtherText:'<a href="{user_profile_url}" class="internal-link view-user-profile">{user_display_name}</a> likes this',whoLikesOtherTwoText:'<a href="{user_profile_url}" class="internal-link view-user-profile">{user_display_name}</a> <span class="who-likes">and 1 other</span> like this.',whoLikesOtherMultipleText:'<a href="{user_profile_url}" class="internal-link view-user-profile">{user_display_name}</a> and <span class="who-likes">{count} others</span> like this.',
whoLikesAccessingText:"You like this",whoLikesAccessingTwoText:'You and <span class="who-likes">1 other</span> like this',whoLikesAccessingMultipleText:'You and <span class="who-likes">{count} others</span> like this',modalTitleText:"People who like this",modalShowMoreText:"Show more",onList:function(a,c,b,d){},onOptions:function(a){},containerSelector:"",delegatedSelector:"",delay:500,likersTemplate:' <% foreach(likers, function(liker) { %>      <li class="content-item">          <div class="full-post-header"></div>          <div class="full-post">              <span class="avatar">                  <a href="<%: liker.profileUrl %>"  class="internal-link view-user-profile">                      <% if(liker.avatarHtml) { %>                          <%= liker.avatarHtml %>                      <% } else { %>                          <img src="<%: liker.avatarUrl %>" alt="" border="0" width="32" height="32" style="width:32px;height:32px" />                      <% } %>                  </a>              </span>              <span class="user-name">                  <a href="<%: liker.profileUrl %>" class="internal-link view-user-profile"><%= liker.displayName %></a>              </span>          </div>          <div class="full-post-footer"></div>      </li>  <% }); %> ',
likersPopupTemplate:' <div class="who-likes-list">      <div class="content-list-header"></div>      <ul class="content-list"><%= likers %></ul>      <div class="content-list-footer"></div>      <% if(hasMorePages) { %>          <a href="#" class="show-more"><%= showMoreText %></a>     <% } %>  </div> '};return{}},jQuery,window);s("plugin.evolutionMasonry",["lib.util"],function(f,e,p,l){function n(a){function c(d){a.length<=d?b.resolve():a[d]().done(function(){c(d+1)}).fail(function(){b.reject()})}
var b;b=e.Deferred();c(0);return b.promise()}function h(a){return e(document.createElement("div")).html("&nbsp;").addClass(a.columnClass).css({"float":"left",minHeight:"1px",overflow:"hidden"})}function b(a){for(var c=0;c<a.columns.length;c++)e(a.columns[c]).empty()}function d(a){for(var c=null,b=null,d=0;d<a.columns.length;d++)if(null===c||null===b)c=a.columns[d],b=a.columns[d].height();else{var g=a.columns[d].height();g<b&&(c=a.columns[d],b=g)}return c}function a(a,c){var g;c?g=c:(g=a.children,
b(a));n(e.map(g,function(c){return function(){return e.Deferred(function(b){var g=d(a);if(g){var m=g.height();a.animate?e(c).appendTo(g).css({opacity:0.01}).evolutionTransform({opacity:0.99},{duration:a.animationDuration}):g.append(c);var k=setInterval(function(){g.height()-m>a.threshold&&(clearInterval(k),clearTimeout(r),b.resolve())},5),r=setTimeout(function(){clearInterval(k);clearTimeout(r);b.resolve()},500)}else b.reject()}).promise()}}))}function c(c,b){b&&c.children.detach();c.container.empty();
c.columns=[];var d=0,g=0,m=h(c),k=!1;m.height(1200).appendTo(c.container);g=c.container.width();m.height(0).remove();for(var e=50;d<g&&0<e;){e--;var f=h(c);k?m.before(f):f.appendTo(c.container);d+=f.outerWidth(!0);d<=g?c.columns.push(f):f.remove();k||(m.appendTo(c.container),k=!0)}k&&m.remove();a(c)}function k(a){return this.each(function(){var b=e.extend({},e.fn.evolutionMasonry.defaults,a||{});b.container=e(this);b.children=b.container.children().detach();c(b);e(window).on("resized",function(){c(b,
!0)});b.container.data(g,b)})}var g="_evolutionMasonry_context",m={append:function(c){if(c&&0!=c.length){var b=e(c).filter("div");return this.each(function(){var c=e(this).data(g);c&&(c.children=c.children.add(b),a(c,b))})}}};e.fn.evolutionMasonry=function(a){if(a in m)return m[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)e.error("Method "+a+" does not exist on jQuery.fn.evolutionMasonry");else return k.apply(this,arguments)};e.fn.evolutionMasonry.defaults={columnClass:"masonry-column",
animate:!0,animationDuration:150,threshold:35};return{}},jQuery,window);s("plugin.evolutionModerate",function(f,e,p){var l=f.telligent.evolution,n=function(b){b.settings.onReport(b.settings.contentId,b.settings.contentTypeId,function(d){l.messaging.publish("ui.reportabuse",{contentId:b.settings.contentId,contentTypeId:b.settings.contentTypeId});showNotification(b,d.Report)})},h=function(b){b.hideTimer&&(clearTimeout(b.hideTimer),b.hideTimer=null)};buildModerationLink=function(b){b.moderationLink=
f(l.template.compile(b.settings.moderationLinkTemplate)({linkClassName:b.settings.linkClassName,resources:{moderateLinkText:b.settings.moderateLinkText}})).appendTo(b.element)};buildModerationPopup=function(b){b.popup=f("<div></div>").glowPopUpPanel({cssClass:"content-moderation",position:"downleft",zIndex:1E3,hideOnDocumentClick:!0});b.popup.bind({glowPopUpPanelShown:function(d){b.moderationLink.addClass("open")},glowPopUpPanelHidden:function(d){b.moderationLink.removeClass("open")}})};buildModerationMenuContent=
function(b,d){b.settings.onGetAdditionalLinks(function(a){var c=[],c=b.settings.supportsAbuse?b.settings.initialState?a.concat([{href:"#",className:"evolutionModerateFlagged",text:b.settings.reportedLinkText}]):a.concat([{href:"#",className:"evolutionModerateFlag",text:b.settings.reportLinkText}]):a;a=f(l.template.compile(b.settings.moderationMenuTemplate)({links:c}));a.bind("mouseleave",function(a){hideMenu(b)});a.bind("mouseenter",function(a){h(b)});a.delegate("a","click",function(a){var c=f(a.target);
c.hasClass("evolutionModerateFlag")?(a.preventDefault(),n(b)):c.hasClass("evolutionModerateFlagged")?a.preventDefault():("#"===c.attr("href")&&a.preventDefault(),b.element.trigger("evolutionModerateLinkClicked",a.target))});d(a)})};showMenu=function(b){b.popup||buildModerationPopup(b);buildModerationMenuContent(b,function(d){h(b);b.popup.glowPopUpPanel("html",d).glowPopUpPanel("show",b.moderationLink)})};hideMenu=function(b){b.hideTimer||(b.hideTimer=setTimeout(function(){b.popup.glowPopUpPanel("hide");
b.hideTimer=null},200))};formatNotificationMessage=function(b,d){return b.settings.reportedNotificationMessageText.replace(/\{NAME\}/gi,d&&d.AuthorUser&&d.AuthorUser.DisplayName?d.AuthorUser.DisplayName:"")};showNotification=function(b,d){var a=l.template.compile(b.settings.notificationTemplate)({resources:{reportedNotificationMessageText:formatNotificationMessage(b,d),undoLinkText:b.settings.undoLinkText},contextId:b.contextId});l.notifications.show(a,{type:"moderation",duration:b.settings.notificationDuration,
cssClass:""})};handleFlagMessages=function(b){l.messaging.subscribe("ui.reportabuse",function(d){b.settings.contentId===d.contentId&&b.settings.contentTypeId===d.contentTypeId&&(b.settings.initialState=!0)})};init=function(b){buildModerationLink(b);b.moderationLink.bind({mouseenter:function(d){d.preventDefault();b.popup&&b.popup.glowPopUpPanel("isShown")?hideMenu(b):showMenu(b);h(b)},mouseleave:function(d){f(d.relatedTarget).is(".content-moderation")||0!==f(d.relatedTarget).closest(".content-moderation").length||
hideMenu(b)}});handleFlagMessages(b)};f.fn.evolutionModerate=function(b){var d=f.extend({},f.fn.evolutionModerate.defaults,b||{});return this.each(function(){var a={element:f(this),settings:d};init(a)})};f.fn.evolutionModerate.defaults={contentId:"",contentTypeId:"",initialState:!1,linkClassName:"",onReport:function(b,d,a){},onGetAdditionalLinks:function(b){b([])},notificationDuration:5E3,moderateLinkText:"moderate",supportsAbuse:!0,reportLinkText:"Flag as spam/abuse",reportedLinkText:"Flagged as spam/abuse",
reportedNotificationMessageText:"{NAME}'s post has been flagged. <strong>Thank you for your feedback.</strong>",undoLinkText:"Undo",moderationLinkTemplate:'<a href="#" class="<%: linkClassName %>"><span></span><%= resources.moderateLinkText %></a>',moderationMenuTemplate:'<ul class="navigation-list">   <% foreach(links, function(link){ %>       <li class="navigation-item">           <a href="<%: (link.href || "#") %>" class="<%: (link.className || "") %>"><%= link.text %></a>       </li>   <% }); %></ul>',
notificationTemplate:"<p><%= resources.reportedNotificationMessageText %></p>"};return{}},jQuery,window);s("plugin.evolutionPager",function(f,e,p){var l={},n={},h={},b=function(a){var c=[],b=a.settings,d=function(a){var c={};c[b.pageKey]=a;a={url:b.baseUrl,query:c};b.hash&&0<b.hash.length&&(a[b.hash]=b.hash);return f.telligent.evolution.url.modify(a)};0===b.totalItems||0===b.pageSize?a=0:(a=Math.floor(b.totalItems/b.pageSize),0<b.totalItems%b.pageSize&&(a+=1));if(1<a){b.showFirst&&3<=b.currentPage&&
a>b.numberOfPagesToDisplay&&(c[c.length]={type:"first",selected:!1,page:1,url:d(1)});b.showPrevious&&0<b.currentPage&&(c[c.length]={type:"previous",selected:!1,page:b.currentPage,url:d(b.currentPage)});if(b.showIndividualPages){var g;g=a<b.numberOfPagesToDisplay||0>b.currentPage-Math.floor(b.numberOfPagesToDisplay/2)?0:b.currentPage+Math.floor(b.numberOfPagesToDisplay/2)>=a?a-b.numberOfPagesToDisplay:b.currentPage-Math.floor(b.numberOfPagesToDisplay/2);var m;m=Math.floor(b.numberOfPagesToDisplay/
2);0===b.numberOfPagesToDisplay%2&&(m-=1);for(m=a<b.numberOfPagesToDisplay||b.currentPage+m>=a?a-1:0>b.currentPage-Math.floor(b.numberOfPagesToDisplay/2)?b.numberOfPagesToDisplay-1:b.currentPage+m;g<=m;g++)c[c.length]={type:"page",selected:b.currentPage===g,page:g+1,url:d(g+1)}}b.showNext&&b.currentPage+1<a&&(c[c.length]={type:"next",selected:!1,page:b.currentPage+2,url:d(b.currentPage+2)});b.showLast&&b.currentPage+3<a&&a>b.numberOfPagesToDisplay&&(c[c.length]={type:"last",selected:!1,page:a,url:d(a)})}return c},
d=function(a){var c=a.template({links:a.links});a.selection.html(c)},a=function(a){if(!a.settings.refreshOnAnyHashChange)return null;var c=f.telligent.evolution.url.hashData(),b=null,d;for(d in c)0==d.indexOf(a.settings.pageKey)&&(b=b||{},b[d.substr(a.settings.pageKey.length)]=c[d]);return b},c=function(c){var b=parseInt(f.telligent.evolution.url.hashData()[c.settings.pageKey],10),d=a(c);d&&(b=b||1);isNaN(b)||b===c.settings.currentPage||h[c.settings.pageKey]||(h[c.settings.pageKey]=!0,c.settings.onPage(b,
function(a){c.currentPageIndex=b;q(c,b,0,a,!1)},d||{}))},k=function(a){f(a.selection).delegate("a","click",function(c){c.preventDefault();c=f(this);var b={};b[a.settings.pageKey]=c.data("page");f.telligent.evolution.url.hashData(b)})},g=function(c){l[c.settings.pageKey]||(l[c.settings.pageKey]=!0,c.currentPageIndex=parseInt(f.telligent.evolution.url.hashData()[c.settings.pageKey],10),isNaN(c.currentPageIndex)&&(c.currentPageIndex=c.settings.currentPage),f(window).bind("hashchange",function(b){b=parseInt(f.telligent.evolution.url.hashData()[c.settings.pageKey],
10);if(a(c)||!isNaN(b)&&c.currentPageIndex!=b){c.newPageIndex=b;var d={currentPage:c.currentPageIndex||1,newPage:c.newPageIndex||1,container:c.settings.pagedContentContainer};f.telligent.evolution.messaging.publish(c.settings.pagedContentPagingEvent,d);c.selection.trigger("evolutionPagerPaging",d);c.currentPageIndex=b}}))},m=function(c){n[c.settings.pagedContentPagingEvent]&&(c.currentPageIndex=parseInt(f.telligent.evolution.url.hashData()[c.settings.pageKey],10),f.telligent.evolution.messaging.unsubscribe(n[c.settings.pagedContentPagingEvent]));
n[c.settings.pagedContentPagingEvent]=f.telligent.evolution.messaging.subscribe(c.settings.pagedContentPagingEvent,function(b){h[c.settings.pageKey]||(h[c.settings.pageKey]=!0,c.settings.onPage(b.newPage,function(a){c.currentPageIndex=b.newPage;q(c,b.newPage,b.currentPage,a,!0)},a(c)||{}))})},q=function(a,c,g,m,k){var e=function(){var b={page:c,container:a.settings.pagedContentContainer};f.telligent.evolution.messaging.publish(a.settings.pagedContentPagedEvent,b);a.selection.trigger("evolutionPagerPaged",
b)};!k||"slide"!==a.settings.transition&&"fade"!==a.settings.transition?(f(a.settings.pagedContentContainer).html(m),e(),h[a.settings.pageKey]=!1):(k="fade","slide"===a.settings.transition&&(k=c<g?"slideRight":"slideLeft"),g=f(a.settings.pagedContentContainer),m=f("<div></div>").attr("id",g.attr("id")).html(m).hide().insertAfter(a.settings.pagedContentContainer),g.glowTransition(m,{type:k,duration:a.settings.transitionDuration,complete:function(){f(a.settings.pagedContentContainer).css({width:"",
height:"",overflow:"hidden"});e();h[a.settings.pageKey]=!1}}));a.settings.currentPage=c-1;a.links=b(a);d(a)};f.fn.evolutionPager=function(a){a=f.extend({},f.fn.evolutionPager.defaults,a||{});var e={selection:this,settings:a,template:f.telligent.evolution.template.compile(a.template)};e.links=b(e);d(e);a.onPage&&(a.pagedContentContainer&&0<a.pagedContentContainer.length)&&(m(e),g(e),k(e),c(e));return this};f.fn.evolutionPager.defaults={currentPage:0,pageSize:10,totalItems:0,showPrevious:!1,showNext:!1,
showFirst:!0,showLast:!0,showIndividualPages:!0,numberOfPagesToDisplay:5,pageKey:"pi",hash:"",baseUrl:window.location.href,onPage:function(a,c){},pagedContentContainer:"",pagedContentPagingEvent:"ui.page.paging",pagedContentPagedEvent:"ui.page.paged",transition:null,transitionDuration:250,refreshOnAnyHashChange:!1,template:' <% foreach(links, function(link, i) { %>      <% if(link.type === "first") { %>          <a href="<%: link.url %>" class="first" data-type="first" data-page="<%= link.page %>" data-selected="false"><span>&#171;</span></a>      <% } else if(link.type === "previous") { %>          <a href="<%: link.url %>" class="previous" data-type="previous" data-page="<%= link.page %>" data-selected="false"><span>&#60;</span></a>     <% } else if(link.type === "page") { %>          <a href="<%: link.url %>" class="page<%= link.selected ? " selected" : "" %>" data-type="page" data-page="<%= link.page %>" data-selected="<%= link.selected ? "true" : "false" %>"><span><%= link.page %></span></a>      <% } else if(link.type === "next") { %>          <a href="<%: link.url %>" class="next" data-type="next" data-page="<%= link.page %>" data-selected="false"><span>&#62;</span></a>     <% } else if(link.type === "last") { %>          <a href="<%: link.url %>" class="last" data-type="last" data-page="<%= link.page %>" data-selected="false"><span>&#187;</span></a>      <% } %>      <% if(i < (links.length - 1)) { %>          <span class="separator"></span>      <% } %>  <% }); %> '};
return{}},jQuery,window);s("plugin.evolutionResize",function(f,e,p){function l(){if(!h){h=!0;var a=f("<textarea>test</textarea>").css({overflow:"hidden",resize:"none",visible:"none"}).appendTo("body");1>=Math.abs(a.prop("scrollHeight")-a.height())&&(n=0);a.remove()}}var n=null,h=!1,b=function(a){a.area.css({height:"auto"}).css({height:a.area.prop("scrollHeight")-(null===n?a.offset:n)});var c=a.area.outerHeight();c!==a.oldHeight&&(c>=a.maxHeight?a.area.css({overflow:"visible"}):a.area.css({overflow:"hidden"}),
a.area.trigger("evolutionResize",{newHeight:c,oldHeight:a.oldHeight}),a.oldHeight=c)},d=function(a){return parseInt(a.replace("px",""),10)};f.fn.evolutionResize=function(){l();return this.filter("textarea").each(function(){var a=f(this).css({resize:"none",overflow:"hidden"}),c={area:a,oldHeight:a.height(),maxHeight:d(a.css("max-height")),offset:a.innerHeight()!==a.height()?d(a.css("padding-top"))+d(a.css("padding-bottom")):0};a.bind("input keydown keyup",function(){b(c)});b(c)})};return{}},jQuery,
window);s("plugin.evolutionScrollSlider",function(f,e,p){var l=!1,n=function(b){var d=!1,a=function(){var a=b.document.height(),d=b.window.height(),g=b.window.scrollTop();return(a-g-d)/a};b.window.bind("scroll.evolutionScrollSlider",function(){d=!0});setInterval(function(){d&&(d=!1,!l&&1-a()>=b.revealAt?(l=!0,b.document.trigger("evolutionScrollSliderShow")):l&&1-a()<b.revealAt&&(l=!1,b.document.trigger("evolutionScrollSliderHide")))},b.bounceDelay)},h=function(b){var d=f("<div></div>").hide().addClass(b.className).css({width:b.width,
minHeight:b.height,maxHeight:0.7*b.window.height(),position:"fixed",bottom:b.offsetBottom,right:"0px"}).appendTo("body"),a=function(){b.load(function(a){a&&(d.html(a),d.css({right:-d.width()}).show().animate({right:b.offsetRight},{duration:b.animationDuration}))})},c=function(){d.animate({right:-d.width()},{duration:b.animationDuration,complete:function(){d.hide()}})};b.document.on("evolutionScrollSliderShow.evolutionScrollSlider",function(){a()}).on("evolutionScrollSliderHide.evolutionScrollSlider",
function(){c()})};f.evolutionScrollSlider=function(b){b=f.extend({},f.evolutionScrollSlider.defaults,b||{},{window:f(window),document:f(document)});b.document.unbind(".evolutionScrollSlider");b.window.unbind(".evolutionScrollSlider");n(b);h(b)};f.evolutionScrollSlider.hide=function(){f(document).trigger("evolutionScrollSliderHide")};f.evolutionScrollSlider.defaults={load:function(b){b(null)},width:400,height:75,className:"slider-content",animationDuration:250,offsetBottom:25,offsetRight:25,bounceDelay:150,
revealAt:0.8};return{}},jQuery,window);s("plugin.evolutionStarRating",function(f,e,p){var l=[],n=/MSIE 6/i.test(navigator.userAgent)?"gif":"png",h=function(a,c){return 1==c%2?a.settings.imagesPathUrl+"star-right-on."+n:a.settings.imagesPathUrl+"star-left-on."+n},b=function(a,c){return 1==c%2?a.settings.imagesPathUrl+"star-right-off."+n:a.settings.imagesPathUrl+"star-left-off."+n};_cacheImages=function(a){var c,d,g;for(g=0;2>g;g++)d=h(a,g),_isImageCached(d)||(c=new Image,c.src=d,l[l.length]=c),d=b(a,
g),_isImageCached(d)||(c=new Image,c.src=d,l[l.length]=c)};_isImageCached=function(a,c){var b;for(b=0;b<l.length;b++)if(l[b].src==c)return!0;return!1};_getItemTitle=function(a,c,b){return"object"==typeof a.settings.titles?a.settings.titles[c].replace("{0}",b):a.settings.titles?a.settings.titles.replace("{0}",b):b};_getValue=function(a){return"undefined"!==typeof a.internal.value?a.internal.value:a.settings.value};_setValue=function(a,c){a.internal.isInitialized&&!a.settings.isReadOnly&&(a.internal.value=
c,a.settings.allowMultipleSelections||(a.settings.isReadOnly=!0),a.internal.savingValue=!0,a.settings.onRate(c))};_showValue=function(a,c){var d,g=2*a.settings.maxRating;c=2*c-1;var m="img"==a.settings.starElement;for(d=0;d<g;d++)d<=c?m?f(a.internal.state.find("img").get(d)).attr("src",h(a,d)).removeClass().addClass("star-on-"+(0==d%2?"left":"right")):f(a.internal.state.find("span").get(d)).removeClass().addClass("star-on-"+(0==d%2?"left":"right")):m?f(a.internal.state.find("img").get(d)).attr("src",
b(a,d)).removeClass().addClass("star-off-"+(0==d%2?"left":"right")):f(a.internal.state.find("span").get(d)).removeClass().addClass("star-off-"+(0==d%2?"left":"right"))};_mouseOver=function(a,c){a.internal.isInitialized&&!a.settings.isReadOnly&&(a.internal.state.addClass(a.settings.overClass),_showValue(a,c))};_mouseOut=function(a,c){a.internal.isInitialized&&!a.settings.isReadOnly&&(a.internal.state.removeClass(a.settings.overClass),_showValue(a,c))};_init=function(a){return this.each(function(){var c=
{settings:f.extend({},f.fn.evolutionStarRating.defaults,a||{}),internal:{state:f(this)}};c.settings.imagesPathUrl||(c.settings.imagesPathUrl=f.telligent.evolution.site.getBaseUrl()+"utility/images/");_cacheImages(c);f(this).data("evolutionStarRating_context",c);_initialize(c)})};_initialize=function(a){a.internal.state.addClass(a.settings.starClass).css("white-space","nowrap").find("a").unbind(".evolutionStarRating").empty().end().bind("mouseleave",function(){_showValue(a,_getValue(a))});a.settings.isReadOnly&&
a.internal.state.addClass(a.settings.readOnlyClass);var c,d=2*a.settings.maxRating,g="undefined"===typeof a.settings.ratingCount,m="img"==a.settings.starElement;for(c=0;c<d;c++)(function(){var d,e;e=m?f("<img />").css({borderLeftWidth:"0px",borderTopWidth:"0px",borderRightWidth:"0px",borderBottomWidth:"0px"}):f("<span></span>");a.settings.isReadOnly||(d=f('<a href="#" />').css({textDecoration:"none"}).append(e));var k=(c+1)/2;k<=a.settings.value?m?e.attr("src",h(a,c)).addClass("star-on-"+(0==c%2?
"left":"right")):e.addClass("star-on-"+(0==c%2?"left":"right")):m?e.attr("src",b(a,c)).addClass("star-off-"+(0==c%2?"left":"right")):e.addClass("star-off-"+(0==c%2?"left":"right"));if(!a.settings.isReadOnly){if(a.settings.useHalfStars)u=_getItemTitle(a,c,k);else var k=Math.ceil(k),u=_getItemTitle(a,k,k);g&&d.attr("title",u);m&&e.attr("alt",u);d.data("rating-value",k).bind("click.evolutionStarRating",function(c){_setValue(a,d.data("rating-value"));return!1}).bind("focus.evolutionStarRating",function(c){_mouseOver(a,
d.data("rating-value"))}).bind("mouseover.evolutionStarRating",function(c){_mouseOver(a,d.data("rating-value"))}).bind("blur.evolutionStarRating",function(c){_mouseOut(a,d.data("rating-value"))}).bind("mouseout.evolutionStarRating",function(c){_mouseOut(a,d.data("rating-value"))})}m&&e.attr("align","absmiddle").attr("border",0);d?a.internal.state.append(d):a.internal.state.append(e)})();_setMessage(a);a.internal.isInitialized=!0};_setMessage=function(a){!a.settings.ratingMessageFormat||(isNaN(parseInt(a.settings.ratingCount))||
isNaN(parseInt(a.settings.value)))||a.internal.state.attr("title",a.settings.ratingMessageFormat.replace(/\{rating\}/gi,Math.round(10*a.settings.value)/10).replace(/\{count\}/gi,a.settings.ratingCount))};var d={val:function(a){var c=this.data("evolutionStarRating_context");return null!==c?"undefined"!==typeof a?(c.internal.value=a,_showValue(c,a),a):_getValue(c):0},readOnly:function(a){var c=this.data("evolutionStarRating_context");if(null!==c)if("undefined"!==typeof a)(c.settings.isReadOnly=a)?c.internal.state.find("a").css({cursor:"default"}):
c.internal.state.find("a").css({cursor:"pointer"});else return c.settings.isReadOnly;return!0},option:function(a,c){if("object"===typeof a)return this.each(function(){var c=f(this).data("evolutionStarRating_context");null!=c&&(c.settings=f.extend({},c.settings,a),_init.apply(f(this),[c.settings]))});if("undefined"!==typeof a&&"undefined"!==typeof c)return this.each(function(){var b=f(this).data("evolutionStarRating_context");null!=b&&(b.settings[a]=c,_init.apply(f(this),[b.settings]))});if("undefined"!==
typeof a){var b=this.data("evolutionStarRating_context");return null!==b?b.settings[a]:null}}};f.fn.evolutionStarRating=function(a){if(a in d)return d[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)f.error("Method "+a+" does not exist on jQuery.fn.evolutionStarRating");else return _init.apply(this,arguments)};f.extend(f.fn.evolutionStarRating,{defaults:{value:0,maxRating:5,imagesPathUrl:"",starElement:"img",useHalfStars:!1,starClass:"rating",overClass:"active",readOnlyClass:"readonly",
titles:"Terrible Poor Fair Average Good Excellent".split(" "),isReadOnly:!1,allowMultipleSelections:!0,ratingCount:void 0,ratingMessageFormat:"Average rating: {rating} out of {count} ratings.",onRate:function(a){}}});return{}},jQuery,window);s("plugin.evolutionTagTextBox",function(f,e,p){var l={openTagSelector:function(){var a=this.data("evolutionTagTextBox");if(a){window.__tagEditor={SetSelectedTags:function(b){for(var d=[],e=h(a),k=a.settings.allTags,v,u=0;u<e.length;u++){v=!1;for(var w=0;w<k.length;w++)if(e[u].toUpperCase()==
k[w].toUpperCase()){v=!0;break}v||(d[d.length]=e[u])}for(u=0;u<b.length;u++)d[d.length]=b[u];f(a.internal.state).val(d.join(", "))},GetAllTagsWithEncoding:function(){for(var b=[],d=a.settings.allTags,e=f("<div></div>"),k=0;k<d.length;k++)e.text(d[k]),b[k]=[d[k],e.html()];return b},GetSelectedTags:function(){return h(a)}};var b=f.telligent.evolution.ensureRemoteUrlEncoding(a.settings.selectTagsModalUrl);"~/"==b.substr(0,2)&&(b=f.telligent.evolution.site.getBaseUrl()+b.substr(2));window.Telligent_Modal?
window.Telligent_Modal.Open(b,400,350,null):f.glowModal&&f.glowModal(b,{width:400,height:350})}}},n=function(c){return this.each(function(){var e={settings:f.extend({},f.fn.evolutionTagTextBox.defaults,c||{}),internal:{state:this,suggestionTimeoutHandle:null,previousTags:[],previousValue:"",currentTag:"",currentTagPosition:0}};f(this).data("evolutionTagTextBox",e);a(e);f(this).bind("keyup.evolutionTagTextBox",function(a){return d(e,a)});f(this).bind("keydown.evolutionTagTextBox",function(a){return b(e,
a)});f(this).bind("onblur.evolutionTagTextBox",function(a){window.clearTimeout(e.internal.suggestionTimeoutHandle);return!0})})},h=function(a){a=f(a.internal.state).val().split(/;|,/);for(var b=[],d=0;d<a.length;d++)a[d]=a[d].replace(/^\s+|\s+$/g,""),""!=a[d]&&(b[b.length]=a[d]);return b},b=function(a,b){window.clearTimeout(a.internal.suggestionTimeoutHandle);b||(b=window.event);if(b){if(13==b.keyCode){a.internal.state.focus();if(document.selection){var d=window.document.selection.createRange();d.text&&
0<d.text.length&&(d.moveStart("character",d.text.length),d.select())}else if(a.internal.state.selectionStart||"0"==a.internal.state.selectionStart)a.internal.state.selectionStart=a.internal.state.selectionEnd;b.cancelBubble=!0;return b.returnValue=!1}if(8==b.keyCode)if(a.internal.state.focus(),document.selection){if(d=window.document.selection.createRange())return d.moveStart("character",-1),d.text="",b.cancelBubble=!0,b.returnValue=!1}else if(a.internal.state.selectionStart||"0"==a.internal.state.selectionStart){var d=
a.internal.state.selectionStart,e=a.internal.state.selectionEnd;if(d==e)return!0;0<d&&d--;a.internal.state.value=a.internal.state.value.substring(0,d)+a.internal.state.value.substring(e);a.internal.state.selectionStart=d;a.internal.state.selectionEnd=d;b.cancelBubble=!0;return b.returnValue=!1}return!0}},d=function(c,b){window.clearTimeout(c.internal.suggestionTimeoutHandle);c.internal.suggestionTimeoutHandle=window.setTimeout(function(){if((document.selection||c.internal.state.selectionStart||"0"==
c.internal.state.selectionStart)&&f(c.internal.state).val()!=c.internal.previousValue&&(c.internal.previousValue=f(c.internal.state).val(),a(c),""!=c.internal.currentTag)){var b;b:{b=c.internal.currentTag;var d,e,k,h=c.settings.allTags;for(d=0;d<h.length;d++)if(0==h[d].toLowerCase().indexOf(b)){k=!1;for(e=0;e<c.internal.previousTags.length&&!k;e++)c.internal.previousTags[e]==h[d].toLowerCase()&&(k=!0);if(!k){b=h[d];break b}}b=null}if(b&&b.length!=c.internal.currentTag.length)if(b=b.substr(c.internal.currentTag.length),
f(c.internal.state).val(f(c.internal.state).val().substr(0,c.internal.currentTagPosition+c.internal.currentTag.length)+b+f(c.internal.state).val().substr(c.internal.currentTagPosition+c.internal.currentTag.length)),c.internal.state.focus(),document.selection)d=c.internal.state.createTextRange(),d.select(),d.moveStart("character",c.internal.currentTagPosition+c.internal.currentTag.length),d.moveEnd("character",-(f(c.internal.state).val().length-(c.internal.currentTagPosition+c.internal.currentTag.length+
b.length))),d.select();else if(c.internal.state.selectionStart||"0"==c.internal.state.selectionStart)c.internal.state.selectionStart=c.internal.currentTagPosition+c.internal.currentTag.length,c.internal.state.selectionEnd=c.internal.currentTagPosition+c.internal.currentTag.length+b.length}},249);return!0},a=function(a){var b=f(a.internal.state).val().toLowerCase().split(/;|,/),d,e,q;a.internal.currentTag="";var h=0,v=!0;for(d=0;d<b.length;d++){e=b[d].replace(/^\s+/g,"");h+=b[d].length-e.length;b[d]=
e;q=!1;for(e=0;e<a.internal.previousTags.length&&!q;e++)b[d]==a.internal.previousTags[e]&&(a.internal.previousTags.splice(e,1),q=!0);q||(""!=a.internal.currentTag?v=!1:(a.internal.currentTag=b[d],a.internal.currentTagPosition=h));h+=b[d].length+1}v||(a.internal.currentTag="");a.internal.previousTags=b};f.fn.evolutionTagTextBox=function(a){if(a in l)return l[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)f.error("Method "+a+" does not exist on jQuery.fn.evolutionTagTextBox");
else return n.apply(this,arguments)};f.extend(f.fn.evolutionTagTextBox,{defaults:{allTags:[],selectTagsModalUrl:"~/utility/tagselector?TagEditor=__tagEditor"}});return{}},jQuery,window);s("plugin.evolutionTextEditor",function(f,e,p){var l=function(b){var d="";b.isReadOnly?d=b.readOnlyView.html():f.telligent.evolution.put({url:f.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/html/fromtext.json",data:{text:b.editor.evolutionComposer("val")},dataType:"json",async:!1,success:function(a){d=a.Html}});
return d},n=function(b,d){f.telligent.evolution.put({url:f.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/text/fromhtml.json",data:{html:d},dataType:"json",async:!1,success:function(a){a.TextConversion.IsDataLost?(b.isReadOnly||(b.readOnlyView.css("height",b.editor.height()+"px"),b.readOnlyView.css("width",b.editor.width()+"px"),b.isReadOnly=!0,b.readOnlyView.show(),b.editorWrapper.hide()),b.readOnlyView.html(d),b.editor.val("<!html>"+d)):(b.isReadOnly&&(b.isReadOnly=!1,b.readOnlyView.hide(),
b.editorWrapper.show()),b.editor.evolutionComposer("val",a.TextConversion.Text),b.editor.trigger("input"))}})},h={init:function(b){return this.each(function(){var d=f(this);if(!d.data("__EVOLUTIONTEXTEDITOR_CONTEXT")){var a=d.innerWidth()-parseInt(d.css("padding-left"),10)-parseInt(d.css("padding-right"),10),c=d.innerHeight()-parseInt(d.css("padding-top"),10)-parseInt(d.css("padding-bottom"),10),e=d.val(),g=f('<div class="text-editor-wrapper"></div>');g.insertAfter(d);g.append(d);var m=f('<div class="text-editor-read-only" style="overflow: auto; padding: 2px; border: 1px solid; box-sizing: border-box"></div>').hide();
m.on("click",function(){b.readOnlyMessage&&alert(b.readOnlyMessage)});m.insertAfter(g);d.evolutionComposer({plugins:b.plugins,focus:!1}).data("__EVOLUTIONTEXTEDITOR_CONTEXT",{editorWrapper:g,editor:d,readOnlyView:m,isReadOnly:!1});setTimeout(function(){d.evolutionComposer("resize",a,c)},50);0<f.trim(e).length&&n(f(d).data("__EVOLUTIONTEXTEDITOR_CONTEXT"),e)}})},val:function(b){if("undefined"!==typeof b){var d=f(this).data("__EVOLUTIONTEXTEDITOR_CONTEXT");if(d)return n(d,b)}else return(d=f(this).data("__EVOLUTIONTEXTEDITOR_CONTEXT"))?
l(d):"";return this},focus:function(b){(b=f(this).data("__EVOLUTIONTEXTEDITOR_CONTEXT"))&&(b.isReadOnly||b.editor.focus());return this},resize:function(b,d){var a=f(this).data("__EVOLUTIONTEXTEDITOR_CONTEXT");a&&(a.evolutionComposer("resize",b,d),isNaN(parseInt(b,10))||a.readOnlyView.css("width",b+"px"),isNaN(parseInt(d,10))||a.readOnlyView.css("height",d+"px"));return this}};f.fn.evolutionTextEditor=function(b){if(h[b])return h[b].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==
typeof b&&b)f.error("Method "+b+" does not exist on jQuery.evolutionTextEditor");else return h.init.apply(this,arguments)};return{}},jQuery,window);s("plugin.evolutionTheater",function(f,e,p){var l={show:function(e){var h=f.extend({},l.defaults,e||{}),b=f('<div class="theater-mask"></div>').hide().appendTo("body"),d=f('<div class="theater-container"></div>').hide().appendTo("body");e=f('<div class="theater-content-container"></div>').appendTo(d);var a=f('<div class="theater-content"></div>').appendTo(e),
c=f('<a href="#" class="theater-next">&rarr;</a>').appendTo(d),k=f('<a href="#" class="theater-back">&larr;</a>').appendTo(d),g=f('<a href="#" class="theater-close">X</a>').appendTo(e),m=null,q=null,r=null,v=function(g,e){f("body").css({overflow:"hidden"});m=g;g(function(g){c.hide();k.hide();e?e(a,g):a.hide().html(g);b.is(":visible")||(b.show(),d.show());h.loaded(a);q=h.nextContent(a);r=h.previousContent(a);a.show();q&&null!==q&&c.show();r&&null!==r&&k.show()})},u=function(){f("body").css({overflow:"auto"});
c.unbind("_evolution_theater");k.unbind("_evolution_theater");g.unbind("_evolution_theater");d.unbind("_evolution_theater");b.hide().remove();d.hide().remove();f(document).unbind("_evolution_theater")};l.refresh=function(a){v(m,a)};l.hide=function(){u()};c.bind("click._evolution_theater",function(a){a.preventDefault();q&&null!==q&&v(q)});k.bind("click._evolution_theater",function(a){a.preventDefault();r&&null!==r&&v(r)});g.bind("click._evolution_theater",function(a){a.preventDefault();u()});d.bind("click._evolution_theater",
function(a){a.target===d.get(0)&&u()});f(document).bind("keydown._evolution_theater",function(a){b.is(":visible")&&(39===a.which?f(a.target).is("input,textarea")||(q&&null!==q&&v(q),c.addClass("pressed")):37===a.which?f(a.target).is("input,textarea")||(r&&null!==r&&v(r),k.addClass("pressed")):27===a.which&&u())});f(document).bind("keyup._evolution_theater",function(a){b.is(":visible")&&(39===a.which?c.removeClass("pressed"):37===a.which&&k.removeClass("pressed"))});v(h.content)},hide:function(){},
refresh:function(){},defaults:{content:function(){return null},nextContent:function(){return null},previousContent:function(){return null},loaded:function(){}}};f.evolutionTheater=l;return{}},jQuery,window);s("plugin.evolutionTip",function(f,e,p){function l(){n&&(n.ui.remove(),"title"!=n.attribute&&"alt"!=n.attribute||n.element.attr(n.attribute,n.content))}var n;f.fn.evolutionTip=function(e){var b=f.extend({},f.fn.evolutionTip.defaults,e||{});b.template=f.telligent.evolution.template.compile(b.template);
return this.off("._evolutionTip").on("mouseenter._evolutionTip",function(d){l();d=f(this);for(var a=["data-"+b.attribute,"title","alt"],c,e,g=0;g<a.length;g++){c=a[g];var m=d.attr(c);if(m&&0<f.trim(m).length){e=m;break}}e&&0!=e.length&&(n={attribute:c,content:e,element:d,ui:f(b.template({content:e})).css({position:"absolute",top:-500,left:-500}).appendTo("body")},"title"!=n.attribute&&"alt"!=n.attribute||n.element.attr(n.attribute,""),a=f(window),e=f(document).scrollTop(),c=d.offset(),targetWidth=
d.outerWidth(),targetHeight=d.outerHeight(),windowWidth=a.outerWidth(),windowHeight=a.outerHeight(),tipWidth=n.ui.outerWidth(),tipHeight=n.ui.outerHeight(!0),d="center",a="above",30>=targetHeight+c.top-tipHeight-e&&(a="below"),30>=c.left-tipWidth/2?d="left":30>=windowWidth-(c.left+targetWidth+tipWidth/2)&&(d="right"),e="right"==d?c.left+targetWidth-tipWidth:"left"==d?c.left:c.left+targetWidth/2-tipWidth/2,c="above"==a?c.top-tipHeight:c.top+targetHeight,n.ui.addClass(a).addClass(d).css({left:e,top:c}))}).on("mouseleave._evolutionTip",
function(){l()})};f.fn.evolutionTip.hide=function(){l()};f.fn.evolutionTip.defaults={template:'<div class="tip"><%= content %></div>',attribute:"tip"};return{}},jQuery,window);s("plugin.evolutionToggleLink",function(f,e,p){var l={val:function(b){if(void 0===b){var d=this.data("evolutionToggleLink");return d?d.settings.val:!1}return this.each(function(){var a=f(this).data("evolutionToggleLink");a&&(a.settings.val=b,a.internal.processing=!1,h(a))})}},n=function(b){return this.each(function(){var d=
{settings:f.extend({},f.fn.evolutionToggleLink.defaults,b||{}),internal:{state:f(this),processing:!1}};d.internal.state.data("evolutionToggleLink",d).click(function(a){!d.internal.processing&&d.settings.changeState&&(d.internal.processing=!0,h(d),d.settings.changeState(!d.settings.val));return!1});h(d)})},h=function(b){b.internal.processing?b.internal.state.attr("class",b.settings.processingCssClass).attr("title",b.settings.processingTitle).html(b.settings.processingHtml):b.settings.val?b.internal.state.attr("class",
b.settings.onCssClass).attr("title",b.settings.onTitle).html(b.settings.onHtml):b.internal.state.attr("class",b.settings.offCssClass).attr("title",b.settings.offTitle).html(b.settings.offHtml)};f.fn.evolutionToggleLink=function(b){if(b in l)return l[b].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof b&&b)f.error("Method "+b+" does not exist on jQuery.fn.evolutionToggleLink");else return n.apply(this,arguments)};f.extend(f.fn.evolutionToggleLink,{defaults:{onHtml:"",offHtml:"",
processingHtml:"",changeState:null,onCssClass:"",offCssClass:"",processingCssClass:"",onTitle:"",offTitle:"",processingTitle:"",val:!1}});return{}},jQuery,window);s("plugin.evolutionTransform",function(f,e,p){function l(){var a=(document.body||document.documentElement).style,b="Moz webkit Webkit Khtml O ms".split(" ");if("string"==typeof a.transition)return!0;for(var c=0;c<b.length;c++)if("string"==typeof a[b[c]+"Transition"])return!0;return!1}function n(e,t){if(!this||0==this.length)return this;
var y=e||{};t=t||{};var z=[],B,x,A=null,D=null,s=null,C=null;e=[];null===v&&(v=l());this.each(function(){if(3!==this.nodeType){var l=f(this);if(!v)return y.x&&(y.left=y.x),y.y&&(y.y=y.y),l.css(y);for(var J in n.defaults)t[J]||(t[J]=n.defaults[J]);for(var E in y)l=y[E],E===h||E===d?(B=l,delete y[E]):E===b||E===a?(x=l,delete y[E]):E===c?(A=l,delete y[E]):E===k?(D=l,delete y[E]):E===g?(s=l,delete y[E]):E===m?(C=l,delete y[E]):(E==q?0===l?y[E]=1E-5:1===l&&(y[E]=0.99999):"number"===typeof l&&0==l%1&&(y[E]=
l+"px"),z[z.length]=E);if(B!=p||x!=p)e[e.length]="translate3d("+(B||0)+"px, "+(x||0)+"px, 0px)";A!=p&&(e[e.length]="rotateZ("+A+"deg)");D!=p&&(e[e.length]="rotateX("+D+"deg)");s!=p&&(e[e.length]="rotateY("+s+"deg)");C!=p&&(e[e.length]="scale("+C+")");0<e.length&&(l=u+"transform",mergedTransforms=e.join(" "),z[z.length]=l,y[l]=mergedTransforms,y.transform=mergedTransforms);l=f.fn.evolutionTransform.animationEnabled?t.duration/1E3+"s "+t.easing:"";transition=z.join(" "+l+", ")+" "+l;f.noop(this.offsetHeight);
if(s||D)r=r||f("body").get(0),r.style[u+"perspective"]=t.perspective,r.style.perspective=t.perspective;this.style[u+"transition"]=transition;this.style.transition=transition;for(E in y)this.style[E]=y[E]}});return this}var h="x",b="y",d="left",a="top",c="rotate",k="rotateX",g="rotateY",m="scale",q="opacity",r,v=null,u=function(){if(!("getComputedStyle"in window))return"";var a=window.getComputedStyle(document.documentElement,"");return"-"+(Array.prototype.slice.call(a).join("").match(/-(moz|webkit|ms)-/)||
""===a.OLink&&["","o"])[1]+"-"}();n.defaults={duration:0,easing:"linear",perspective:250};f.fn.evolutionTransform=n;f.fn.evolutionTransform.animationEnabled=!0;return{}},jQuery,window);s("plugin.evolutionUserFileTextBox",function(f,e,p){var l={},n=1,h=function(b){return this.each(function(){var d={settings:f.extend({},f.fn.evolutionUserFileTextBox.defaults,b||{}),internal:{state:this,preview:null,select:null,remove:null}};f.telligent.evolution.post({url:d.settings.endpoint,data:{m:"c"},success:function(a){d.internal.contextid=
a.uploadContextId;d.internal.uploadurl=a.uploadUrl;a=f("<div></div>").attr("class",d.settings.cssClass);d.internal.preview=f("<div></div>").attr("class",d.settings.previewCssClass);a.append(d.internal.preview);d.internal.select=f('<a href="#" class="upload"></a>').attr("id","userfiletextbox_"+(new Date).getTime()+"_"+n++).html(d.settings.selectText).glowUpload({fileFilter:null,uploadUrl:d.internal.uploadurl,renderMode:"link"}).bind("glowUploadBegun",function(a){d.uploading=!0;d.internal.select.html("0%")}).bind("glowUploadComplete",
function(a,b){d.internal.select.html(d.settings.selectText);b&&0<b.name.length&&f.telligent.evolution.post({url:d.settings.endpoint,data:{m:"f",ContextId:d.internal.contextid,FileName:b.name},success:function(a){d.internal.state.value=a.url;d.uploading=!1;d.internal.preview.html(a.previewHtml).slideDown(100);d.internal.remove.show()}})}).bind("glowUploadFileProgress",function(a,b){d.internal.select.html(b.percent+"%")});a.append(d.internal.select);d.internal.remove=f('<a href="#" class="remove" style="margin-left: 1em;"></a>').html(d.settings.removeText).click(function(){d.internal.preview.html("").slideUp(100);
d.internal.state.value="";d.internal.remove.hide();return!1}).hide();a.append(d.internal.remove);var b=f(d.internal.state).val();b?(d.internal.remove.show(),f.telligent.evolution.post({url:d.settings.endpoint,data:{m:"p",Url:b},success:function(a){d.internal.preview.html(a.previewHtml).slideDown(100)}})):d.internal.preview.html("").hide();f(d.internal.state).data("evolutionUserFileTextBox",d).before(a).hide()}})})};f.fn.evolutionUserFileTextBox=function(b){if(b in l)return l[b].apply(this,Array.prototype.slice.call(arguments,
1));if("object"!==typeof b&&b)f.error("Method "+b+" does not exist on jQuery.fn.evolutionUserFileTextBox");else return h.apply(this,arguments)};f.extend(f.fn.evolutionUserFileTextBox,{defaults:{removeText:"",selectText:"",noFileText:"",initialPreviewHtml:"",cssClass:"user-file-url",previewCssClass:"user-file-url-preview",endpoint:""}});return{}},jQuery,window);s("plugin.validation",function(f,e,p){f.telligent||(f.telligent={});f.telligent.evolution||(f.telligent.evolution={});f.telligent.evolution.validation=
{registerExtensions:function(a){f.validator&&(f.validator.addMethod("passwordvalid",function(b,c){return this.optional(c)||b.match(a.passwordRegex)},a.passwordInvalidMessage),f.validator.addMethod("email",function(b,c){return this.optional(c)||b.match(RegExp(a.emailRegex))},a.emailInvalidMessage),f.validator.addMethod("url",function(b,c){return this.optional(c)||b.match(a.urlRegex)?!0:("http://"+b).match(a.urlRegex)?(f(c).val("http://"+b),!0):!1},a.urlInvalidMessage),f.validator.addMethod("emails",
function(b,c){for(var d=b.split(/[;,]/),g=!0,e=RegExp(a.emailRegex),k=0;k<d.length;k++)jQuery.trim(d[k]).match(e)||(g=!1);return this.optional(c)||g},a.emailsInvalidMessage),f.validator.addMethod("username",function(b,c){return this.optional(c)||b.match(a.usernameRegex)},a.usernameInvalidMessage),f.validator.addMethod("usernameexists",function(a,b,c){if(this.optional(b))return"dependency-mismatch";var d=this.previousValue(b);this.settings.messages[b.name]||(this.settings.messages[b.name]={});d.originalMessage=
this.settings.messages[b.name].remote;this.settings.messages[b.name].remote=d.message;c="string"==typeof c&&{url:c}||c;var g=f.telligent.evolution.site.getBaseUrl()+"Utility/Validation/Core_Validator.asmx/IsUsernameAvailable";c.url&&(g=c.url);if(d.old!==a){d.old=a;var e=this;this.startRequest(b);var m='{"username":"'+a+'","elementName":"'+b.name+'"}';f.telligent.evolution.post({url:g,dataType:"json",contentType:"application/json; charset=utf-8",data:m,success:function(c){b=e.findByName(c.d.ElementName)[0];
e.settings.messages[b.name].remote=d.originalMessage;var g=!0===c.d.IsValid;if(g){var k=e.formSubmitted;e.prepareElement(b);e.formSubmitted=k;e.successList.push(b);e.showErrors()}else k={},c=d.message=c.d.ErrorMessage||e.defaultMessage(b,"usernameexists"),k[b.name]=f.isFunction(c)?m(a):c,e.showErrors(k);d.valid=g;e.stopRequest(b,g)}});return"pending"}return this.pending[b.name]?"pending":d.valid},void 0),f.validator.addMethod("emailexists",function(a,b,c){if(this.optional(b))return"dependency-mismatch";
var d=this.previousValue(b);this.settings.messages[b.name]||(this.settings.messages[b.name]={});d.originalMessage=this.settings.messages[b.name].remote;this.settings.messages[b.name].remote=d.message;c="string"==typeof c&&{url:c}||c;var g=f.telligent.evolution.site.getBaseUrl()+"Utility/Validation/Core_Validator.asmx/IsEmailAvailable";c.url&&(g=c.url);if(d.old!==a){d.old=a;var e=this;this.startRequest(b);var m='{"email":"'+a+'","elementName":"'+b.name+'"}';f.telligent.evolution.post({url:g,dataType:"json",
contentType:"application/json; charset=utf-8",data:m,success:function(c){b=e.findByName(c.d.ElementName)[0];e.settings.messages[b.name].remote=d.originalMessage;var g=!0===c.d.IsValid;if(g){var k=e.formSubmitted;e.prepareElement(b);e.formSubmitted=k;e.successList.push(b);e.showErrors()}else k={},c=d.message=e.customMessage(b.name,"emailexists")||c.d.ErrorMessage||e.defaultMessage(b,"emailexists"),k[b.name]=f.isFunction(c)?m(a):c,e.showErrors(k);d.valid=g;e.stopRequest(b,g)}});return"pending"}return this.pending[b.name]?
"pending":d.valid},void 0),f.validator.addMethod("groupnameexists",function(a,b,c){if(this.optional(b))return"dependency-mismatch";var d=encodeURIComponent(f.trim(a));if(0==d.length)return!0;var g=this.previousValue(b);this.settings.messages[b.name]||(this.settings.messages[b.name]={});g.originalMessage=this.settings.messages[b.name].remote;this.settings.messages[b.name].remote=g.message;c=c.getParentId();d='{"groupName":"'+d+'","parentGroupId":'+c+',"elementName":"'+b.name+'"}';if(g.old!==d){g.old=
d;var e=this;this.startRequest(b);c=f.telligent.evolution.site.getBaseUrl()+"Utility/Validation/Core_Validator.asmx/IsGroupNameAvailable";f.telligent.evolution.post({url:c,dataType:"json",contentType:"application/json; charset=utf-8",data:d,success:function(c){b=e.findByName(c.d.ElementName)[0];e.settings.messages[b.name].remote=g.originalMessage;var d=!0===c.d.IsValid;if(d){var m=e.formSubmitted;e.prepareElement(b);e.formSubmitted=m;e.successList.push(b);e.showErrors()}else m={},c=g.message=c.d.ErrorMessage||
e.defaultMessage(b,"groupnameexists"),m[b.name]=f.isFunction(c)?message(a):c,e.showErrors(m);g.valid=d;e.stopRequest(b,d)}});return"pending"}return this.pending[b.name]?"pending":g.valid},void 0),f.validator.addMethod("wikipageexists",function(a,b,c){if(this.optional(b))return"dependency-mismatch";var d=encodeURIComponent(f.trim(a));if(0==d.length)return!0;var g=this.previousValue(b);this.settings.messages[b.name]||(this.settings.messages[b.name]={});g.originalMessage=this.settings.messages[b.name].remote;
this.settings.messages[b.name].remote=g.message;c='{"pageName":"'+d+'","wikiId":'+c.wikiId+',"pageId":'+c.pageId+',"parentPageId":'+c.parentPageId()+',"elementName":"'+b.name+'"}';if(g.old!==c){g.old=c;var e=this;this.startRequest(b);d=f.telligent.evolution.site.getBaseUrl()+"Utility/Validation/Core_Validator.asmx/IsWikiPageNameAvailable";f.telligent.evolution.post({url:d,dataType:"json",contentType:"application/json; charset=utf-8",data:c,success:function(c){b=e.findByName(c.d.ElementName)[0];e.settings.messages[b.name].remote=
g.originalMessage;var d=!0===c.d.IsValid;if(d){var m=e.formSubmitted;e.prepareElement(b);e.formSubmitted=m;e.successList.push(b);e.showErrors()}else m={},c=g.message=c.d.ErrorMessage||e.defaultMessage(b,"wikipageexists"),m[b.name]=f.isFunction(c)?message(a):c,e.showErrors(m);g.valid=d;e.stopRequest(b,d)}});return"pending"}return this.pending[b.name]?"pending":g.valid},void 0),f.validator.addMethod("mailinglistnameexists",function(a,b,c){if(""==f.trim(a))return this.optional(b);var d=this.previousValue(b);
this.settings.messages[b.name]||(this.settings.messages[b.name]={});d.originalMessage=this.settings.messages[b.name].remote;this.settings.messages[b.name].remote=d.message;c="string"==typeof c&&{url:c}||c;var g=f.telligent.evolution.site.getBaseUrl()+"Utility/Validation/Core_Validator.asmx/IsMailingListNameAvailable";c.url&&(g=c.url);if(d.old!==a){d.old=a;var e=this;this.startRequest(b);var m='{"mailingListName":"'+a+'","elementName":"'+b.name+'"}';f.telligent.evolution.post({url:g,dataType:"json",
contentType:"application/json; charset=utf-8",data:m,success:function(c){b=e.findByName(c.d.ElementName)[0];e.settings.messages[b.name].remote=d.originalMessage;var g=!0===c.d.IsValid;if(g){var k=e.formSubmitted;e.prepareElement(b);e.formSubmitted=k;e.successList.push(b);e.showErrors()}else k={},c=d.message=c.d.ErrorMessage||e.defaultMessage(b,"mailinglistnameexists"),k[b.name]=f.isFunction(c)?m(a):c,e.showErrors(k);d.valid=g;e.stopRequest(b,g)}});return"pending"}return this.pending[b.name]?"pending":
d.valid},void 0))}};var l={addField:function(a,b,c,g){var e=this.data("evolutionValidation");if(e&&"undefined"!==typeof e){e.internal.fields[e.internal.fields.length]={selector:a,messageSelector:c,isValid:!0,context:g,initialized:!1};a=f(a);a.data("_evolutionValidation",e).data("_evolutionValidationFieldIndex",e.internal.fields.length-1).data("_evolutionValidationOldValue","$$$$$NULL$$$$$").rules("add",b);try{a.keydown(function(){if(e.internal.hasAttemptedSubmit){window.clearTimeout(e.internal.keyPressValidationHandle);
var a=this;e.internal.keyPressValidationHandle=window.setTimeout(function(){d(e,f(a))},499)}})}catch(k){}a.blur(function(){d(e,f(this))})}return this},addCustomValidation:function(a,b,d,g,e){var k=this.data("evolutionValidation");if(k&&"undefined"!==typeof k){var h=k.internal.customValidations.length;k.internal.customValidations[h]={id:a,validationFunction:b,message:d,messageSelector:g,isValid:!0,context:e,initialized:!1};return function(){return c(k,h)}}},isValid:function(){var a=this.data("evolutionValidation");
if(!a)return this;for(var g=0;g<a.internal.fields.length;g++)a.internal.fields[g].initialized||d(a,f(a.internal.fields[g].selector));for(g=0;g<a.internal.customValidations.length;g++)a.internal.customValidations[g].initialized||c(a,g);return b(a)},validate:function(){var a=this.data("evolutionValidation");if(!a)return this;for(var b=0;b<a.internal.fields.length;b++)d(a,f(a.internal.fields[b].selector));for(b=0;b<a.internal.customValidations.length;b++)c(a,b);return l.isValid.apply(f(a.internal.state),
[])},validateField:function(a){try{var b=this.data("evolutionValidation");f(a).data("_evolutionValidationOldValue","$$$$$NULL$$$$$");return d(b,f(a))}catch(c){}},validateCustom:function(a){var b=this.data("evolutionValidation");if(!b)return this;for(var d=0;d<b.internal.customValidations.length;d++)if(b.internal.customValidations[d].id==a)return c(b,d);return!0},reset:function(){var a=this.data("evolutionValidation");if(!a)return this;for(var b=0;b<a.internal.customValidations.length;b++)f(a.internal.customValidations[b].messageSelector).hide(),
a.internal.customValidations[b].isValid=!0,a.internal.customValidations[b].initialized=!1;for(b=0;b<a.internal.fields.length;b++)f(a.internal.fields[b].messageSelector).hide(),a.internal.fields[b].errorMessage=null,a.internal.fields[b].isValid=!0,a.internal.fields[b].initialized=!1,f(a.internal.fields[b].selector).data("_evolutionValidationOldValue","$$$$$NULL$$$$$");a.internal.submitButtonClicked=!1;a.internal.hasAttemptedSubmit=!1;window.clearTimeout(a.internal.initialValidationHandle);a.internal.initialValidationHandle=
window.setTimeout(function(){h(a)},249)}},n=function(a){return this.each(function(){var b={settings:f.extend({},f.fn.evolutionValidation.defaults,a||{}),internal:{state:this,submitButtonClicked:!1,hasAttemptedSubmit:!1,fields:[],customValidations:[],initialValidationHandle:null}};f(this).data("evolutionValidation",b);f(this).click(function(a){return k(b,a)});this._isValid=function(){return k(b,{})};window.clearTimeout(b.internal.initialValidationHandle);b.internal.initialValidationHandle=window.setTimeout(function(){h(b)},
499)})},h=function(b){window.clearTimeout(b.internal.initialValidationHandle);try{var c=!1;if(!0===b.settings.validateOnLoad)c=!0;else if(!1!==b.settings.validateOnLoad)for(var d=0;d<b.internal.fields.length;d++){var e=f(b.internal.fields[d].selector),k=e.attr("type");if("checkbox"!=k&&"radio"!=k&&"select"!=k&&"submit"!=k&&"button"!=k&&"reset"!=k&&""!=a(b,e)){c=!0;break}}if(c){b.internal.hasAttemptedSubmit=!0;var w=l.validate.apply(f(b.internal.state));g(b);if(b.settings.onValidated)b.settings.onValidated(w,
!1,null)}else if(!b.internal.hasAttemptedSubmit&&b.settings.onValidated)b.settings.onValidated(!0,!1,null)}catch(n){b.internal.initialValidationHandle=window.setTimeout(function(){h(b)},499)}},b=function(a){for(var b=0;b<a.internal.fields.length;b++)if(!a.internal.fields[b].isValid)return!1;for(b=0;b<a.internal.customValidations.length;b++)if(!a.internal.customValidations[b].isValid)return!1;return!0},d=function(b,c){var d=a(b,c);if(d!=c.data("_evolutionValidationOldValue"))return c.data("_evolutionValidationOldValue",
d),c.valid();d=c.data("_evolutionValidationFieldIndex");return 0>d||d>=b.internal.fields.length?!1:b.internal.fields[d].isValid},a=function(a,b){return"checkbox"==b.attr("type")||"radio"==b.attr("type")?b.get(0).checked?b.val():"":b.val()},c=function(a,c){if(0>c||c>=a.internal.customValidations.length)return!0;var d=a.internal.customValidations[c].validationFunction();a.internal.customValidations[c].initialized=!0;if(!0===d){a.internal.customValidations[c].isValid=!0;f(a.internal.customValidations[c].messageSelector).hide();
if(b(a)&&a.internal.hasAttemptedSubmit&&a.settings.onValidated)a.settings.onValidated(!0,a.internal.submitButtonClicked,a.internal.customValidations[c].context);return!0}d=b(a);a.internal.customValidations[c].isValid=!1;a.internal.hasAttemptedSubmit&&f(a.internal.customValidations[c].messageSelector).html(a.internal.customValidations[c].message).show();if((a.internal.submitButtonClicked||d)&&a.internal.hasAttemptedSubmit&&a.settings.onValidated)a.settings.onValidated(!1,a.internal.submitButtonClicked,
a.internal.customValidations[c].context);return!1},k=function(a,b){var c=!a.internal.hasAttemptedSubmit;a.internal.hasAttemptedSubmit=!0;a.internal.submitButtonClicked=!0;l.validate.apply(f(a.internal.state),[]);var d=l.isValid.apply(f(a.internal.state),[]);c&&!d&&g(a);c=!0;d&&a.settings.onSuccessfulClick&&(c=a.settings.onSuccessfulClick(b));a.internal.submitButtonClicked=!1;!d&&b&&(b.cancelBubble=!0,b.returnValue=!1);return d&&!1!==c},g=function(a){for(var b=0;b<a.internal.fields.length;b++)a.internal.fields[b].isValid||
null==a.internal.fields[b].errorMessage||(f(a.internal.fields[b].messageSelector).html(a.internal.fields[b].errorMessage).show(),a.internal.fields[b].errorMessage=null);for(b=0;b<a.internal.customValidations.length;b++)a.internal.customValidations[b].isValid||f(a.internal.customValidations[b].messageSelector).html(a.internal.customValidations[b].message).show()};f.fn.evolutionValidation=function(a){if(a in l)return l[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)f.error("Method "+
a+" does not exist on jQuery.fn.evolutionValidation");else return n.apply(this,arguments)};f.extend(f.fn.evolutionValidation,{defaults:{validateOnLoad:null,onValidated:null,onSuccessfulClick:null},init:function(){f.fn.validate&&f("form").validate({errorPlacement:function(a,b){var c=f(b).data("_evolutionValidation");if(c){var d=parseInt(f(b).data("_evolutionValidationFieldIndex"),10);0>d||d>=c.internal.fields.length||(c.internal.hasAttemptedSubmit?f(c.internal.fields[d].messageSelector).html(a).show():
c.internal.fields[d].errorMessage=a)}},highlight:function(a,c,d){if(c=f(a).data("_evolutionValidation"))if(d=b(c),a=f(a).data("_evolutionValidationFieldIndex"),!(0>a||a>=c.internal.fields.length)&&(c.internal.fields[a].isValid=!1,c.internal.fields[a].initialized=!0,(c.internal.submitButtonClicked||d)&&c.internal.hasAttemptedSubmit&&c.settings.onValidated))c.settings.onValidated(!1,c.internal.submitButtonClicked,c.internal.fields[a].context)},unhighlight:function(a,c,d){if(c=f(a).data("_evolutionValidation"))if(a=
f(a).data("_evolutionValidationFieldIndex"),!(0>a||a>=c.internal.fields.length)&&(c.internal.fields[a].isValid=!0,c.internal.fields[a].initialized=!0,b(c)&&c.internal.hasAttemptedSubmit&&c.settings.onValidated))c.settings.onValidated(!0,c.internal.submitButtonClicked,c.internal.fields[a].context)},onsubmit:!1,onkeyup:!1,onfocusout:!1})}});e.Telligent_Validation=function(a,b){this._jq=f(a);b.onValidatedFunction&&(b.onValidated=b.onValidatedFunction);b.onSuccessfulClickFunction&&(b.onSuccessfulClick=
b.onSuccessfulClickFunction);this._jq.evolutionValidation(b)};Telligent_Validation.prototype.AddField=function(a,b,c,d){this._jq.evolutionValidation("addField",a,b,c,d)};Telligent_Validation.prototype.AddCustomValidation=function(a,b,c,d,g){return this._jq.evolutionValidation("addCustomValidation",a,b,c,d,g)};Telligent_Validation.prototype.IsValid=function(){return this._jq.evolutionValidation("isValid")};Telligent_Validation.prototype.Validate=function(){return this._jq.evolutionValidation("validate")};
Telligent_Validation.prototype.ValidateField=function(a){return this._jq.evolutionValidation("validateField",a)};Telligent_Validation.prototype.ValidateCustom=function(a){return this._jq.evolutionValidation("validateCustom",a)};return{}},jQuery,window);"object"!==typeof JSON&&(JSON={});(function(){function f(a){return 10>a?"0"+a:a}function e(a){n.lastIndex=0;return n.test(a)?'"'+a.replace(n,function(a){var b=d[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+
'"':'"'+a+'"'}function p(c,d){var g,f,q,r,v=h,u,l=d[c];l&&("object"===typeof l&&"function"===typeof l.toJSON)&&(l=l.toJSON(c));"function"===typeof a&&(l=a.call(d,c,l));switch(typeof l){case "string":return e(l);case "number":return isFinite(l)?String(l):"null";case "boolean":case "null":return String(l);case "object":if(!l)return"null";h+=b;u=[];if("[object Array]"===Object.prototype.toString.apply(l)){r=l.length;for(g=0;g<r;g+=1)u[g]=p(g,l)||"null";q=0===u.length?"[]":h?"[\n"+h+u.join(",\n"+h)+"\n"+
v+"]":"["+u.join(",")+"]";h=v;return q}if(a&&"object"===typeof a)for(r=a.length,g=0;g<r;g+=1)"string"===typeof a[g]&&(f=a[g],(q=p(f,l))&&u.push(e(f)+(h?": ":":")+q));else for(f in l)Object.prototype.hasOwnProperty.call(l,f)&&(q=p(f,l))&&u.push(e(f)+(h?": ":":")+q);q=0===u.length?"{}":h?"{\n"+h+u.join(",\n"+h)+"\n"+v+"}":"{"+u.join(",")+"}";h=v;return q}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+
1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var l=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,n=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,h,b,d={"\b":"\\b","\t":"\\t","\n":"\\n",
"\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},a;"function"!==typeof JSON.stringify&&(JSON.stringify=function(c,d,g){var e;b=h="";if("number"===typeof g)for(e=0;e<g;e+=1)b+=" ";else"string"===typeof g&&(b=g);if((a=d)&&"function"!==typeof d&&("object"!==typeof d||"number"!==typeof d.length))throw Error("JSON.stringify");return p("",{"":c})});"function"!==typeof JSON.parse&&(JSON.parse=function(a,b){function d(a,c){var e,h,f=a[c];if(f&&"object"===typeof f)for(e in f)Object.prototype.hasOwnProperty.call(f,
e)&&(h=d(f,e),void 0!==h?f[e]=h:delete f[e]);return b.call(a,c,f)}var e;a=String(a);l.lastIndex=0;l.test(a)&&(a=a.replace(l,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return e=eval("("+a+")"),"function"===typeof b?d({"":e},""):e;throw new SyntaxError("JSON.parse");})})();!function(f,
e){function p(e,b){for(var d,a=[],c=0;c<e.length;++c){var k;if(!(k=n[e[c]]))a:{k=f;for(var g=e[c].split(/[.\/]/),m=0;m<g.length;++m){if(!k[g[m]]){k=void 0;break a}k=k[g[m]]}}if(d=k,!d)throw"module definition dependecy not found: "+e[c];a.push(d)}b.apply(null,a)}function l(h,b,d){if("string"!=typeof h)throw"invalid module definition, module id must be defined and be a string";if(b===e)throw"invalid module definition, dependencies must be specified";if(d===e)throw"invalid module definition, definition function must be specified";
p(b,function(){n[h]=d.apply(null,arguments)})}var n={};l("moxie/core/utils/Basic",[],function(){var e=function(a){return void 0===a?"undefined":null===a?"null":a.nodeType?"node":{}.toString.call(a).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},b=function(c){return d(arguments,function(k,g){0<g&&d(k,function(d,g){void 0!==d&&(e(c[g])===e(d)&&~a(e(d),["array","object"])?b(c[g],d):c[g]=d)})}),c},d=function(a,b){var d,e;if(a){try{d=a.length}catch(h){d=void 0}if(void 0===d)for(e in a){if(a.hasOwnProperty(e)&&
!1===b(a[e],e))break}else for(e=0;d>e&&!1!==b(a[e],e);e++);}},a=function(a,b){if(b){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(b,a);for(var d=0,e=b.length;e>d;d++)if(b[d]===a)return d}return-1};return{guid:function(){var a=0;return function(b){var d=(new Date).getTime().toString(32),e;for(e=0;5>e;e++)d+=Math.floor(65535*Math.random()).toString(32);return(b||"o_")+d+(a++).toString(32)}}(),typeOf:e,extend:b,each:d,isEmptyObj:function(a){var b;if(!a||"object"!==e(a))return!0;for(b in a)return!1;
return!0},inSeries:function(a,b){function d(q){"function"===e(a[q])&&a[q](function(a){++q<f&&!a?d(q):b(a)})}var f=a.length;"function"!==e(b)&&(b=function(){});a&&a.length||b();d(0)},inParallel:function(a,b){var e=0,h=a.length,f=Array(h);d(a,function(a,c){a(function(a){if(a)return b(a);var d=[].slice.call(arguments);d.shift();f[c]=d;e++;e===h&&(f.unshift(null),b.apply(this,f))})})},inArray:a,arrayDiff:function(b,d){var g=[];"array"!==e(b)&&(b=[b]);"array"!==e(d)&&(d=[d]);for(var f in b)-1===a(b[f],
d)&&g.push(b[f]);return g.length?g:!1},arrayIntersect:function(b,e){var g=[];return d(b,function(b){-1!==a(b,e)&&g.push(b)}),g.length?g:null},toArray:function(a){var b,d=[];for(b=0;b<a.length;b++)d[b]=a[b];return d},trim:function(a){return a?String.prototype.trim?String.prototype.trim.call(a):a.toString().replace(/^\s*/,"").replace(/\s*$/,""):a},parseSizeStr:function(a){if("string"!=typeof a)return a;var b={t:1099511627776,g:1073741824,m:1048576,k:1024},d;return a=/^([0-9]+)([mgk]?)$/.exec(a.toLowerCase().replace(/[^0-9mkg]/g,
"")),d=a[2],a=+a[1],b.hasOwnProperty(d)&&(a*=b[d]),a}}});l("moxie/core/I18n",["moxie/core/utils/Basic"],function(e){var b={};return{addI18n:function(d){return e.extend(b,d)},translate:function(d){return b[d]||d},_:function(b){return this.translate(b)},sprintf:function(b){var a=[].slice.call(arguments,1);return b.replace(/%[a-z]/g,function(){var b=a.shift();return"undefined"!==e.typeOf(b)?b:""})}}});l("moxie/core/utils/Mime",["moxie/core/utils/Basic","moxie/core/I18n"],function(e,b){var d={mimes:{},
extensions:{},addMimeType:function(a){a=a.split(/,/);var b,d,e;for(b=0;b<a.length;b+=2){e=a[b+1].split(/ /);for(d=0;d<e.length;d++)this.mimes[e[d]]=a[b];this.extensions[a[b]]=e}},extList2mimes:function(a,b){var d,g,f,q,r=[];for(g=0;g<a.length;g++)for(d=a[g].extensions.split(/\s*,\s*/),f=0;f<d.length;f++){if("*"===d[f])return[];if(q=this.mimes[d[f]])-1===e.inArray(q,r)&&r.push(q);else{if(!b||!/^\w+$/.test(d[f]))return[];r.push("."+d[f])}}return r},mimes2exts:function(a){var b=this,d=[];return e.each(a,
function(a){if("*"===a)return d=[],!1;var f=a.match(/^(\w+)\/(\*|\w+)$/);f&&("*"===f[2]?e.each(b.extensions,function(a,e){RegExp("^"+f[1]+"/").test(e)&&[].push.apply(d,b.extensions[e])}):b.extensions[a]&&[].push.apply(d,b.extensions[a]))}),d},mimes2extList:function(a){var c=[],d=[];return"string"===e.typeOf(a)&&(a=e.trim(a).split(/\s*,\s*/)),d=this.mimes2exts(a),c.push({title:b.translate("Files"),extensions:d.length?d.join(","):"*"}),c.mimes=a,c},getFileExtension:function(a){return(a=a&&a.match(/\.([^.]+)$/))?
a[1].toLowerCase():""},getFileMime:function(a){return this.mimes[this.getFileExtension(a)]||""}};return d.addMimeType("application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe"),
d});l("moxie/core/utils/Env",["moxie/core/utils/Basic"],function(e){var b=function(a){var b={has:function(a,b){return-1!==b.toLowerCase().indexOf(a.toLowerCase())},lowerize:function(a){return a.toLowerCase()}},d=function(){for(var b,c=0,d,e,g,f,h,k=arguments;c<k.length;c+=2){h=k[c];var m=k[c+1];if("undefined"===typeof b)for(g in b={},m)d=m[g],"object"===typeof d?b[d[0]]=a:b[d]=a;for(d=e=0;d<h.length;d++)if(f=h[d].exec(this.getUA())){for(g=0;g<m.length;g++)h=f[++e],d=m[g],"object"===typeof d&&0<d.length?
2==d.length?b[d[0]]="function"==typeof d[1]?d[1].call(this,h):d[1]:3==d.length?b[d[0]]="function"!==typeof d[1]||d[1].exec&&d[1].test?h?h.replace(d[1],d[2]):a:h?d[1].call(this,h,d[2]):a:4==d.length&&(b[d[0]]=h?d[3].call(this,h.replace(d[1],d[2])):a):b[d]=h?h:a;break}if(f)break}return b},e=function(d,e){for(var g in e)if("object"===typeof e[g]&&0<e[g].length)for(var f=0;f<e[g].length;f++){if(b.has(e[g][f],d))return"?"===g?a:g}else if(b.has(e[g],d))return"?"===g?a:g;return d},f={ME:"4.90","NT 3.11":"NT3.51",
"NT 4.0":"NT4.0",2E3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",RT:"ARM"},h=[[/(opera\smini)\/((\d+)?[\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/((\d+)?[\w\.-]+)/i,/(opera).+version\/((\d+)?[\w\.]+)/i,/(opera)[\/\s]+((\d+)?[\w\.]+)/i],["name","version","major"],[/\s(opr)\/((\d+)?[\w\.]+)/i],[["name","Opera"],"version","major"],[/(kindle)\/((\d+)?[\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?((\d+)?[\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?((\d+)?[\w\.]*)/i,
/(?:ms|\()(ie)\s((\d+)?[\w\.]+)/i,/(rekonq)((?:\/)[\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron)\/((\d+)?[\w\.-]+)/i],["name","version","major"],[/(trident).+rv[:\s]((\d+)?[\w\.]+).+like\sgecko/i],[["name","IE"],"version","major"],[/(yabrowser)\/((\d+)?[\w\.]+)/i],[["name","Yandex"],"version","major"],[/(comodo_dragon)\/((\d+)?[\w\.]+)/i],[["name",/_/g," "],"version","major"],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?((\d+)?[\w\.]+)/i],["name","version",
"major"],[/(dolfin)\/((\d+)?[\w\.]+)/i],[["name","Dolphin"],"version","major"],[/((?:android.+)crmo|crios)\/((\d+)?[\w\.]+)/i],[["name","Chrome"],"version","major"],[/((?:android.+))version\/((\d+)?[\w\.]+)\smobile\ssafari/i],[["name","Android Browser"],"version","major"],[/version\/((\d+)?[\w\.]+).+?mobile\/\w+\s(safari)/i],["version","major",["name","Mobile Safari"]],[/version\/((\d+)?[\w\.]+).+?(mobile\s?safari|safari)/i],["version","major","name"],[/webkit.+?(mobile\s?safari|safari)((\/[\w\.]+))/i],
["name",["major",e,{1:["/8","/1","/3"],2:"/4","?":"/"}],["version",e,{"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(konqueror)\/((\d+)?[\w\.]+)/i,/(webkit|khtml)\/((\d+)?[\w\.]+)/i],["name","version","major"],[/(navigator|netscape)\/((\d+)?[\w\.-]+)/i],[["name","Netscape"],"version","major"],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?((\d+)?[\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/((\d+)?[\w\.-]+)/i,
/(mozilla)\/((\d+)?[\w\.]+).+rv\:.+gecko\/\d+/i,/(uc\s?browser|polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|qqbrowser)[\/\s]?((\d+)?[\w\.]+)/i,/(links)\s\(((\d+)?[\w\.]+)/i,/(gobrowser)\/?((\d+)?[\w\.]+)*/i,/(ice\s?browser)\/v?((\d+)?[\w\._]+)/i,/(mosaic)[\/\s]((\d+)?[\w\.]+)/i],["name","version","major"]],r=[[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],["name","version"],[/rv\:([\w\.]+).*(gecko)/i],
["version","name"]],v=[[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],["name",["version",e,f]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[["name","Windows"],["version",e,f]],[/\((bb)(10);/i],[["name","BlackBerry"],"version"],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)\/([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego)[\/\s-]?([\w\.]+)*/i],["name","version"],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[["name",
"Symbian"],"version"],[/mozilla.+\(mobile;.+gecko.+firefox/i],[["name","Firefox OS"],"version"],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],["name","version"],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[["name","Chromium OS"],"version"],[/(sunos)\s?([\w\.]+\d)*/i],[["name","Solaris"],"version"],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],
["name","version"],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[["name","iOS"],["version",/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i],["name",["version",/_/g,"."]],[/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(macintosh|mac(?=_powerpc)|plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos)/i,/(unix)\s?([\w\.]+)*/i],["name","version"]];return(new function(a){var b=a||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:"");this.getBrowser=function(){return d.apply(this,
h)};this.getEngine=function(){return d.apply(this,r)};this.getOS=function(){return d.apply(this,v)};this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}};this.getUA=function(){return b};this.setUA=function(a){return b=a,this};this.setUA(b)}).getResult()}(),d={can:function(){var a={define_property:!1,create_canvas:function(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))}(),return_response_type:function(a){try{if(-1!==
e.inArray(a,["","text","document"]))return!0;if(window.XMLHttpRequest){var b=new XMLHttpRequest;if(b.open("get","/"),"responseType"in b)return b.responseType=a,b.responseType!==a?!1:!0}}catch(d){}return!1},use_data_uri:function(){var b=new Image;return b.onload=function(){a.use_data_uri=1===b.width&&1===b.height},setTimeout(function(){b.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1),!1}(),use_data_uri_over32kb:function(){return a.use_data_uri&&("IE"!==
d.browser||9<=d.version)},use_data_uri_of:function(b){return a.use_data_uri&&33E3>b||a.use_data_uri_over32kb()},use_fileinput:function(){var a=document.createElement("input");return a.setAttribute("type","file"),!a.disabled}};return function(b){var d=[].slice.call(arguments);return d.shift(),"function"===e.typeOf(a[b])?a[b].apply(this,d):!!a[b]}}(),browser:b.browser.name,version:parseFloat(b.browser.major),os:b.os.name,osVersion:b.os.version,verComp:function(a,b,d){var e=0,f=0,h=0,r={dev:-6,alpha:-5,
a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},e=function(a){return a=(""+a).replace(/[_\-+]/g,"."),a=a.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,"."),a.length?a.split("."):[-8]};a=e(a);b=e(b);f=Math.max(a.length,b.length);for(e=0;f>e;e++)if(a[e]!=b[e]){if(a[e]=a[e]?isNaN(a[e])?r[a[e]]||-7:parseInt(a[e],10):0,b[e]=b[e]?isNaN(b[e])?r[b[e]]||-7:parseInt(b[e],10):0,a[e]<b[e]){h=-1;break}if(a[e]>b[e]){h=1;break}}if(!d)return h;switch(d){case ">":case "gt":return 0<h;case ">=":case "ge":return 0<=
h;case "<=":case "le":return 0>=h;case "==":case "=":case "eq":return 0===h;case "<>":case "!=":case "ne":return 0!==h;case "":case "<":case "lt":return 0>h;default:return null}},swf_url:"../flash/Moxie.swf",xap_url:"../silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};return d.OS=d.os,d});l("moxie/core/utils/Dom",["moxie/core/utils/Env"],function(e){var b=function(b,a){return b.className?RegExp("(^|\\s+)"+a+"(\\s+|$)").test(b.className):!1};return{get:function(b){return"string"!=
typeof b?b:document.getElementById(b)},hasClass:b,addClass:function(d,a){b(d,a)||(d.className=d.className?d.className.replace(/\s+$/,"")+" "+a:a)},removeClass:function(b,a){b.className&&(b.className=b.className.replace(RegExp("(^|\\s+)"+a+"(\\s+|$)"),function(a,b,d){return" "===b&&" "===d?" ":""}))},getStyle:function(b,a){return b.currentStyle?b.currentStyle[a]:window.getComputedStyle?window.getComputedStyle(b,null)[a]:void 0},getPos:function(b,a){function c(a){var b,c,d=0,e=0;return a&&(c=a.getBoundingClientRect(),
b="CSS1Compat"===q.compatMode?q.documentElement:q.body,d=c.left+b.scrollLeft,e=c.top+b.scrollTop),{x:d,y:e}}var f=0,g=0,m,q=document,r;if(a=a||q.body,b&&b.getBoundingClientRect&&"IE"===e.browser&&(!q.documentMode||8>q.documentMode))return m=c(b),r=c(a),{x:m.x-r.x,y:m.y-r.y};for(m=b;m&&m!=a&&m.nodeType;)f+=m.offsetLeft||0,g+=m.offsetTop||0,m=m.offsetParent;for(m=b.parentNode;m&&m!=a&&m.nodeType;)f-=m.scrollLeft||0,g-=m.scrollTop||0,m=m.parentNode;return{x:f,y:g}},getSize:function(b){return{w:b.offsetWidth||
b.clientWidth,h:b.offsetHeight||b.clientHeight}}}});l("moxie/core/Exceptions",["moxie/core/utils/Basic"],function(e){function b(b,a){for(var c in b)if(b[c]===a)return c;return null}return{RuntimeError:function(){function d(c){this.code=c;this.name=b(a,c);this.message=this.name+": RuntimeError "+this.code}var a={NOT_INIT_ERR:1,NOT_SUPPORTED_ERR:9,JS_ERR:4};return e.extend(d,a),d.prototype=Error.prototype,d}(),OperationNotAllowedException:function(){function b(a){this.code=a;this.name="OperationNotAllowedException"}
return e.extend(b,{NOT_ALLOWED_ERR:1}),b.prototype=Error.prototype,b}(),ImageError:function(){function d(c){this.code=c;this.name=b(a,c);this.message=this.name+": ImageError "+this.code}var a={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2};return e.extend(d,a),d.prototype=Error.prototype,d}(),FileException:function(){function d(c){this.code=c;this.name=b(a,c);this.message=this.name+": FileException "+this.code}var a={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,
INVALID_STATE_ERR:7,SYNTAX_ERR:8};return e.extend(d,a),d.prototype=Error.prototype,d}(),DOMException:function(){function d(c){this.code=c;this.name=b(a,c);this.message=this.name+": DOMException "+this.code}var a={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,
INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};return e.extend(d,a),d.prototype=Error.prototype,d}(),EventException:function(){function b(a){this.code=a;this.name="EventException"}return e.extend(b,{UNSPECIFIED_EVENT_TYPE_ERR:0}),b.prototype=Error.prototype,b}()}});l("moxie/core/EventTarget",["moxie/core/Exceptions","moxie/core/utils/Basic"],
function(e,b){function d(){var a={};b.extend(this,{uid:null,init:function(){this.uid||(this.uid=b.guid("uid_"))},addEventListener:function(c,d,e,f){var h=this,r;return c=b.trim(c),/\s/.test(c)?void b.each(c.split(/\s+/),function(a){h.addEventListener(a,d,e,f)}):(c=c.toLowerCase(),e=parseInt(e,10)||0,r=a[this.uid]&&a[this.uid][c]||[],r.push({fn:d,priority:e,scope:f||this}),a[this.uid]||(a[this.uid]={}),void(a[this.uid][c]=r))},hasEventListener:function(b){return b?!(!a[this.uid]||!a[this.uid][b]):
!!a[this.uid]},removeEventListener:function(c,d){c=c.toLowerCase();var e=a[this.uid]&&a[this.uid][c],f;if(e){if(d)for(f=e.length-1;0<=f;f--){if(e[f].fn===d){e.splice(f,1);break}}else e=[];e.length||(delete a[this.uid][c],b.isEmptyObj(a[this.uid])&&delete a[this.uid])}},removeAllEventListeners:function(){a[this.uid]&&delete a[this.uid]},dispatchEvent:function(c){var d,g,f,q={},r=!0;if("string"!==b.typeOf(c)){if(g=c,"string"!==b.typeOf(g.type))throw new e.EventException(e.EventException.UNSPECIFIED_EVENT_TYPE_ERR);
c=g.type;void 0!==g.total&&void 0!==g.loaded&&(q.total=g.total,q.loaded=g.loaded);q.async=g.async||!1}if(-1!==c.indexOf("::")?!function(a){d=a[0];c=a[1]}(c.split("::")):d=this.uid,c=c.toLowerCase(),g=a[d]&&a[d][c]){g.sort(function(a,b){return b.priority-a.priority});f=[].slice.call(arguments);f.shift();q.type=c;f.unshift(q);var v=[];b.each(g,function(a){f[0].target=a.scope;v.push(q.async?function(b){setTimeout(function(){b(!1===a.fn.apply(a.scope,f))},1)}:function(b){b(!1===a.fn.apply(a.scope,f))})});
v.length&&b.inSeries(v,function(a){r=!a})}return r},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},trigger:function(){return this.dispatchEvent.apply(this,arguments)},convertEventPropsToHandlers:function(a){var d;"array"!==b.typeOf(a)&&(a=[a]);for(var e=0;e<a.length;e++)d="on"+a[e],"function"===b.typeOf(this[d])?this.addEventListener(a[e],this[d]):
"undefined"===b.typeOf(this[d])&&(this[d]=null)}})}return d.instance=new d,d});l("moxie/core/utils/Encode",[],function(){var e=function(b){return unescape(encodeURIComponent(b))},b=function(b){return decodeURIComponent(escape(b))};return{utf8_encode:e,utf8_decode:b,atob:function(d,a){if("function"==typeof window.atob)return a?b(window.atob(d)):window.atob(d);var c,e,g,f,h,r=0,v=0,l="",n=[];if(!d)return d;d+="";do c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(d.charAt(r++)),
e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(d.charAt(r++)),f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(d.charAt(r++)),h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(d.charAt(r++)),g=c<<18|e<<12|f<<6|h,c=g>>16&255,e=g>>8&255,g&=255,n[v++]=64==f?String.fromCharCode(c):64==h?String.fromCharCode(c,e):String.fromCharCode(c,e,g);while(r<d.length);return l=n.join(""),a?b(l):l},btoa:function(b,a){if(a&&e(b),
"function"==typeof window.btoa)return window.btoa(b);var c,f,g,m,q=0,r=0,l="",l=[];if(!b)return b;do c=b.charCodeAt(q++),f=b.charCodeAt(q++),g=b.charCodeAt(q++),m=c<<16|f<<8|g,c=m>>18&63,f=m>>12&63,g=m>>6&63,m&=63,l[r++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(f)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(g)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(m);
while(q<b.length);l=l.join("");q=b.length%3;return(q?l.slice(0,q-3):l)+"===".slice(q||3)}}});l("moxie/runtime/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/EventTarget"],function(e,b,d){function a(c,d,q,r,l){var u=this,n,t=e.guid(d+"_");l=l||"browser";c=c||{};f[t]=this;q=e.extend({access_binary:!1,access_image_binary:!1,display_media:!1,do_cors:!1,drag_and_drop:!1,filter_by_extension:!0,resize_image:!1,report_upload_progress:!1,return_response_headers:!1,return_response_type:!1,
return_status_code:!0,send_custom_headers:!1,select_file:!1,select_folder:!1,select_multiple:!0,send_binary_string:!1,send_browser_cookies:!0,send_multipart:!0,slice_blob:!1,stream_upload:!1,summon_file_dialog:!1,upload_filesize:!0,use_http_method:!0},q);c.preferred_caps&&(l=a.getMode(r,c.preferred_caps,l));n=function(){var a={};return{exec:function(b,c,d,e){return n[c]&&(a[b]||(a[b]={context:this,instance:new n[c]}),a[b].instance[d])?a[b].instance[d].apply(this,e):void 0},removeInstance:function(b){delete a[b]},
removeAllInstances:function(){var b=this;e.each(a,function(a,c){"function"===e.typeOf(a.instance.destroy)&&a.instance.destroy.call(a.context);b.removeInstance(c)})}}}();e.extend(this,{initialized:!1,uid:t,type:d,mode:a.getMode(r,c.required_caps,l),shimid:t+"_container",clients:0,options:c,can:function(b,c,d){d=d||q;if("string"===e.typeOf(b)&&"undefined"===e.typeOf(c)&&(b=a.parseCaps(b)),"object"===e.typeOf(b)){for(var g in b)if(!this.can(g,b[g],d))return!1;return!0}return"function"===e.typeOf(d[b])?
d[b].call(this,c):c===d[b]},getShimContainer:function(){var a,c=b.get(this.shimid);return c||(a=this.options.container?b.get(this.options.container):document.body,c=document.createElement("div"),c.id=this.shimid,c.className="moxie-shim moxie-shim-"+this.type,e.extend(c.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),a.appendChild(c)),c},getShim:function(){return n},shimExec:function(a,b){var c=[].slice.call(arguments,2);return u.getShim().exec.call(this,
this.uid,a,b,c)},exec:function(a,b){var c=[].slice.call(arguments,2);return u[a]&&u[a][b]?u[a][b].apply(this,c):u.shimExec.apply(this,arguments)},destroy:function(){if(u){var a=b.get(this.shimid);a&&a.parentNode.removeChild(a);n&&n.removeAllInstances();this.unbindAll();delete f[this.uid];t=u=n=this.uid=null}}});this.mode&&c.required_caps&&!this.can(c.required_caps)&&(this.mode=!1)}var c={},f={};return a.order="html5,flash,silverlight,html4",a.getRuntime=function(a){return f[a]?f[a]:!1},a.addConstructor=
function(a,b){b.prototype=d.instance;c[a]=b},a.getConstructor=function(a){return c[a]||null},a.getInfo=function(b){var c=a.getRuntime(b);return c?{uid:c.uid,type:c.type,mode:c.mode,can:function(){return c.can.apply(c,arguments)}}:null},a.parseCaps=function(a){var b={};return"string"!==e.typeOf(a)?a||{}:(e.each(a.split(","),function(a){b[a]=!0}),b)},a.can=function(b,c){var d,e=a.getConstructor(b),f;return e?(d=new e({required_caps:c}),f=d.mode,d.destroy(),!!f):!1},a.thatCan=function(b,c){var d=(c||
a.order).split(/\s*,\s*/),e;for(e in d)if(a.can(d[e],b))return d[e];return null},a.getMode=function(a,b,c){var d=null;if("undefined"===e.typeOf(c)&&(c="browser"),b&&!e.isEmptyObj(a)){if(e.each(b,function(b,c){if(a.hasOwnProperty(c)){var f=a[c](b);if("string"==typeof f&&(f=[f]),d){if(!(d=e.arrayIntersect(d,f)))return d=!1}else d=f}}),d)return-1!==e.inArray(c,d)?c:d[0];if(!1===d)return!1}return c},a.capTrue=function(){return!0},a.capFalse=function(){return!1},a.capTest=function(a){return function(){return!!a}},
a});l("moxie/runtime/RuntimeClient",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/Runtime"],function(e,b,d){return function(){var a;b.extend(this,{connectRuntime:function(c){function f(b){var m,l;return b.length?(m=b.shift(),(l=d.getConstructor(m))?(a=new l(c),a.bind("Init",function(){a.initialized=!0;setTimeout(function(){a.clients++;g.trigger("RuntimeInit",a)},1)}),a.bind("Error",function(){a.destroy();f(b)}),a.mode?void a.init():void a.trigger("Error")):void f(b)):(g.trigger("RuntimeError",
new e.RuntimeError(e.RuntimeError.NOT_INIT_ERR)),void(a=null))}var g=this,m;if("string"===b.typeOf(c)?m=c:"string"===b.typeOf(c.ruid)&&(m=c.ruid),m){if(a=d.getRuntime(m))return a.clients++,a;throw new e.RuntimeError(e.RuntimeError.NOT_INIT_ERR);}f((c.runtime_order||d.order).split(/\s*,\s*/))},getRuntime:function(){return a&&a.uid?a:(a=null,null)},disconnectRuntime:function(){a&&0>=--a.clients&&(a.destroy(),a=null)}})}});l("moxie/file/Blob",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient"],
function(e,b,d){function a(f,g){function m(b,d,g){var f,k=c[this.uid];return"string"===e.typeOf(k)&&k.length?(f=new a(null,{type:g,size:d-b}),f.detach(k.substr(b,f.size)),f):null}d.call(this);f&&this.connectRuntime(f);g?"string"===e.typeOf(g)&&(g={data:g}):g={};e.extend(this,{uid:g.uid||e.guid("uid_"),ruid:f,size:g.size||0,type:g.type||"",slice:function(a,b,c){return this.isDetached()?m.apply(this,arguments):this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),a,b,c)},getSource:function(){return c[this.uid]?
c[this.uid]:null},detach:function(a){this.ruid&&(this.getRuntime().exec.call(this,"Blob","destroy"),this.disconnectRuntime(),this.ruid=null);a=a||"";var d=a.match(/^data:([^;]*);base64,/);d&&(this.type=d[1],a=b.atob(a.substring(a.indexOf("base64,")+7)));this.size=a.length;c[this.uid]=a},isDetached:function(){return!this.ruid&&"string"===e.typeOf(c[this.uid])},destroy:function(){this.detach();delete c[this.uid]}});g.data?this.detach(g.data):c[this.uid]=g}var c={};return a});l("moxie/file/File",["moxie/core/utils/Basic",
"moxie/core/utils/Mime","moxie/file/Blob"],function(e,b,d){function a(a,f){var g,m;(f||(f={}),m=f.type&&""!==f.type?f.type:b.getFileMime(f.name),f.name)?(g=f.name.replace(/\\/g,"/"),g=g.substr(g.lastIndexOf("/")+1)):(g=m.split("/")[0],g=e.guid((""!==g?g:"file")+"_"),b.extensions[m]&&(g+="."+b.extensions[m][0]));d.apply(this,arguments);e.extend(this,{type:m||"",name:g||e.guid("file_"),lastModifiedDate:f.lastModifiedDate||(new Date).toLocaleString()})}return a.prototype=d.prototype,a});l("moxie/file/FileInput",
"moxie/core/utils/Basic moxie/core/utils/Mime moxie/core/utils/Dom moxie/core/Exceptions moxie/core/EventTarget moxie/core/I18n moxie/file/File moxie/runtime/Runtime moxie/runtime/RuntimeClient".split(" "),function(e,b,d,a,c,f,g,m,q){function r(c){var r=this,n;if(-1!==e.inArray(e.typeOf(c),["string","node"])&&(c={browse_button:c}),n=d.get(c.browse_button),!n)throw new a.DOMException(a.DOMException.NOT_FOUND_ERR);n={accept:[{title:f.translate("All Files"),extensions:"*"}],name:"file",multiple:!1,required_caps:!1,
container:n.parentNode||document.body};c=e.extend({},n,c);"string"==typeof c.required_caps&&(c.required_caps=m.parseCaps(c.required_caps));"string"==typeof c.accept&&(c.accept=b.mimes2extList(c.accept));(n=d.get(c.container))||(n=document.body);"static"===d.getStyle(n,"position")&&(n.style.position="relative");n=n=null;q.call(r);e.extend(r,{uid:e.guid("uid_"),ruid:null,shimid:null,files:null,init:function(){r.convertEventPropsToHandlers(l);r.bind("RuntimeInit",function(a,b){r.ruid=b.uid;r.shimid=
b.shimid;r.bind("Ready",function(){r.trigger("Refresh")},999);r.bind("Change",function(){var a=b.exec.call(r,"FileInput","getFiles");r.files=[];e.each(a,function(a){return 0===a.size?!0:void r.files.push(new g(r.ruid,a))})},999);r.bind("Refresh",function(){var a,g,f,k;f=d.get(c.browse_button);k=d.get(b.shimid);f&&(a=d.getPos(f,d.get(c.container)),g=d.getSize(f),k&&e.extend(k.style,{top:a.y+"px",left:a.x+"px",width:g.w+"px",height:g.h+"px"}))});b.exec.call(r,"FileInput","init",c)});r.connectRuntime(e.extend({},
c,{required_caps:{select_file:!0}}))},disable:function(a){var b=this.getRuntime();b&&b.exec.call(this,"FileInput","disable","undefined"===e.typeOf(a)?!0:a)},refresh:function(){r.trigger("Refresh")},destroy:function(){var a=this.getRuntime();a&&(a.exec.call(this,"FileInput","destroy"),this.disconnectRuntime());"array"===e.typeOf(this.files)&&e.each(this.files,function(a){a.destroy()});this.files=null}})}var l="ready change cancel mouseenter mouseleave mousedown mouseup".split(" ");return r.prototype=
c.instance,r});l("moxie/file/FileDrop","moxie/core/I18n moxie/core/utils/Dom moxie/core/Exceptions moxie/core/utils/Basic moxie/file/File moxie/runtime/RuntimeClient moxie/core/EventTarget moxie/core/utils/Mime".split(" "),function(e,b,d,a,c,f,g,m){function q(d){var g=this,q;"string"==typeof d&&(d={drop_zone:d});q={accept:[{title:e.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:!0}};d="object"==typeof d?a.extend({},q,d):q;d.container=b.get(d.drop_zone)||document.body;"static"===
b.getStyle(d.container,"position")&&(d.container.style.position="relative");"string"==typeof d.accept&&(d.accept=m.mimes2extList(d.accept));f.call(g);a.extend(g,{uid:a.guid("uid_"),ruid:null,files:null,init:function(){g.convertEventPropsToHandlers(r);g.bind("RuntimeInit",function(b,e){g.ruid=e.uid;g.bind("Drop",function(){var b=e.exec.call(g,"FileDrop","getFiles");g.files=[];a.each(b,function(a){g.files.push(new c(g.ruid,a))})},999);e.exec.call(g,"FileDrop","init",d);g.dispatchEvent("ready")});g.connectRuntime(d)},
destroy:function(){var a=this.getRuntime();a&&(a.exec.call(this,"FileDrop","destroy"),this.disconnectRuntime());this.files=null}})}var r=["ready","dragenter","dragleave","drop","error"];return q.prototype=g.instance,q});l("moxie/runtime/RuntimeTarget",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(e,b,d){function a(){this.uid=e.guid("uid_");b.call(this);this.destroy=function(){this.disconnectRuntime();this.unbindAll()}}return a.prototype=d.instance,a});
l("moxie/file/FileReader","moxie/core/utils/Basic moxie/core/utils/Encode moxie/core/Exceptions moxie/core/EventTarget moxie/file/Blob moxie/file/File moxie/runtime/RuntimeTarget".split(" "),function(e,b,d,a,c,f,g){function m(){function a(e,h){function r(a){f.readyState=m.DONE;f.error=a;f.trigger("error");l()}function l(){k.destroy();k=null;f.trigger("loadend")}function n(a){k.bind("Error",function(a,b){r(b)});k.bind("Progress",function(b){f.result=a.exec.call(k,"FileReader","getResult");f.trigger(b)});
k.bind("Load",function(b){f.readyState=m.DONE;f.result=a.exec.call(k,"FileReader","getResult");f.trigger(b);l()});a.exec.call(k,"FileReader","read",e,h)}if(k=new g,this.convertEventPropsToHandlers(q),this.readyState===m.LOADING)return r(new d.DOMException(d.DOMException.INVALID_STATE_ERR));if(this.readyState=m.LOADING,this.trigger("loadstart"),h instanceof c)if(h.isDetached()){var p=h.getSource();switch(e){case "readAsText":case "readAsBinaryString":this.result=p;break;case "readAsDataURL":this.result=
"data:"+h.type+";base64,"+b.btoa(p)}this.readyState=m.DONE;this.trigger("load");l()}else n(k.connectRuntime(h.ruid));else r(new d.DOMException(d.DOMException.NOT_FOUND_ERR))}var f=this,k;e.extend(this,{uid:e.guid("uid_"),readyState:m.EMPTY,result:null,error:null,readAsBinaryString:function(b){a.call(this,"readAsBinaryString",b)},readAsDataURL:function(b){a.call(this,"readAsDataURL",b)},readAsText:function(b){a.call(this,"readAsText",b)},abort:function(){this.result=null;-1===e.inArray(this.readyState,
[m.EMPTY,m.DONE])&&(this.readyState===m.LOADING&&(this.readyState=m.DONE),k&&k.getRuntime().exec.call(this,"FileReader","abort"),this.trigger("abort"),this.trigger("loadend"))},destroy:function(){this.abort();k&&(k.getRuntime().exec.call(this,"FileReader","destroy"),k.disconnectRuntime());f=k=null}})}var q="loadstart progress load abort error loadend".split(" ");return m.EMPTY=0,m.LOADING=1,m.DONE=2,m.prototype=a.instance,m});l("moxie/core/utils/Url",[],function(){var e=function(b,d){for(var a="source scheme authority userInfo user pass host port relative path directory file query fragment".split(" "),
c=a.length,f={http:80,https:443},g={},m=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/.exec(b||"");c--;)m[c]&&(g[a[c]]=m[c]);g.scheme||(d&&"string"!=typeof d||(d=e(d||document.location.href)),g.scheme=d.scheme,g.host=d.host,g.port=d.port,a="",/^[^\/]/.test(g.path)&&(a=d.path,/(\/|\/[^\.]+)$/.test(a)?a+="/":a=a.replace(/\/[^\/]+$/,"/")),g.path=a+(g.path||""));return g.port||(g.port=f[g.scheme]||
80),g.port=parseInt(g.port,10),g.path||(g.path="/"),delete g.source,g};return{parseUrl:e,resolveUrl:function(b){b=e(b);return b.scheme+"://"+b.host+(b.port!=={http:80,https:443}[b.scheme]?":"+b.port:"")+b.path+(b.query?b.query:"")},hasSameOrigin:function(b){function d(a){return[a.scheme,a.host,a.port].join("/")}return"string"==typeof b&&(b=e(b)),d(e())===d(b)}}});l("moxie/file/FileReaderSync",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/utils/Encode"],function(e,b,d){return function(){function a(a,
b){if(!b.isDetached()){var e=this.connectRuntime(b.ruid).exec.call(this,"FileReaderSync","read",a,b);return this.disconnectRuntime(),e}e=b.getSource();switch(a){case "readAsBinaryString":return e;case "readAsDataURL":return"data:"+b.type+";base64,"+d.btoa(e);case "readAsText":for(var f="",h=0,r=e.length;r>h;h++)f+=String.fromCharCode(e[h]);return f}}b.call(this);e.extend(this,{uid:e.guid("uid_"),readAsBinaryString:function(b){return a.call(this,"readAsBinaryString",b)},readAsDataURL:function(b){return a.call(this,
"readAsDataURL",b)},readAsText:function(b){return a.call(this,"readAsText",b)}})}});l("moxie/xhr/FormData",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/file/Blob"],function(e,b,d){return function(){var a,c=[];b.extend(this,{append:function(e,g){var f=this,h=b.typeOf(g);g instanceof d?a={name:e,value:g}:"array"===h?(e+="[]",b.each(g,function(a){f.append(e,a)})):"object"===h?b.each(g,function(a,b){f.append(e+"["+b+"]",a)}):"null"===h||"undefined"===h||"number"===h&&isNaN(g)?f.append(e,"false"):
c.push({name:e,value:g.toString()})},hasBlob:function(){return!!this.getBlob()},getBlob:function(){return a&&a.value||null},getBlobName:function(){return a&&a.name||null},each:function(d){b.each(c,function(a){d(a.value,a.name)});a&&d(a.value,a.name)},destroy:function(){a=null;c=[]}})}});l("moxie/xhr/XMLHttpRequest","moxie/core/utils/Basic moxie/core/Exceptions moxie/core/EventTarget moxie/core/utils/Encode moxie/core/utils/Url moxie/runtime/Runtime moxie/runtime/RuntimeTarget moxie/file/Blob moxie/file/FileReaderSync moxie/xhr/FormData moxie/core/utils/Env moxie/core/utils/Mime".split(" "),
function(e,b,d,a,c,f,g,m,q,r,l,n){function p(){this.uid=e.guid("uid_")}function t(){function d(a,b){return D.hasOwnProperty(a)?1===arguments.length?l.can("define_property")?D[a]:A[a]:void(l.can("define_property")?D[a]=b:A[a]=b):void 0}function q(a){function b(){I&&(I.destroy(),I=null);m.dispatchEvent("loadend");m=null}function c(g){I.bind("LoadStart",function(a){d("readyState",t.LOADING);m.dispatchEvent("readystatechange");m.dispatchEvent(a);S&&m.upload.dispatchEvent(a)});I.bind("Progress",function(a){d("readyState")!==
t.LOADING&&(d("readyState",t.LOADING),m.dispatchEvent("readystatechange"));m.dispatchEvent(a)});I.bind("UploadProgress",function(a){S&&m.upload.dispatchEvent({type:"progress",lengthComputable:!1,total:a.total,loaded:a.loaded})});I.bind("Load",function(a){d("readyState",t.DONE);d("status",Number(g.exec.call(I,"XMLHttpRequest","getStatus")||0));d("statusText",y[d("status")]||"");d("response",g.exec.call(I,"XMLHttpRequest","getResponse",d("responseType")));~e.inArray(d("responseType"),["text",""])?d("responseText",
d("response")):"document"===d("responseType")&&d("responseXML",d("response"));Q=g.exec.call(I,"XMLHttpRequest","getAllResponseHeaders");m.dispatchEvent("readystatechange");0<d("status")?(S&&m.upload.dispatchEvent(a),m.dispatchEvent(a)):(R=!0,m.dispatchEvent("error"));b()});I.bind("Abort",function(a){m.dispatchEvent(a);b()});I.bind("Error",function(a){R=!0;d("readyState",t.DONE);m.dispatchEvent("readystatechange");T=!0;m.dispatchEvent(a);b()});g.exec.call(I,"XMLHttpRequest","send",{url:C,method:G,
async:s,user:E,password:N,headers:J,mimeType:H,encoding:O,responseType:m.responseType,withCredentials:m.withCredentials,options:K},a)}var m=this;(new Date).getTime();I=new g;"string"==typeof K.required_caps&&(K.required_caps=f.parseCaps(K.required_caps));K.required_caps=e.extend({},K.required_caps,{return_response_type:m.responseType});a instanceof r&&(K.required_caps.send_multipart=!0);U||(K.required_caps.do_cors=!0);K.ruid?c(I.connectRuntime(K)):(I.bind("RuntimeInit",function(a,b){c(b)}),I.bind("RuntimeError",
function(a,b){m.dispatchEvent("RuntimeError",b)}),I.connectRuntime(K))}var A=this,D={timeout:0,readyState:t.UNSENT,withCredentials:!1,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},s=!0,C,G,J={},E,N,O=null,H=null,M=!1,F=!1,S=!1,T=!1,R=!1,U=!1,K={},I,Q="",P;e.extend(this,D,{uid:e.guid("uid_"),upload:new p,open:function(g,f,k,m,q){var r;if(!g||!f)throw new b.DOMException(b.DOMException.SYNTAX_ERR);if(/[\u0100-\uffff]/.test(g)||a.utf8_encode(g)!==g)throw new b.DOMException(b.DOMException.SYNTAX_ERR);
if(~e.inArray(g.toUpperCase(),"CONNECT DELETE GET HEAD OPTIONS POST PUT TRACE TRACK".split(" "))&&(G=g.toUpperCase()),~e.inArray(G,["CONNECT","TRACE","TRACK"]))throw new b.DOMException(b.DOMException.SECURITY_ERR);if(f=a.utf8_encode(f),r=c.parseUrl(f),U=c.hasSameOrigin(r),C=c.resolveUrl(f),(m||q)&&!U)throw new b.DOMException(b.DOMException.INVALID_ACCESS_ERR);if(E=m||r.user,N=q||r.pass,s=k||!0,!1===s&&(d("timeout")||d("withCredentials")||""!==d("responseType")))throw new b.DOMException(b.DOMException.INVALID_ACCESS_ERR);
M=!s;F=!1;J={};d("responseText","");d("responseXML",null);d("response",null);d("status",0);d("statusText","");d("readyState",t.OPENED);this.convertEventPropsToHandlers(["readystatechange"]);this.dispatchEvent("readystatechange")},setRequestHeader:function(c,g){if(d("readyState")!==t.OPENED||F)throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);if(/[\u0100-\uffff]/.test(c)||a.utf8_encode(c)!==c)throw new b.DOMException(b.DOMException.SYNTAX_ERR);return c=e.trim(c).toLowerCase(),~e.inArray(c,
"accept-charset accept-encoding access-control-request-headers access-control-request-method connection content-length cookie cookie2 content-transfer-encoding date expect host keep-alive origin referer te trailer transfer-encoding upgrade user-agent via".split(" "))||/^(proxy\-|sec\-)/.test(c)?!1:(J[c]?J[c]+=", "+g:J[c]=g,!0)},getAllResponseHeaders:function(){return Q||""},getResponseHeader:function(a){return a=a.toLowerCase(),R||~e.inArray(a,["set-cookie","set-cookie2"])?null:Q&&""!==Q&&(P||(P=
{},e.each(Q.split(/\r\n/),function(a){a=a.split(/:\s+/);2===a.length&&(a[0]=e.trim(a[0]),P[a[0].toLowerCase()]={header:a[0],value:e.trim(a[1])})})),P.hasOwnProperty(a))?P[a].header+": "+P[a].value:null},overrideMimeType:function(a){var c;if(~e.inArray(d("readyState"),[t.LOADING,t.DONE]))throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);if(a=e.trim(a.toLowerCase()),/;/.test(a)&&(c=a.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))&&(a=c[1]),!n.mimes[a])throw new b.DOMException(b.DOMException.SYNTAX_ERR);
},send:function(c,d){if(K="string"===e.typeOf(d)?{ruid:d}:d?d:{},this.convertEventPropsToHandlers(z),this.upload.convertEventPropsToHandlers(z),this.readyState!==t.OPENED||F)throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);if(c instanceof m)K.ruid=c.ruid,H=c.type||"application/octet-stream";else if(c instanceof r){if(c.hasBlob()){var g=c.getBlob();K.ruid=g.ruid;H=g.type||"application/octet-stream"}}else"string"==typeof c&&(O="UTF-8",H="text/plain;charset=UTF-8",c=a.utf8_encode(c));this.withCredentials||
(this.withCredentials=K.required_caps&&K.required_caps.send_browser_cookies&&!U);S=!M&&this.upload.hasEventListener();R=!1;T=!c;M||(F=!0);q.call(this,c)},abort:function(){if(R=!0,M=!1,~e.inArray(d("readyState"),[t.UNSENT,t.OPENED,t.DONE]))d("readyState",t.UNSENT);else{if(d("readyState",t.DONE),F=!1,!I)throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);I.getRuntime().exec.call(I,"XMLHttpRequest","abort",T);T=!0}},destroy:function(){I&&("function"===e.typeOf(I.destroy)&&I.destroy(),I=null);
this.unbindAll();this.upload&&(this.upload.unbindAll(),this.upload=null)}})}var y={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",
403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",
503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};p.prototype=d.instance;var z="loadstart progress abort error load timeout loadend".split(" ");return t.UNSENT=0,t.OPENED=1,t.HEADERS_RECEIVED=2,t.LOADING=3,t.DONE=4,t.prototype=d.instance,t});l("moxie/runtime/Transporter",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(e,b,
d,a){function c(){function a(b,d){var f=this;q=d;f.bind("TransportingProgress",function(a){n=a.loaded;l>n&&-1===e.inArray(f.state,[c.IDLE,c.DONE])&&g.call(f)},999);f.bind("TransportingComplete",function(){n=l;f.state=c.DONE;r=null;f.result=q.exec.call(f,"Transporter","getAsBlob",b||"")},999);f.state=c.BUSY;f.trigger("TransportingStarted");g.call(f)}function g(){var a;a=l-n;p>a&&(p=a);a=b.btoa(r.substr(n,p));q.exec.call(this,"Transporter","receive",a,l)}var f,q,r,l,n,p;d.call(this);e.extend(this,{uid:e.guid("uid_"),
state:c.IDLE,result:null,transport:function(b,c,d){var g=this;d=e.extend({chunk_size:204798},d);(f=d.chunk_size%3)&&(d.chunk_size+=3-f);p=d.chunk_size;l=n=0;r=this.result=null;if(r=b,l=b.length,"string"===e.typeOf(d)||d.ruid)a.call(g,c,this.connectRuntime(d));else{var q=function(b,d){g.unbind("RuntimeInit",q);a.call(g,c,d)};this.bind("RuntimeInit",q);this.connectRuntime(d)}},abort:function(){this.state=c.IDLE;q&&(q.exec.call(this,"Transporter","clear"),this.trigger("TransportingAborted"));l=n=0;r=
this.result=null},destroy:function(){this.unbindAll();q=null;this.disconnectRuntime();l=n=0;r=this.result=null}})}return c.IDLE=0,c.BUSY=1,c.DONE=2,c.prototype=a.instance,c});l("moxie/image/Image","moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/Exceptions moxie/file/FileReaderSync moxie/xhr/XMLHttpRequest moxie/runtime/Runtime moxie/runtime/RuntimeClient moxie/runtime/Transporter moxie/core/utils/Env moxie/core/EventTarget moxie/file/Blob moxie/file/File moxie/core/utils/Encode".split(" "),
function(e,b,d,a,c,f,g,m,q,r,l,n,p){function t(){function a(b){var c=e.typeOf(b);try{if(b instanceof t){if(!b.size)throw new d.DOMException(d.DOMException.INVALID_STATE_ERR);r.apply(this,arguments)}else if(b instanceof l){if(!~e.inArray(b.type,["image/jpeg","image/png"]))throw new d.ImageError(d.ImageError.WRONG_FORMAT);x.apply(this,arguments)}else if(-1!==e.inArray(c,["blob","file"]))a.call(this,new n(null,b),arguments[1]);else if("string"===c)/^data:[^;]*;base64,/.test(b)?a.call(this,new l(null,
{data:b}),arguments[1]):A.apply(this,arguments);else{if("node"!==c||"img"!==b.nodeName.toLowerCase())throw new d.DOMException(d.DOMException.TYPE_MISMATCH_ERR);a.call(this,b.src,arguments[1])}}catch(g){this.trigger("error",g.code)}}function r(a,b){var c=this.connectRuntime(a.ruid);this.ruid=c.uid;c.exec.call(this,"Image","loadFromImage",a,"undefined"===e.typeOf(b)?!0:b)}function x(a,b){function c(b){d.ruid=b.uid;b.exec.call(d,"Image","loadFromBlob",a)}var d=this;d.name=a.name||"";a.isDetached()?(this.bind("RuntimeInit",
function(a,b){c(b)}),b&&"string"==typeof b.required_caps&&(b.required_caps=f.parseCaps(b.required_caps)),this.connectRuntime(e.extend({required_caps:{access_image_binary:!0,resize_image:!0}},b))):c(this.connectRuntime(a.ruid))}function A(a,b){var d=this,e;e=new c;e.open("get",a);e.responseType="blob";e.onprogress=function(a){d.trigger(a)};e.onload=function(){x.call(d,e.response,!0)};e.onerror=function(a){d.trigger(a)};e.onloadend=function(){e.destroy()};e.bind("RuntimeError",function(a,b){d.trigger("RuntimeError",
b)});e.send(null,b)}g.call(this);e.extend(this,{uid:e.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function(){this.load.apply(this,arguments)},load:function(){this.bind("Load Resize",function(){var a=void 0,a=this.getRuntime().exec.call(this,"Image","getInfo");this.size=a.size;this.width=a.width;this.height=a.height;this.type=a.type;this.meta=a.meta;""===this.name&&(this.name=a.name)},999);this.convertEventPropsToHandlers(y);a.apply(this,arguments)},downsize:function(a,
b,c,g){var f={width:this.width,height:this.height,crop:!1,preserveHeaders:!0};a="object"==typeof a?e.extend(f,a):e.extend(f,{width:a,height:b,crop:c,preserveHeaders:g});try{if(!this.size)throw new d.DOMException(d.DOMException.INVALID_STATE_ERR);if(this.width>t.MAX_RESIZE_WIDTH||this.height>t.MAX_RESIZE_HEIGHT)throw new d.ImageError(d.ImageError.MAX_RESOLUTION_ERR);this.getRuntime().exec.call(this,"Image","downsize",a.width,a.height,a.crop,a.preserveHeaders)}catch(k){this.trigger("error",k.code)}},
crop:function(a,b,c){this.downsize(a,b,!0,c)},getAsCanvas:function(){if(!q.can("create_canvas"))throw new d.RuntimeError(d.RuntimeError.NOT_SUPPORTED_ERR);return this.connectRuntime(this.ruid).exec.call(this,"Image","getAsCanvas")},getAsBlob:function(a,b){if(!this.size)throw new d.DOMException(d.DOMException.INVALID_STATE_ERR);return a||(a="image/jpeg"),"image/jpeg"!==a||b||(b=90),this.getRuntime().exec.call(this,"Image","getAsBlob",a,b)},getAsDataURL:function(a,b){if(!this.size)throw new d.DOMException(d.DOMException.INVALID_STATE_ERR);
return this.getRuntime().exec.call(this,"Image","getAsDataURL",a,b)},getAsBinaryString:function(a,b){var c=this.getAsDataURL(a,b);return p.atob(c.substring(c.indexOf("base64,")+7))},embed:function(a,c){function g(){if(q.can("create_canvas")){var b=k.getAsCanvas();if(b)return a.appendChild(b),b=null,k.destroy(),void f.trigger("embedded")}b=k.getAsDataURL(r,l);if(!b)throw new d.ImageError(d.ImageError.WRONG_FORMAT);if(q.can("use_data_uri_of",b.length))a.innerHTML='<img src="'+b+'" width="'+k.width+
'" height="'+k.height+'" />',k.destroy(),f.trigger("embedded");else{var c=new m;c.bind("TransportingComplete",function(){z=f.connectRuntime(this.result.ruid);f.bind("Embedded",function(){e.extend(z.getShimContainer().style,{top:"0px",left:"0px",width:k.width+"px",height:k.height+"px"});z=null},999);z.exec.call(f,"ImageView","display",this.result.uid,u,B);k.destroy()});c.transport(p.atob(b.substring(b.indexOf("base64,")+7)),r,e.extend({},v,{required_caps:{display_media:!0},runtime_order:"flash,silverlight",
container:a}))}}var f=this,k,r,l,n,v=c||{},u=this.width,B=this.height,z;try{if(!(a=b.get(a)))throw new d.DOMException(d.DOMException.INVALID_NODE_TYPE_ERR);if(!this.size)throw new d.DOMException(d.DOMException.INVALID_STATE_ERR);if(this.width>t.MAX_RESIZE_WIDTH||this.height>t.MAX_RESIZE_HEIGHT)throw new d.ImageError(d.ImageError.MAX_RESOLUTION_ERR);if(r=v.type||this.type||"image/jpeg",l=v.quality||90,n="undefined"!==e.typeOf(v.crop)?v.crop:!1,v.width)u=v.width,B=v.height||u;else{var x=b.getSize(a);
x.w&&x.h&&(u=x.w,B=x.h)}return k=new t,k.bind("Resize",function(){g.call(f)}),k.bind("Load",function(){k.downsize(u,B,n,!1)}),k.clone(this,!1),k}catch(y){this.trigger("error",y.code)}},destroy:function(){this.ruid&&(this.getRuntime().exec.call(this,"Image","destroy"),this.disconnectRuntime());this.unbindAll()}})}var y=["progress","load","error","resize","embedded"];return t.MAX_RESIZE_WIDTH=6500,t.MAX_RESIZE_HEIGHT=6500,t.prototype=r.instance,t});l("moxie/runtime/html5/Runtime",["moxie/core/utils/Basic",
"moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(e,b,d,a){var c={};return d.addConstructor("html5",function(b,g,f){var q=this,r=d.capTest,l=d.capTrue;f=e.extend({access_binary:r(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function(){return q.can("access_binary")&&!!c.Image},display_media:r(a.can("create_canvas")||a.can("use_data_uri_over32kb")),do_cors:r(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),drag_and_drop:r(function(){var b=
document.createElement("div");return("draggable"in b||"ondragstart"in b&&"ondrop"in b)&&("IE"!==a.browser||9<a.version)}()),filter_by_extension:r("Chrome"===a.browser&&28<=a.version||"IE"===a.browser&&10<=a.version),return_response_headers:l,return_response_type:function(b){return"json"===b&&window.JSON?!0:a.can("return_response_type",b)},return_status_code:l,report_upload_progress:r(window.XMLHttpRequest&&(new XMLHttpRequest).upload),resize_image:function(){return q.can("access_binary")&&a.can("create_canvas")},
select_file:function(){return a.can("use_fileinput")&&window.File},select_folder:function(){return q.can("select_file")&&"Chrome"===a.browser&&21<=a.version},select_multiple:function(){return!(!q.can("select_file")||"Safari"===a.browser&&"Windows"===a.os||"iOS"===a.os&&a.verComp(a.osVersion,"7.0.4","<"))},send_binary_string:r(window.XMLHttpRequest&&((new XMLHttpRequest).sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:r(window.XMLHttpRequest),send_multipart:function(){return!!(window.XMLHttpRequest&&
(new XMLHttpRequest).upload&&window.FormData)||q.can("send_binary_string")},slice_blob:r(window.File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function(){return q.can("slice_blob")&&q.can("send_multipart")},summon_file_dialog:r("Firefox"===a.browser&&4<=a.version||"Opera"===a.browser&&12<=a.version||"IE"===a.browser&&10<=a.version||!!~e.inArray(a.browser,["Chrome","Safari"])),upload_filesize:l},f);d.call(this,b,g||"html5",f);e.extend(this,{init:function(){this.trigger("Init")},
destroy:function(a){return function(){a.call(q);a=q=null}}(this.destroy)});e.extend(this.getShim(),c)}),c});l("moxie/runtime/html5/file/Blob",["moxie/runtime/html5/Runtime","moxie/file/Blob"],function(e,b){return e.Blob=function(){function d(a,b,d){var e;if(!window.File.prototype.slice)return(e=window.File.prototype.webkitSlice||window.File.prototype.mozSlice)?e.call(a,b,d):null;try{return a.slice(),a.slice(b,d)}catch(f){return a.slice(b,d-b)}}this.slice=function(){return new b(this.getRuntime().uid,
d.apply(this,arguments))}}});l("moxie/core/utils/Events",["moxie/core/utils/Basic"],function(e){function b(){this.returnValue=!1}function d(){this.cancelBubble=!0}var a={},c="moxie_"+e.guid(),f=function(b,d,f){var k;if(d=d.toLowerCase(),b[c]&&a[b[c]]&&a[b[c]][d]){k=a[b[c]][d];for(var l=k.length-1;0<=l&&(k[l].orig!==f&&k[l].key!==f||(b.removeEventListener?b.removeEventListener(d,k[l].func,!1):b.detachEvent&&b.detachEvent("on"+d,k[l].func),k[l].orig=null,k[l].func=null,k.splice(l,1),void 0===f));l--);
if(k.length||delete a[b[c]][d],e.isEmptyObj(a[b[c]])){delete a[b[c]];try{delete b[c]}catch(n){b[c]=void 0}}}};return{addEvent:function(g,f,k,l){var n;f=f.toLowerCase();g.addEventListener?(n=k,g.addEventListener(f,n,!1)):g.attachEvent&&(n=function(){var a=window.event;a.target||(a.target=a.srcElement);a.preventDefault=b;a.stopPropagation=d;k(a)},g.attachEvent("on"+f,n));g[c]||(g[c]=e.guid());a.hasOwnProperty(g[c])||(a[g[c]]={});g=a[g[c]];g.hasOwnProperty(f)||(g[f]=[]);g[f].push({func:n,orig:k,key:l})},
removeEvent:f,removeAllEvents:function(b,d){b&&b[c]&&e.each(a[b[c]],function(a,c){f(b,c,d)})}}});l("moxie/runtime/html5/file/FileInput","moxie/runtime/html5/Runtime moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Events moxie/core/utils/Mime moxie/core/utils/Env".split(" "),function(e,b,d,a,c,f){return e.FileInput=function(){var e=[],h;b.extend(this,{init:function(q){var l=this,n=l.getRuntime(),p,w,t;h=q;e=[];q=h.accept.mimes||c.extList2mimes(h.accept,n.can("filter_by_extension"));p=
n.getShimContainer();p.innerHTML='<input id="'+n.uid+'" type="file" style="font-size:999px;opacity:0;"'+(h.multiple&&n.can("select_multiple")?"multiple":"")+(h.directory&&n.can("select_folder")?"webkitdirectory directory":"")+(q?' accept="'+q.join(",")+'"':"")+" />";q=d.get(n.uid);b.extend(q.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"});w=d.get(h.browse_button);n.can("summon_file_dialog")&&("static"===d.getStyle(w,"position")&&(w.style.position="relative"),t=parseInt(d.getStyle(w,
"z-index"),10)||1,w.style.zIndex=t,p.style.zIndex=t-1,a.addEvent(w,"click",function(a){var b=d.get(n.uid);b&&!b.disabled&&b.click();a.preventDefault()},l.uid));t=n.can("summon_file_dialog")?w:p;a.addEvent(t,"mouseover",function(){l.trigger("mouseenter")},l.uid);a.addEvent(t,"mouseout",function(){l.trigger("mouseleave")},l.uid);a.addEvent(t,"mousedown",function(){l.trigger("mousedown")},l.uid);a.addEvent(d.get(h.container),"mouseup",function(){l.trigger("mouseup")},l.uid);q.onchange=function z(){if(e=
[],h.directory?b.each(this.files,function(a){"."!==a.name&&e.push(a)}):e=[].slice.call(this.files),"IE"!==f.browser&&"IEMobile"!==f.browser)this.value="";else{var a=this.cloneNode(!0);this.parentNode.replaceChild(a,this);a.onchange=z}l.trigger("change")};l.trigger({type:"ready",async:!0});p=null},getFiles:function(){return e},disable:function(a){var b=this.getRuntime(),c;(c=d.get(b.uid))&&(c.disabled=!!a)},destroy:function(){var b=this.getRuntime(),c=b.getShim(),b=b.getShimContainer();a.removeAllEvents(b,
this.uid);a.removeAllEvents(h&&d.get(h.container),this.uid);a.removeAllEvents(h&&d.get(h.browse_button),this.uid);b&&(b.innerHTML="");c.removeInstance(this.uid);e=h=null}})}});l("moxie/runtime/html5/file/FileDrop",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime"],function(e,b,d,a,c){return e.FileDrop=function(){function e(a){if(!a.dataTransfer||!a.dataTransfer.types)return!1;a=b.toArray(a.dataTransfer.types||[]);return-1!==
b.inArray("Files",a)||-1!==b.inArray("public.file-url",a)||-1!==b.inArray("application/x-moz-file",a)}function g(a){for(var c=[],d=0;d<a.length;d++)[].push.apply(c,a[d].extensions.split(/\s*,\s*/));return-1===b.inArray("*",c)?c:[]}function f(a){if(!t.length)return!0;a=c.getFileExtension(a.name);return!a||-1!==b.inArray(a,t)}function h(a,c){var d=[];b.each(a,function(a){var b=a.webkitGetAsEntry();b&&(b.isFile?(a=a.getAsFile(),f(a)&&w.push(a)):d.push(b))});d.length?l(d,c):c()}function l(a,c){var d=
[];b.each(a,function(a){d.push(function(b){n(a,b)})});b.inSeries(d,function(){c()})}function n(a,b){a.isFile?a.file(function(a){f(a)&&w.push(a);b()},function(){b()}):a.isDirectory?p(a,b):b()}function p(a,b){function c(a){e.readEntries(function(b){b.length?([].push.apply(d,b),c(a)):a()},a)}var d=[],e=a.createReader();c(function(){l(d,b)})}var w=[],t=[],y;b.extend(this,{init:function(c){var d=this;y=c;t=g(y.accept);c=y.container;a.addEvent(c,"dragover",function(a){e(a)&&(a.preventDefault(),a.dataTransfer.dropEffect=
"copy")},d.uid);a.addEvent(c,"drop",function(a){e(a)&&(a.preventDefault(),w=[],a.dataTransfer.items&&a.dataTransfer.items[0].webkitGetAsEntry?h(a.dataTransfer.items,function(){d.trigger("drop")}):(b.each(a.dataTransfer.files,function(a){f(a)&&w.push(a)}),d.trigger("drop")))},d.uid);a.addEvent(c,"dragenter",function(a){d.trigger("dragenter")},d.uid);a.addEvent(c,"dragleave",function(a){d.trigger("dragleave")},d.uid)},getFiles:function(){return w},destroy:function(){a.removeAllEvents(y&&d.get(y.container),
this.uid);w=t=y=null}})}});l("moxie/runtime/html5/file/FileReader",["moxie/runtime/html5/Runtime","moxie/core/utils/Encode","moxie/core/utils/Basic"],function(e,b,d){return e.FileReader=function(){var a,c=!1;d.extend(this,{read:function(b,e){var f=this;a=new window.FileReader;a.addEventListener("progress",function(a){f.trigger(a)});a.addEventListener("load",function(a){f.trigger(a)});a.addEventListener("error",function(b){f.trigger(b,a.error)});a.addEventListener("loadend",function(){a=null});"function"===
d.typeOf(a[b])?(c=!1,a[b](e.getSource())):"readAsBinaryString"===b&&(c=!0,a.readAsDataURL(e.getSource()))},getResult:function(){return a&&a.result?c?b.atob(a.result.substring(a.result.indexOf("base64,")+7)):a.result:null},abort:function(){a&&a.abort()},destroy:function(){a=null}})}});l("moxie/runtime/html5/xhr/XMLHttpRequest","moxie/runtime/html5/Runtime moxie/core/utils/Basic moxie/core/utils/Mime moxie/core/utils/Url moxie/file/File moxie/file/Blob moxie/xhr/FormData moxie/core/Exceptions moxie/core/utils/Env".split(" "),
function(e,b,d,a,c,f,g,m,q){return e.XMLHttpRequest=function(){function e(a,b){var c=this,d,g;d=b.getBlob().getSource();g=new window.FileReader;g.onload=function(){b.append(b.getBlobName(),new f(null,{type:d.type,data:g.result}));n.send.call(c,a,b)};g.readAsBinaryString(d)}function h(){var a;if(!window.XMLHttpRequest||"IE"===q.browser&&8>q.version)a:{for(var b=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"],c=0;c<b.length;c++)try{a=new ActiveXObject(b[c]);break a}catch(d){}a=void 0}else a=new window.XMLHttpRequest;
return a}function l(a){var b="----moxieboundary"+(new Date).getTime(),c="";if(!this.getRuntime().can("send_binary_string"))throw new m.RuntimeError(m.RuntimeError.NOT_SUPPORTED_ERR);return p.setRequestHeader("Content-Type","multipart/form-data; boundary="+b),a.each(function(a,d){c+=a instanceof f?"--"+b+'\r\nContent-Disposition: form-data; name="'+d+'"; filename="'+unescape(encodeURIComponent(a.name||"blob"))+'"\r\nContent-Type: '+(a.type||"application/octet-stream")+"\r\n\r\n"+a.getSource()+"\r\n":
"--"+b+'\r\nContent-Disposition: form-data; name="'+d+'"\r\n\r\n'+unescape(encodeURIComponent(a))+"\r\n"}),c+="--"+b+"--\r\n"}var n=this,p,y;b.extend(this,{send:function(c,d){var m=this,n="Mozilla"===q.browser&&4<=q.version&&7>q.version,w="Android Browser"===q.browser,s=!1;if(y=c.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase(),p=h(),p.open(c.method,c.url,c.async,c.user,c.password),d instanceof f)d.isDetached()&&(s=!0),d=d.getSource();else if(d instanceof g){if(d.hasBlob())if(d.getBlob().isDetached())d=
l.call(m,d),s=!0;else if((n||w)&&"blob"===b.typeOf(d.getBlob().getSource())&&window.FileReader)return void e.call(m,c,d);if(d instanceof g){var C=new window.FormData;d.each(function(a,b){a instanceof f?C.append(b,a.getSource()):C.append(b,a)});d=C}}p.upload?(c.withCredentials&&(p.withCredentials=!0),p.addEventListener("load",function(a){m.trigger(a)}),p.addEventListener("error",function(a){m.trigger(a)}),p.addEventListener("progress",function(a){m.trigger(a)}),p.upload.addEventListener("progress",
function(a){m.trigger({type:"UploadProgress",loaded:a.loaded,total:a.total})})):p.onreadystatechange=function(){switch(p.readyState){case 3:var b,d;try{a.hasSameOrigin(c.url)&&(b=p.getResponseHeader("Content-Length")||0),p.responseText&&(d=p.responseText.length)}catch(e){b=d=0}m.trigger({type:"progress",lengthComputable:!!b,total:parseInt(b,10),loaded:d});break;case 4:p.onreadystatechange=function(){},m.trigger(0===p.status?"error":"load")}};b.isEmptyObj(c.headers)||b.each(c.headers,function(a,b){p.setRequestHeader(b,
a)});""!==c.responseType&&"responseType"in p&&(p.responseType="json"!==c.responseType||q.can("return_response_type","json")?c.responseType:"text");s?p.sendAsBinary?p.sendAsBinary(d):!function(){for(var a=new Uint8Array(d.length),b=0;b<d.length;b++)a[b]=255&d.charCodeAt(b);p.send(a.buffer)}():p.send(d);m.trigger("loadstart")},getStatus:function(){try{if(p)return p.status}catch(a){}return 0},getResponse:function(a){var b=this.getRuntime();try{switch(a){case "blob":var e=new c(b.uid,p.response),f=p.getResponseHeader("Content-Disposition");
if(f){var g=f.match(/filename=([\'\"'])([^\1]+)\1/);g&&(y=g[2])}return e.name=y,e.type||(e.type=d.getFileMime(y)),e;case "json":return q.can("return_response_type","json")?p.response:200===p.status&&window.JSON?JSON.parse(p.responseText):null;case "document":var k=p.responseXML,h=p.responseText;return"IE"===q.browser&&h&&k&&!k.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(p.getResponseHeader("Content-Type"))&&(k=new window.ActiveXObject("Microsoft.XMLDOM"),k.async=!1,k.validateOnParse=!1,k.loadXML(h)),
k&&("IE"===q.browser&&0!==k.parseError||!k.documentElement||"parsererror"===k.documentElement.tagName)?null:k;default:return""!==p.responseText?p.responseText:null}}catch(m){return null}},getAllResponseHeaders:function(){try{return p.getAllResponseHeaders()}catch(a){}return""},abort:function(){p&&p.abort()},destroy:function(){n=y=null}})}});l("moxie/runtime/html5/utils/BinaryReader",[],function(){return function(){function f(b,e){var g=d?0:-8*(e-1),h=0,q;for(q=0;e>q;q++)h|=a.charCodeAt(b+q)<<Math.abs(g+
8*q);return h}function b(b,d,e){e=3===arguments.length?e:a.length-d-1;a=a.substr(0,d)+b+a.substr(e+d)}var d=!1,a;return{II:function(a){return a===e?d:void(d=a)},init:function(b){d=!1;a=b},SEGMENT:function(c,d,e){switch(arguments.length){case 1:return a.substr(c,a.length-c-1);case 2:return a.substr(c,d);case 3:b(e,c,d);break;default:return a}},BYTE:function(a){return f(a,1)},SHORT:function(a){return f(a,2)},LONG:function(a,k){var g;if(k===e)g=f(a,4);else{g="";var m=d?0:-24,q;for(q=0;4>q;q++)g+=String.fromCharCode(k>>
Math.abs(m+8*q)&255);b(g,a,4);g=void 0}return g},SLONG:function(a){a=f(a,4);return 2147483647<a?a-4294967296:a},STRING:function(a,b){var d="";for(b+=a;b>a;a++)d+=String.fromCharCode(f(a,1));return d}}}});l("moxie/runtime/html5/image/JPEGHeaders",["moxie/runtime/html5/utils/BinaryReader"],function(e){return function d(a){var c=[],f,g,m,q=0;if(f=new e,f.init(a),65496===f.SHORT(0)){for(g=2;g<=a.length;)if(m=f.SHORT(g),65488<=m&&65495>=m)g+=2;else{if(65498===m||65497===m)break;q=f.SHORT(g+2)+2;65505<=
m&&65519>=m&&c.push({hex:m,name:"APP"+(15&m),start:g,length:q,segment:f.SEGMENT(g,q)});g+=q}return f.init(null),{headers:c,restore:function(a){var d,e;f.init(a);g=65504==f.SHORT(2)?4+f.SHORT(4):2;e=0;for(d=c.length;d>e;e++)f.SEGMENT(g,0,c[e].segment),g+=c[e].length;return a=f.SEGMENT(),f.init(null),a},strip:function(a){var c,e;e=new d(a);c=e.headers;e.purge();f.init(a);for(e=c.length;e--;)f.SEGMENT(c[e].start,c[e].length,"");return a=f.SEGMENT(),f.init(null),a},get:function(a){for(var d=[],e=0,f=
c.length;f>e;e++)c[e].name===a.toUpperCase()&&d.push(c[e].segment);return d},set:function(a,d){var e=[],f,g,h;"string"==typeof d?e.push(d):e=d;f=g=0;for(h=c.length;h>f&&(c[f].name===a.toUpperCase()&&(c[f].segment=e[g],c[f].length=e[g].length,g++),!(g>=e.length));f++);},purge:function(){c=[];f.init(null);f=null}}}}});l("moxie/runtime/html5/image/ExifParser",["moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(f,b){return function(){function d(b,c){var d=a.SHORT(b),f,h,k,l,n,
p,s=[],A={};for(f=0;d>f;f++)if(p=b+12*f+2,k=c[a.SHORT(p)],k!==e){switch(l=a.SHORT(p+=2),n=a.LONG(p+=2),p+=4,s=[],l){case 1:case 7:4<n&&(p=a.LONG(p)+g.tiffHeader);for(h=0;n>h;h++)s[h]=a.BYTE(p+h);break;case 2:4<n&&(p=a.LONG(p)+g.tiffHeader);A[k]=a.STRING(p,n-1);continue;case 3:2<n&&(p=a.LONG(p)+g.tiffHeader);for(h=0;n>h;h++)s[h]=a.SHORT(p+2*h);break;case 4:1<n&&(p=a.LONG(p)+g.tiffHeader);for(h=0;n>h;h++)s[h]=a.LONG(p+4*h);break;case 5:p=a.LONG(p)+g.tiffHeader;for(h=0;n>h;h++)s[h]=a.LONG(p+4*h)/a.LONG(p+
4*h+4);break;case 9:p=a.LONG(p)+g.tiffHeader;for(h=0;n>h;h++)s[h]=a.SLONG(p+4*h);break;case 10:p=a.LONG(p)+g.tiffHeader;for(h=0;n>h;h++)s[h]=a.SLONG(p+4*h)/a.SLONG(p+4*h+4);break;default:continue}h=1==n?s[0]:s;A[k]=m.hasOwnProperty(k)&&"object"!=typeof h?m[k][h]:h}return A}var a,c,k,g={},m;return a=new b,c={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",
40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}},m={ColorSpace:{1:"sRGB",0:"Uncalibrated"},
MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",
23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",
31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",
93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},
GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}},{init:function(b){g={tiffHeader:10};if(b!==e&&b.length)if(a.init(b),65505===a.SHORT(0)&&"EXIF\x00"===a.STRING(4,5).toUpperCase()){var f=g.tiffHeader;b=(a.II(18761==a.SHORT(f)),42!==a.SHORT(f+=2)?!1:(g.IFD0=g.tiffHeader+a.LONG(f+2),k=d(g.IFD0,c.tiff),"ExifIFDPointer"in k&&(g.exifIFD=g.tiffHeader+k.ExifIFDPointer,delete k.ExifIFDPointer),"GPSInfoIFDPointer"in k&&(g.gpsIFD=g.tiffHeader+k.GPSInfoIFDPointer,
delete k.GPSInfoIFDPointer),!0))}else b=!1;else b=!1;return b},TIFF:function(){return k},EXIF:function(){var a;if(a=d(g.exifIFD,c.exif),a.ExifVersion&&"array"===f.typeOf(a.ExifVersion)){for(var b=0,e="";b<a.ExifVersion.length;b++)e+=String.fromCharCode(a.ExifVersion[b]);a.ExifVersion=e}return a},GPS:function(){var a;return a=d(g.gpsIFD,c.gps),a.GPSVersionID&&"array"===f.typeOf(a.GPSVersionID)&&(a.GPSVersionID=a.GPSVersionID.join(".")),a},setExif:function(b,d){var e;if("PixelXDimension"!==b&&"PixelYDimension"!==
b)e=!1;else{e=b;var f,h,k,m=0;if("string"==typeof e)for(h in f=c.exif,f)if(f[h]===e){e=h;break}f=g.exifIFD;h=a.SHORT(f);for(var l=0;h>l;l++)if(k=f+12*l+2,a.SHORT(k)==e){m=k+8;break}e=m?(a.LONG(m,d),!0):!1}return e},getBinary:function(){return a.SEGMENT()},purge:function(){a.init(null);a=k=null;g={}}}}});l("moxie/runtime/html5/image/JPEG",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEGHeaders","moxie/runtime/html5/utils/BinaryReader","moxie/runtime/html5/image/ExifParser"],
function(e,b,d,a,c){return function(f){var g,m,l,n,p,u;if(g=f,m=new a,m.init(g),65496!==m.SHORT(0))throw new b.ImageError(b.ImageError.WRONG_FORMAT);l=new d(f);n=new c;u=!!n.init(l.get("app1")[0]);p=function(){for(var a=0,b,c;a<=g.length;){if(b=m.SHORT(a+=2),65472<=b&&65475>=b)return a+=5,{height:m.SHORT(a),width:m.SHORT(a+2)};c=m.SHORT(a+=2);a+=c-2}return null}.call(this);e.extend(this,{type:"image/jpeg",size:g.length,width:p&&p.width||0,height:p&&p.height||0,setExif:function(a,b){return u?("object"===
e.typeOf(a)?e.each(a,function(a,b){n.setExif(b,a)}):n.setExif(a,b),void l.set("app1",n.getBinary())):!1},writeHeaders:function(){return arguments.length?l.restore(arguments[0]):g=l.restore(g)},stripHeaders:function(a){return l.strip(a)},purge:function(){n&&l&&m&&(n.purge(),l.purge(),m.init(null),g=p=l=n=m=null)}});u&&(this.meta={tiff:n.TIFF(),exif:n.EXIF(),gps:n.GPS()})}});l("moxie/runtime/html5/image/PNG",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],
function(e,b,d){return function(a){function c(){g&&(g.init(null),f=m=g=null)}var f,g,m;f=a;g=new d;g.init(f);(function(){for(var a=0,b=0,c=[35152,20039,3338,6666],b=0;b<c.length;b++,a+=2)if(c[b]!=g.SHORT(a))throw new e.ImageError(e.ImageError.WRONG_FORMAT);})();m=function(){var a,b,c=8,d,e,f,h;return a=(d=g.LONG(c),e=g.STRING(c+=4,4),f=c+=4,h=g.LONG(c+d),{length:d,type:e,start:f,CRC:h}),"IHDR"==a.type?(b=a.start,{width:g.LONG(b),height:g.LONG(b+4)}):null}.call(this);b.extend(this,{type:"image/png",
size:f.length,width:m.width,height:m.height,purge:function(){c.call(this)}});c.call(this)}});l("moxie/runtime/html5/image/ImageInfo",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEG","moxie/runtime/html5/image/PNG"],function(e,b,d,a){return function(c){var f=[d,a],g;g=function(){for(var a=0;a<f.length;a++)try{return new f[a](c)}catch(d){}throw new b.ImageError(b.ImageError.WRONG_FORMAT);}();e.extend(this,{type:"",size:0,width:0,height:0,setExif:function(){},writeHeaders:function(a){return a},
stripHeaders:function(a){return a},purge:function(){}});e.extend(this,g);this.purge=function(){g.purge();g=null}}});l("moxie/runtime/html5/image/MegaPixel",[],function(){function e(b){var d=b.naturalWidth;if(1048576<d*b.naturalHeight){var a=document.createElement("canvas");a.width=a.height=1;a=a.getContext("2d");return a.drawImage(b,-d+1,0),0===a.getImageData(0,0,1,1).data[3]}return!1}return{isSubsampled:e,renderTo:function(b,d,a){var c=b.naturalWidth,f=b.naturalHeight,g=a.width,m=a.height,l=a.x||
0;a=a.y||0;d=d.getContext("2d");e(b)&&(c/=2,f/=2);var n=document.createElement("canvas");n.width=n.height=1024;var p=n.getContext("2d"),u;u=f;var w=document.createElement("canvas");w.width=1;w.height=u;w=w.getContext("2d");w.drawImage(b,0,0);for(var w=w.getImageData(0,0,1,u).data,t=0,s=u,z=u;z>t;)0===w[4*(z-1)+3]?s=z:t=z,z=s+t>>1;u=z/u;u=0===u?1:u;for(w=0;f>w;){t=w+1024>f?f-w:1024;for(s=0;c>s;){z=s+1024>c?c-s:1024;p.clearRect(0,0,1024,1024);p.drawImage(b,-s,-w);var B=s*g/c+l<<0,x=Math.ceil(z*g/c),
A=w*m/f/u+a<<0,D=Math.ceil(t*m/f/u);d.drawImage(n,0,0,z,t,B,A,x,D);s+=1024}w+=1024}}}});l("moxie/runtime/html5/image/Image","moxie/runtime/html5/Runtime moxie/core/utils/Basic moxie/core/Exceptions moxie/core/utils/Encode moxie/file/File moxie/runtime/html5/image/ImageInfo moxie/runtime/html5/image/MegaPixel moxie/core/utils/Mime moxie/core/utils/Env".split(" "),function(e,b,d,a,c,f,g,m,l){return e.Image=function(){function e(){if(!A&&!B)throw new d.ImageError(d.DOMException.INVALID_STATE_ERR);return A||
B}function h(b){return a.atob(b.substring(b.indexOf("base64,")+7))}function n(b){var c=this;B=new Image;B.onerror=function(){s.call(this);c.trigger("error",d.ImageError.WRONG_FORMAT)};B.onload=function(){c.trigger("load")};B.src=/^data:[^;]*;base64,/.test(b)?b:"data:"+(L.type||"")+";base64,"+a.btoa(b)}function p(a,b){var c=this,e;return window.FileReader?(e=new FileReader,e.onload=function(){b(this.result)},e.onerror=function(){c.trigger("error",d.ImageError.WRONG_FORMAT)},e.readAsDataURL(a),void 0):
b(a.getAsDataURL())}function t(a,c,d,f){var h,k=0,m=0,n,p;if(G=f,p=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1,-1!==b.inArray(p,[5,6,7,8]))n=a,a=c,c=n;n=e();d?(a=Math.min(a,n.width),c=Math.min(c,n.height),h=Math.max(a/n.width,c/n.height)):h=Math.min(a/n.width,c/n.height);if(1<h&&!d&&f)m=void this.trigger("Resize");else{A||(A=document.createElement("canvas"));f=Math.round(n.width*h);h=Math.round(n.height*h);d?(A.width=a,A.height=c,f>a&&(k=Math.round((f-a)/2)),h>c&&(m=Math.round((h-c)/
2))):(A.width=f,A.height=h);if(!G){a=A.width;c=A.height;switch(p){case 5:case 6:case 7:case 8:A.width=c;A.height=a;break;default:A.width=a,A.height=c}d=A.getContext("2d");switch(p){case 2:d.translate(a,0);d.scale(-1,1);break;case 3:d.translate(a,c);d.rotate(Math.PI);break;case 4:d.translate(0,c);d.scale(1,-1);break;case 5:d.rotate(0.5*Math.PI);d.scale(1,-1);break;case 6:d.rotate(0.5*Math.PI);d.translate(0,-c);break;case 7:d.rotate(0.5*Math.PI);d.translate(a,-c);d.scale(-1,1);break;case 8:d.rotate(-0.5*
Math.PI),d.translate(-a,0)}}p=A;k=-k;m=-m;"iOS"===l.OS?g.renderTo(n,p,{width:f,height:h,x:k,y:m}):p.getContext("2d").drawImage(n,k,m,f,h);m=(this.width=A.width,this.height=A.height,C=!0,void this.trigger("Resize"))}return m}function s(){x&&(x.purge(),x=null);D=B=A=L=null;C=!1}var z=this,B,x,A,D,L,C=!1,G=!0;b.extend(this,{loadFromBlob:function(a){var b=this,c=b.getRuntime(),e=1<arguments.length?arguments[1]:!0;if(!c.can("access_binary"))throw new d.RuntimeError(d.RuntimeError.NOT_SUPPORTED_ERR);return L=
a,a.isDetached()?(D=a.getSource(),void n.call(this,D)):void p.call(this,a.getSource(),function(a){e&&(D=h(a));n.call(b,a)})},loadFromImage:function(a,b){this.meta=a.meta;L=new c(null,{name:a.name,size:a.size,type:a.type});n.call(this,b?D=a.getAsBinaryString():a.getAsDataURL())},getInfo:function(){var a=this.getRuntime();return!x&&D&&a.can("access_image_binary")&&(x=new f(D)),{width:e().width||0,height:e().height||0,type:L.type||m.getFileMime(L.name),size:D&&D.length||L.size||0,name:L.name||"",meta:x&&
x.meta||this.meta||{}}},downsize:function(){t.apply(this,arguments)},getAsCanvas:function(){return A&&(A.id=this.uid+"_canvas"),A},getAsBlob:function(a,b){return a!==this.type&&t.call(this,this.width,this.height,!1),new c(null,{name:L.name||"",type:a,data:z.getAsBinaryString.call(this,a,b)})},getAsDataURL:function(a,b){var c=b||90;if(!C)return B.src;if("image/jpeg"!==a)return A.toDataURL("image/png");try{return A.toDataURL("image/jpeg",c/100)}catch(d){return A.toDataURL("image/jpeg")}},getAsBinaryString:function(a,
b){if(!C)return D||(D=h(z.getAsDataURL(a,b))),D;if("image/jpeg"!==a)D=h(z.getAsDataURL(a,b));else{var c;b||(b=90);try{c=A.toDataURL("image/jpeg",b/100)}catch(d){c=A.toDataURL("image/jpeg")}D=h(c);x&&(D=x.stripHeaders(D),G&&(x.meta&&x.meta.exif&&x.setExif({PixelXDimension:this.width,PixelYDimension:this.height}),D=x.writeHeaders(D)),x.purge(),x=null)}return C=!1,D},destroy:function(){z=null;s.call(this);this.getRuntime().getShim().removeInstance(this.uid)}})}});l("moxie/runtime/flash/Runtime",["moxie/core/utils/Basic",
"moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(e,b,d,a,c){function f(){var a;try{a=navigator.plugins["Shockwave Flash"],a=a.description}catch(b){try{a=(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version")}catch(c){a="0.0"}}return a=a.match(/\d+/g),parseFloat(a[0]+"."+a[1])}var g={};return c.addConstructor("flash",function(m){var l=this,n;m=e.extend({swf_url:b.swf_url},m);c.call(this,m,"flash",{access_binary:function(a){return a&&
"browser"===l.mode},access_image_binary:function(a){return a&&"browser"===l.mode},display_media:c.capTrue,do_cors:c.capTrue,drag_and_drop:!1,report_upload_progress:function(){return"client"===l.mode},resize_image:c.capTrue,return_response_headers:!1,return_response_type:function(a){return"json"===a&&window.JSON?!0:!e.arrayDiff(a,["","text","document"])||"browser"===l.mode},return_status_code:function(a){return"browser"===l.mode||!e.arrayDiff(a,[200,404])},select_file:c.capTrue,select_multiple:c.capTrue,
send_binary_string:function(a){return a&&"browser"===l.mode},send_browser_cookies:function(a){return a&&"browser"===l.mode},send_custom_headers:function(a){return a&&"browser"===l.mode},send_multipart:c.capTrue,slice_blob:function(a){return a&&"browser"===l.mode},stream_upload:function(a){return a&&"browser"===l.mode},summon_file_dialog:!1,upload_filesize:function(a){return 2097152>=e.parseSizeStr(a)||"client"===l.mode},use_http_method:function(a){return!e.arrayDiff(a,["GET","POST"])}},{access_binary:function(a){return a?
"browser":"client"},access_image_binary:function(a){return a?"browser":"client"},report_upload_progress:function(a){return a?"browser":"client"},return_response_type:function(a){return e.arrayDiff(a,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function(a){return e.arrayDiff(a,[200,404])?"browser":["client","browser"]},send_binary_string:function(a){return a?"browser":"client"},send_browser_cookies:function(a){return a?"browser":"client"},send_custom_headers:function(a){return a?
"browser":"client"},stream_upload:function(a){return a?"client":"browser"},upload_filesize:function(a){return 2097152<=e.parseSizeStr(a)?"client":"browser"}},"client");10>f()&&(this.mode=!1);e.extend(this,{getShim:function(){return d.get(this.uid)},shimExec:function(a,b){var c=[].slice.call(arguments,2);return l.getShim().exec(this.uid,a,b,c)},init:function(){var c,d,f;f=this.getShimContainer();e.extend(f.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"});
c='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+m.swf_url+'" ';"IE"===b.browser&&(c+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" ');c+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+m.swf_url+'" /><param name="flashvars" value="uid='+escape(this.uid)+"&target="+b.global_event_dispatcher+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>';"IE"===b.browser?(d=document.createElement("div"),
f.appendChild(d),d.outerHTML=c,d=f=null):f.innerHTML=c;n=setTimeout(function(){l&&!l.initialized&&l.trigger("Error",new a.RuntimeError(a.RuntimeError.NOT_INIT_ERR))},5E3)},destroy:function(a){return function(){a.call(l);clearTimeout(n);m=n=a=l=null}}(this.destroy)},g)}),g});l("moxie/runtime/flash/file/Blob",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(e,b){return e.Blob={slice:function(d,a,c,e){var f=this.getRuntime();return 0>a?a=Math.max(d.size+a,0):0<a&&(a=Math.min(a,d.size)),0>c?
c=Math.max(d.size+c,0):0<c&&(c=Math.min(c,d.size)),d=f.shimExec.call(this,"Blob","slice",a,c,e||""),d&&(d=new b(f.uid,d)),d}}});l("moxie/runtime/flash/file/FileInput",["moxie/runtime/flash/Runtime"],function(e){return e.FileInput={init:function(b){this.getRuntime().shimExec.call(this,"FileInput","init",{name:b.name,accept:b.accept,multiple:b.multiple});this.trigger("ready")}}});l("moxie/runtime/flash/file/FileReader",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(e,b){function d(a,
d){switch(d){case "readAsText":return b.atob(a,"utf8");case "readAsBinaryString":return b.atob(a);case "readAsDataURL":return a}return null}var a="";return e.FileReader={read:function(b,e){var f=this.getRuntime();return"readAsDataURL"===b&&(a="data:"+(e.type||"")+";base64,"),this.bind("Progress",function(e,f){f&&(a+=d(f,b))}),f.shimExec.call(this,"FileReader","readAsBase64",e.uid)},getResult:function(){return a},destroy:function(){a=null}}});l("moxie/runtime/flash/file/FileReaderSync",["moxie/runtime/flash/Runtime",
"moxie/core/utils/Encode"],function(e,b){function d(a,c){switch(c){case "readAsText":return b.atob(a,"utf8");case "readAsBinaryString":return b.atob(a);case "readAsDataURL":return a}return null}return e.FileReaderSync={read:function(a,b){var e;return(e=this.getRuntime().shimExec.call(this,"FileReaderSync","readAsBase64",b.uid))?("readAsDataURL"===a&&(e="data:"+(b.type||"")+";base64,"+e),d(e,a,b.type)):null}}});l("moxie/runtime/flash/xhr/XMLHttpRequest","moxie/runtime/flash/Runtime moxie/core/utils/Basic moxie/file/Blob moxie/file/File moxie/file/FileReaderSync moxie/xhr/FormData moxie/runtime/Transporter".split(" "),
function(e,b,d,a,c,f,g){return e.XMLHttpRequest={send:function(a,c){function e(){a.transport=p.mode;p.shimExec.call(n,"XMLHttpRequest","send",a,c)}function h(a,b){p.shimExec.call(n,"XMLHttpRequest","appendBlob",a,b.uid);c=null;e()}function l(a,b){var c=new g;c.bind("TransportingComplete",function(){b(this.result)});c.transport(a.getSource(),a.type,{ruid:p.uid})}var n=this,p=n.getRuntime();if(b.isEmptyObj(a.headers)||b.each(a.headers,function(a,b){p.shimExec.call(n,"XMLHttpRequest","setRequestHeader",
b,a.toString())}),c instanceof f){var s;if(c.each(function(a,b){a instanceof d?s=b:p.shimExec.call(n,"XMLHttpRequest","append",b,a)}),c.hasBlob()){var z=c.getBlob();z.isDetached()?l(z,function(a){z.destroy();h(s,a)}):h(s,z)}else c=null,e()}else c instanceof d?c.isDetached()?l(c,function(a){c.destroy();c=a.uid;e()}):(c=c.uid,e()):e()},getResponse:function(d){var e,f,g=this.getRuntime();if(f=g.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob")){if(f=new a(g.uid,f),"blob"===d)return f;try{if(e=
new c,~b.inArray(d,["","text"]))return e.readAsText(f);if("json"===d&&window.JSON)return JSON.parse(e.readAsText(f))}finally{f.destroy()}}return null},abort:function(a){this.getRuntime().shimExec.call(this,"XMLHttpRequest","abort");this.dispatchEvent("readystatechange");this.dispatchEvent("abort")}}});l("moxie/runtime/flash/runtime/Transporter",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(e,b){return e.Transporter={getAsBlob:function(d){var a=this.getRuntime();return(d=a.shimExec.call(this,
"Transporter","getAsBlob",d))?new b(a.uid,d):null}}});l("moxie/runtime/flash/image/Image",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/runtime/Transporter","moxie/file/Blob","moxie/file/FileReaderSync"],function(e,b,d,a,c){return e.Image={loadFromBlob:function(a){function b(a){e.shimExec.call(c,"Image","loadFromBlob",a.uid);c=e=null}var c=this,e=c.getRuntime();if(a.isDetached()){var f=new d;f.bind("TransportingComplete",function(){b(f.result.getSource())});f.transport(a.getSource(),
a.type,{ruid:e.uid})}else b(a.getSource())},loadFromImage:function(a){return this.getRuntime().shimExec.call(this,"Image","loadFromImage",a.uid)},getAsBlob:function(b,c){var d=this.getRuntime(),e=d.shimExec.call(this,"Image","getAsBlob",b,c);return e?new a(d.uid,e):null},getAsDataURL:function(){var a=this.getRuntime().Image.getAsBlob.apply(this,arguments),b;return a?(b=new c,b.readAsDataURL(a)):null}}});l("moxie/runtime/silverlight/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom",
"moxie/core/Exceptions","moxie/runtime/Runtime"],function(e,b,d,a,c){function f(a){var b=!1,c=null,d,e,g,h,k,l=0;try{try{c=new ActiveXObject("AgControl.AgControl"),c.IsVersionSupported(a)&&(b=!0)}catch(n){var p=navigator.plugins["Silverlight Plug-In"];if(p){d=p.description;"1.0.30226.2"===d&&(d="2.0.30226.2");for(e=d.split(".");3<e.length;)e.pop();for(;4>e.length;)e.push(0);for(g=a.split(".");4<g.length;)g.pop();do h=parseInt(g[l],10),k=parseInt(e[l],10),l++;while(l<g.length&&h===k);k>=h&&!isNaN(h)&&
(b=!0)}}}catch(s){b=!1}return b}var g={};return c.addConstructor("silverlight",function(l){var n=this,p;l=e.extend({xap_url:b.xap_url},l);c.call(this,l,"silverlight",{access_binary:c.capTrue,access_image_binary:c.capTrue,display_media:c.capTrue,do_cors:c.capTrue,drag_and_drop:!1,report_upload_progress:c.capTrue,resize_image:c.capTrue,return_response_headers:function(a){return a&&"client"===n.mode},return_response_type:function(a){return"json"!==a?!0:!!window.JSON},return_status_code:function(a){return"client"===
n.mode||!e.arrayDiff(a,[200,404])},select_file:c.capTrue,select_multiple:c.capTrue,send_binary_string:c.capTrue,send_browser_cookies:function(a){return a&&"browser"===n.mode},send_custom_headers:function(a){return a&&"client"===n.mode},send_multipart:c.capTrue,slice_blob:c.capTrue,stream_upload:!0,summon_file_dialog:!1,upload_filesize:c.capTrue,use_http_method:function(a){return"client"===n.mode||!e.arrayDiff(a,["GET","POST"])}},{return_response_headers:function(a){return a?"client":"browser"},return_status_code:function(a){return e.arrayDiff(a,
[200,404])?"client":["client","browser"]},send_browser_cookies:function(a){return a?"browser":"client"},send_custom_headers:function(a){return a?"client":"browser"},use_http_method:function(a){return e.arrayDiff(a,["GET","POST"])?"client":["client","browser"]}});f("2.0.31005.0")&&"Opera"!==b.browser||(this.mode=!1);e.extend(this,{getShim:function(){return d.get(this.uid).content.Moxie},shimExec:function(a,b){var c=[].slice.call(arguments,2);return n.getShim().exec(this.uid,a,b,c)},init:function(){this.getShimContainer().innerHTML=
'<object id="'+this.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;"><param name="source" value="'+l.xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="uid='+this.uid+",target="+b.global_event_dispatcher+'"/></object>';p=setTimeout(function(){n&&!n.initialized&&n.trigger("Error",new a.RuntimeError(a.RuntimeError.NOT_INIT_ERR))},
"Windows"!==b.OS?1E4:5E3)},destroy:function(a){return function(){a.call(n);clearTimeout(p);l=p=a=n=null}}(this.destroy)},g)}),g});l("moxie/runtime/silverlight/file/Blob",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/Blob"],function(e,b,d){return e.Blob=b.extend({},d)});l("moxie/runtime/silverlight/file/FileInput",["moxie/runtime/silverlight/Runtime"],function(e){return e.FileInput={init:function(b){this.getRuntime().shimExec.call(this,"FileInput","init",function(b){for(var a=
"",c=0;c<b.length;c++)a+=(""!==a?"|":"")+b[c].title+" | *."+b[c].extensions.replace(/,/g,";*.");return a}(b.accept),b.name,b.multiple);this.trigger("ready")}}});l("moxie/runtime/silverlight/file/FileDrop",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Dom","moxie/core/utils/Events"],function(e,b,d){return e.FileDrop={init:function(){var a=this.getRuntime(),c;return c=a.getShimContainer(),d.addEvent(c,"dragover",function(a){a.preventDefault();a.stopPropagation();a.dataTransfer.dropEffect="copy"},
this.uid),d.addEvent(c,"dragenter",function(c){c.preventDefault();b.get(a.uid).dragEnter(c)&&c.stopPropagation()},this.uid),d.addEvent(c,"drop",function(c){c.preventDefault();b.get(a.uid).dragDrop(c)&&c.stopPropagation()},this.uid),a.shimExec.call(this,"FileDrop","init")}}});l("moxie/runtime/silverlight/file/FileReader",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReader"],function(e,b,d){return e.FileReader=b.extend({},d)});l("moxie/runtime/silverlight/file/FileReaderSync",
["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReaderSync"],function(e,b,d){return e.FileReaderSync=b.extend({},d)});l("moxie/runtime/silverlight/xhr/XMLHttpRequest",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/xhr/XMLHttpRequest"],function(e,b,d){return e.XMLHttpRequest=b.extend({},d)});l("moxie/runtime/silverlight/runtime/Transporter",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/runtime/Transporter"],
function(e,b,d){return e.Transporter=b.extend({},d)});l("moxie/runtime/silverlight/image/Image",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/image/Image"],function(e,b,d){return e.Image=b.extend({},d,{getInfo:function(){var a=["tiff","exif","gps"],c={meta:{}},d=this.getRuntime().shimExec.call(this,"Image","getInfo");return d.meta&&b.each(a,function(a){var b=d.meta[a],e,f,h,l;if(b&&b.keys)for(c.meta[a]={},f=0,h=b.keys.length;h>f;f++)e=b.keys[f],(l=b[e])&&(/^(\d|[1-9]\d+)$/.test(l)?
l=parseInt(l,10):/^\d*\.\d+$/.test(l)&&(l=parseFloat(l)),c.meta[a][e]=l)}),c.width=parseInt(d.width,10),c.height=parseInt(d.height,10),c.size=parseInt(d.size,10),c.type=d.type,c.name=d.name,c}})});l("moxie/runtime/html4/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(e,b,d,a){var c={};return d.addConstructor("html4",function(b){var f=this,l=d.capTest,n=d.capTrue;d.call(this,b,"html4",{access_binary:l(window.FileReader||window.File&&
File.getAsDataURL),access_image_binary:!1,display_media:l(c.Image&&(a.can("create_canvas")||a.can("use_data_uri_over32kb"))),do_cors:!1,drag_and_drop:!1,filter_by_extension:l("Chrome"===a.browser&&28<=a.version||"IE"===a.browser&&10<=a.version),resize_image:function(){return c.Image&&f.can("access_binary")&&a.can("create_canvas")},report_upload_progress:!1,return_response_headers:!1,return_response_type:function(a){return"json"===a&&window.JSON?!0:!!~e.inArray(a,["text","document",""])},return_status_code:function(a){return!e.arrayDiff(a,
[200,404])},select_file:function(){return a.can("use_fileinput")},select_multiple:!1,send_binary_string:!1,send_custom_headers:!1,send_multipart:!0,slice_blob:!1,stream_upload:function(){return f.can("select_file")},summon_file_dialog:l("Firefox"===a.browser&&4<=a.version||"Opera"===a.browser&&12<=a.version||!!~e.inArray(a.browser,["Chrome","Safari"])),upload_filesize:n,use_http_method:function(a){return!e.arrayDiff(a,["GET","POST"])}});e.extend(this,{init:function(){this.trigger("Init")},destroy:function(a){return function(){a.call(f);
a=f=null}}(this.destroy)});e.extend(this.getShim(),c)}),c});l("moxie/runtime/html4/file/FileInput","moxie/runtime/html4/Runtime moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Events moxie/core/utils/Mime moxie/core/utils/Env".split(" "),function(e,b,d,a,c,f){return e.FileInput=function(){function e(){var c=this,s=c.getRuntime(),t,y,z,B,x,A;A=b.guid("uid_");t=s.getShimContainer();h&&(z=d.get(h+"_form"),z&&b.extend(z.style,{top:"100%"}));B=document.createElement("form");B.setAttribute("id",
A+"_form");B.setAttribute("method","post");B.setAttribute("enctype","multipart/form-data");B.setAttribute("encoding","multipart/form-data");b.extend(B.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"});x=document.createElement("input");x.setAttribute("id",A);x.setAttribute("type","file");x.setAttribute("name",p.name||"Filedata");x.setAttribute("accept",n.join(","));b.extend(x.style,{fontSize:"999px",opacity:0});B.appendChild(x);t.appendChild(B);b.extend(x.style,
{position:"absolute",top:0,left:0,width:"100%",height:"100%"});"IE"===f.browser&&10>f.version&&b.extend(x.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"});x.onchange=function(){var a;this.value&&(a=this.files?this.files[0]:{name:this.value},l=[a],this.onchange=function(){},e.call(c),c.bind("change",function C(){var a=d.get(A),b=d.get(A+"_form"),e;c.unbind("change",C);c.files.length&&a&&b&&(e=c.files[0],a.setAttribute("id",e.uid),b.setAttribute("id",e.uid+"_form"),b.setAttribute("target",
e.uid+"_iframe"))},998),x=B=null,c.trigger("change"))};s.can("summon_file_dialog")&&(y=d.get(p.browse_button),a.removeEvent(y,"click",c.uid),a.addEvent(y,"click",function(a){x&&!x.disabled&&x.click();a.preventDefault()},c.uid));h=A;t=z=y=null}var h,l=[],n=[],p;b.extend(this,{init:function(b){var f=this,h=f.getRuntime(),k;p=b;n=b.accept.mimes||c.extList2mimes(b.accept,h.can("filter_by_extension"));k=h.getShimContainer();(function(){var c,e;c=d.get(b.browse_button);h.can("summon_file_dialog")&&("static"===
d.getStyle(c,"position")&&(c.style.position="relative"),e=parseInt(d.getStyle(c,"z-index"),10)||1,c.style.zIndex=e,k.style.zIndex=e-1);c=h.can("summon_file_dialog")?c:k;a.addEvent(c,"mouseover",function(){f.trigger("mouseenter")},f.uid);a.addEvent(c,"mouseout",function(){f.trigger("mouseleave")},f.uid);a.addEvent(c,"mousedown",function(){f.trigger("mousedown")},f.uid);a.addEvent(d.get(b.container),"mouseup",function(){f.trigger("mouseup")},f.uid);c=null})();e.call(this);k=null;f.trigger({type:"ready",
async:!0})},getFiles:function(){return l},disable:function(a){var b;(b=d.get(h))&&(b.disabled=!!a)},destroy:function(){var b=this.getRuntime(),c=b.getShim(),b=b.getShimContainer();a.removeAllEvents(b,this.uid);a.removeAllEvents(p&&d.get(p.container),this.uid);a.removeAllEvents(p&&d.get(p.browse_button),this.uid);b&&(b.innerHTML="");c.removeInstance(this.uid);h=l=n=p=null}})}});l("moxie/runtime/html4/file/FileReader",["moxie/runtime/html4/Runtime","moxie/runtime/html5/file/FileReader"],function(e,
b){return e.FileReader=b});l("moxie/runtime/html4/xhr/XMLHttpRequest","moxie/runtime/html4/Runtime moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Url moxie/core/Exceptions moxie/core/utils/Events moxie/file/Blob moxie/xhr/FormData".split(" "),function(e,b,d,a,c,f,g,l){return e.XMLHttpRequest=function(){function e(a){var b=this,c,g,h,l=!1;if(p){if(c=p.id.replace(/_iframe$/,""),g=d.get(c+"_form")){c=g.getElementsByTagName("input");for(h=c.length;h--;)switch(c[h].getAttribute("type")){case "hidden":c[h].parentNode.removeChild(c[h]);
break;case "file":l=!0}c=[];l||g.parentNode.removeChild(g);g=null}setTimeout(function(){f.removeEvent(p,"load",b.uid);p.parentNode&&p.parentNode.removeChild(p);var c=b.getRuntime().getShimContainer();c.children.length||c.parentNode.removeChild(c);p=null;a()},1)}}var h,n,p;b.extend(this,{send:function(s,t){var y=this,z=y.getRuntime(),B,x,A,D;if(h=n=null,t instanceof l&&t.hasBlob()){if(D=t.getBlob(),B=D.uid,A=d.get(B),x=d.get(B+"_form"),!x)throw new c.DOMException(c.DOMException.NOT_FOUND_ERR);}else B=
b.guid("uid_"),x=document.createElement("form"),x.setAttribute("id",B+"_form"),x.setAttribute("method",s.method),x.setAttribute("enctype","multipart/form-data"),x.setAttribute("encoding","multipart/form-data"),x.setAttribute("target",B+"_iframe"),z.getShimContainer().appendChild(x);t instanceof l&&t.each(function(a,c){if(a instanceof g)A&&A.setAttribute("name",c);else{var d=document.createElement("input");b.extend(d,{type:"hidden",name:c,value:a});A?x.insertBefore(d,A):x.appendChild(d)}});x.setAttribute("action",
s.url);(function(){var c=z.getShimContainer()||document.body,d=document.createElement("div");d.innerHTML='<iframe id="'+B+'_iframe" name="'+B+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>';p=d.firstChild;c.appendChild(p);f.addEvent(p,"load",function(){var c;try{c=p.contentWindow.document||p.contentDocument||window.frames[p.id].document,/^4(0[0-9]|1[0-7]|2[2346])\s/.test(c.title)?h=c.title.replace(/^(\d+).*$/,"$1"):(h=200,n=b.trim(c.body.innerHTML),y.trigger({type:"progress",
loaded:n.length,total:n.length}),D&&y.trigger({type:"uploadprogress",loaded:D.size||1025,total:D.size||1025}))}catch(d){if(!a.hasSameOrigin(s.url))return void e.call(y,function(){y.trigger("error")});h=404}e.call(y,function(){y.trigger("load")})},y.uid)})();x.submit();y.trigger("loadstart")},getStatus:function(){return h},getResponse:function(a){if("json"===a&&"string"===b.typeOf(n)&&window.JSON)try{return JSON.parse(n.replace(/^\s*<pre[^>]*>/,"").replace(/<\/pre>\s*$/,""))}catch(c){return null}return n},
abort:function(){var a=this;p&&p.contentWindow&&(p.contentWindow.stop?p.contentWindow.stop():p.contentWindow.document.execCommand?p.contentWindow.document.execCommand("Stop"):p.src="about:blank");e.call(this,function(){a.dispatchEvent("abort")})}})}});l("moxie/runtime/html4/image/Image",["moxie/runtime/html4/Runtime","moxie/runtime/html5/image/Image"],function(e,b){return e.Image=b});(function(h){for(var b=0;b<h.length;b++){for(var d=f,a=h[b],c=a.split(/[.\/]/),k=0;k<c.length-1;++k)d[c[k]]===e&&(d[c[k]]=
{}),d=d[c[k]];d[c[c.length-1]]=n[a]}})("moxie/core/utils/Basic moxie/core/I18n moxie/core/utils/Mime moxie/core/utils/Env moxie/core/utils/Dom moxie/core/Exceptions moxie/core/EventTarget moxie/core/utils/Encode moxie/runtime/Runtime moxie/runtime/RuntimeClient moxie/file/Blob moxie/file/File moxie/file/FileInput moxie/file/FileDrop moxie/runtime/RuntimeTarget moxie/file/FileReader moxie/core/utils/Url moxie/file/FileReaderSync moxie/xhr/FormData moxie/xhr/XMLHttpRequest moxie/runtime/Transporter moxie/image/Image moxie/core/utils/Events".split(" "))}(this);
(function(f){var e={},p=f.moxie.core.utils.Basic.inArray;return function n(f){var b,d;for(b in f)d=typeof f[b],"object"!==d||~p(b,["Exceptions","Env","Mime"])?"function"===d&&(e[b]=f[b]):n(f[b])}(f.moxie),e.Env=f.moxie.core.utils.Env,e.Mime=f.moxie.core.utils.Mime,e.Exceptions=f.moxie.core.Exceptions,f.mOxie=e,f.o||(f.o=e),e})(this);(function(f,e,p){function l(d){function a(a,b,c){var d={chunks:"slice_blob",jpgresize:"send_binary_string",pngresize:"send_binary_string",progress:"report_upload_progress",
multi_selection:"select_multiple",dragdrop:"drag_and_drop",drop_element:"drag_and_drop",headers:"send_custom_headers",urlstream_upload:"send_binary_string",canSendBinary:"send_binary",triggerDialog:"summon_file_dialog"};d[a]?e[d[a]]=b:c||(e[a]=b)}var c=d.required_features,e={};if("string"==typeof c)b.each(c.split(/\s*,\s*/),function(b){a(b,!0)});else if("object"==typeof c)b.each(c,function(b,c){a(c,b)});else if(!0===c){0<d.chunk_size&&(e.slice_blob=!0);if(d.resize.enabled||!d.multipart)e.send_binary_string=
!0;b.each(d,function(b,c){a(c,!!b,!0)})}return e}var n=f.setTimeout,h={},b={VERSION:"2.1.2",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,FILE_DUPLICATE_ERROR:-602,IMAGE_FORMAT_ERROR:-700,MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:e.mimes,ua:e.ua,typeOf:e.typeOf,extend:e.extend,guid:e.guid,get:function(b){var a=[],c;"array"!==e.typeOf(b)&&(b=[b]);
for(var f=b.length;f--;)(c=e.get(b[f]))&&a.push(c);return a.length?a:null},each:e.each,getPos:e.getPos,getSize:e.getSize,xmlEncode:function(b){var a={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},c=/[<>&\"\']/g;return b?(""+b).replace(c,function(b){return a[b]?"&"+a[b]+";":b}):b},toArray:e.toArray,inArray:e.inArray,addI18n:e.addI18n,translate:e.translate,isEmptyObj:e.isEmptyObj,hasClass:e.hasClass,addClass:e.addClass,removeClass:e.removeClass,getStyle:e.getStyle,addEvent:e.addEvent,removeEvent:e.removeEvent,
removeAllEvents:e.removeAllEvents,cleanName:function(b){var a,c;c=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"];for(a=0;a<c.length;a+=2)b=b.replace(c[a],c[a+1]);return b=b.replace(/\s+/g,"_"),b=b.replace(/[^a-z0-9_\-\.]+/gi,""),b},buildUrl:function(d,a){var c="";return b.each(a,function(a,b){c+=(c?"&":"")+
encodeURIComponent(b)+"="+encodeURIComponent(a)}),c&&(d+=(0<d.indexOf("?")?"&":"?")+c),d},formatSize:function(d){function a(a,b){return Math.round(a*Math.pow(10,b))/Math.pow(10,b)}if(d===p||/\D/.test(d))return b.translate("N/A");var c=Math.pow(1024,4);return d>c?a(d/c,1)+" "+b.translate("tb"):d>(c/=1024)?a(d/c,1)+" "+b.translate("gb"):d>(c/=1024)?a(d/c,1)+" "+b.translate("mb"):1024<d?Math.round(d/1024)+" "+b.translate("kb"):d+" "+b.translate("b")},parseSize:e.parseSizeStr,predictRuntime:function(d,
a){var c,f;return c=new b.Uploader(d),f=e.Runtime.thatCan(c.getOption().required_features,a||d.runtimes),c.destroy(),f},addFileFilter:function(b,a){h[b]=a}};b.addFileFilter("mime_types",function(d,a,c){d.length&&!d.regexp.test(a.name)?(this.trigger("Error",{code:b.FILE_EXTENSION_ERROR,message:b.translate("File extension error."),file:a}),c(!1)):c(!0)});b.addFileFilter("max_file_size",function(d,a,c){d=b.parseSize(d);void 0!==a.size&&d&&a.size>d?(this.trigger("Error",{code:b.FILE_SIZE_ERROR,message:b.translate("File size error."),
file:a}),c(!1)):c(!0)});b.addFileFilter("prevent_duplicates",function(d,a,c){if(d)for(d=this.files.length;d--;)if(a.name===this.files[d].name&&a.size===this.files[d].size){this.trigger("Error",{code:b.FILE_DUPLICATE_ERROR,message:b.translate("Duplicate file error."),file:a});c(!1);return}c(!0)});b.Uploader=function(d){function a(){var a,c=0,d;if(this.state==b.STARTED){for(d=0;d<G.length;d++)a||G[d].status!=b.QUEUED?c++:(a=G[d],this.trigger("BeforeUpload",a)&&(a.status=b.UPLOADING,this.trigger("UploadFile",
a)));c==G.length&&(this.state!==b.STOPPED&&(this.state=b.STOPPED,this.trigger("StateChanged")),this.trigger("UploadComplete",G))}}function c(a){a.percent=0<a.size?Math.ceil(100*(a.loaded/a.size)):100;f()}function f(){var a,c;H.reset();for(a=0;a<G.length;a++)c=G[a],c.size!==p?(H.size+=c.origSize,H.loaded+=c.loaded*c.origSize/c.size):H.size=p,c.status==b.DONE?H.uploaded++:c.status==b.FAILED?H.failed++:H.queued++;H.size===p?H.percent=0<G.length?Math.ceil(100*(H.uploaded/G.length)):0:(H.bytesPerSec=Math.ceil(H.loaded/
((+new Date-O||1)/1E3)),H.percent=0<H.size?Math.ceil(100*(H.loaded/H.size)):0)}function g(){var a=E[0]||N[0];return a?a.getRuntime().uid:!1}function m(a,b){if(a.ruid){var c=e.Runtime.getInfo(a.ruid);if(c)return c.can(b)}return!1}function q(){this.bind("FilesAdded FilesRemoved",function(a){a.trigger("QueueChanged");a.refresh()});this.bind("CancelUpload",B);this.bind("BeforeUpload",w);this.bind("UploadFile",t);this.bind("UploadProgress",y);this.bind("StateChanged",z);this.bind("QueueChanged",f);this.bind("Error",
A);this.bind("FileUploaded",x);this.bind("Destroy",D)}function r(a,c){var d=this,f=0,g=[],h={runtime_order:a.runtimes,required_caps:a.required_features,preferred_caps:J,swf_url:a.flash_swf_url,xap_url:a.silverlight_xap_url};b.each(a.runtimes.split(/\s*,\s*/),function(b){a[b]&&(h[b]=a[b])});a.browse_button&&b.each(a.browse_button,function(c){g.push(function(g){var k=new e.FileInput(b.extend({},h,{accept:a.filters.mime_types,name:a.file_data_name,multiple:a.multi_selection,container:a.container,browse_button:c}));
k.onready=function(){var a=e.Runtime.getInfo(this.ruid);e.extend(d.features,{chunks:a.can("slice_blob"),multipart:a.can("send_multipart"),multi_selection:a.can("select_multiple")});f++;E.push(this);g()};k.onchange=function(){d.addFile(this.files)};k.bind("mouseenter mouseleave mousedown mouseup",function(b){M||(a.browse_button_hover&&("mouseenter"===b.type?e.addClass(c,a.browse_button_hover):"mouseleave"===b.type&&e.removeClass(c,a.browse_button_hover)),a.browse_button_active&&("mousedown"===b.type?
e.addClass(c,a.browse_button_active):"mouseup"===b.type&&e.removeClass(c,a.browse_button_active)))});k.bind("mousedown",function(){d.trigger("Browse")});k.bind("error runtimeerror",function(){k=null;g()});k.init()})});a.drop_element&&b.each(a.drop_element,function(a){g.push(function(c){var g=new e.FileDrop(b.extend({},h,{drop_zone:a}));g.onready=function(){var a=e.Runtime.getInfo(this.ruid);d.features.dragdrop=a.can("drag_and_drop");f++;N.push(this);c()};g.ondrop=function(){d.addFile(this.files)};
g.bind("error runtimeerror",function(){g=null;c()});g.init()})});e.inSeries(g,function(){"function"==typeof c&&c(f)})}function s(a,b,c){var d=new e.Image;try{d.onload=function(){if(b.width>this.width&&b.height>this.height&&b.quality===p&&b.preserve_headers&&!b.crop)return this.destroy(),c(a);d.downsize(b.width,b.height,b.crop,b.preserve_headers)},d.onresize=function(){c(this.getAsBlob(a.type,b.quality));this.destroy()},d.onerror=function(){c(a)},d.load(a)}catch(f){c(a)}}function u(a,c,d){function f(a,
c,d){var e=C[a];switch(a){case "max_file_size":"max_file_size"===a&&(C.max_file_size=C.filters.max_file_size=c);break;case "chunk_size":if(c=b.parseSize(c))C[a]=c,C.send_file_name=!0;break;case "multipart":(C[a]=c)||(C.send_file_name=!0);break;case "unique_names":(C[a]=c)&&(C.send_file_name=!0);break;case "filters":"array"===b.typeOf(c)&&(c={mime_types:c});d?b.extend(C.filters,c):C.filters=c;c.mime_types&&(C.filters.mime_types.regexp=function(a){var c=[];return b.each(a,function(a){b.each(a.extensions.split(/,/),
function(a){/^\s*\*\s*$/.test(a)?c.push("\\.*"):c.push("\\."+a.replace(RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})}),RegExp("("+c.join("|")+")$","i")}(C.filters.mime_types));break;case "resize":d?b.extend(C.resize,c,{enabled:!0}):C.resize=c;break;case "prevent_duplicates":C.prevent_duplicates=C.filters.prevent_duplicates=!!c;break;case "browse_button":case "drop_element":c=b.get(c);case "container":case "runtimes":case "multi_selection":case "flash_swf_url":case "silverlight_xap_url":C[a]=
c;d||(k=!0);break;default:C[a]=c}d||h.trigger("OptionChanged",a,c,e)}var h=this,k=!1;"object"==typeof a?b.each(a,function(a,b){f(b,a,d)}):f(a,c,d);d?(C.required_features=l(b.extend({},C)),J=l(b.extend({},C,{required_features:!0}))):k&&(h.trigger("Destroy"),r.call(h,C,function(a){a?(h.runtime=e.Runtime.getInfo(g()).type,h.trigger("Init",{runtime:h.runtime}),h.trigger("PostInit")):h.trigger("Error",{code:b.INIT_ERROR,message:b.translate("Init error.")})}))}function w(a,b){if(a.settings.unique_names){var c=
b.name.match(/\.([^.]+)$/),d="part";c&&(d=c[1]);b.target_name=b.id+"."+d}}function t(a,c){function d(){0<k--?n(f,1E3):(c.loaded=p,a.trigger("Error",{code:b.HTTP_ERROR,message:b.translate("HTTP Error."),file:c,response:F.responseText,status:F.status,responseHeaders:F.getAllResponseHeaders()}))}function f(){var m,r,s={},t;c.status===b.UPLOADING&&a.state!==b.STOPPED&&(a.settings.send_file_name&&(s.name=c.target_name||c.name),h&&l.chunks&&q.size>h?(t=Math.min(h,q.size-p),m=q.slice(p,p+t)):(t=q.size,m=
q),h&&l.chunks&&(a.settings.send_chunk_number?(s.chunk=Math.ceil(p/h),s.chunks=Math.ceil(q.size/h)):(s.offset=p,s.total=q.size)),F=new e.XMLHttpRequest,F.upload&&(F.upload.onprogress=function(b){c.loaded=Math.min(c.size,p+b.loaded);a.trigger("UploadProgress",c)}),F.onload=function(){400<=F.status?d():(k=a.settings.max_retries,t<q.size?(m.destroy(),p+=t,c.loaded=Math.min(p,q.size),a.trigger("ChunkUploaded",c,{offset:c.loaded,total:q.size,response:F.responseText,status:F.status,responseHeaders:F.getAllResponseHeaders()}),
"Android Browser"===e.Env.browser&&a.trigger("UploadProgress",c)):c.loaded=c.size,m=r=null,!p||p>=q.size?(c.size!=c.origSize&&(q.destroy(),q=null),a.trigger("UploadProgress",c),c.status=b.DONE,a.trigger("FileUploaded",c,{response:F.responseText,status:F.status,responseHeaders:F.getAllResponseHeaders()})):n(f,1))},F.onerror=function(){d()},F.onloadend=function(){this.destroy();F=null},a.settings.multipart&&l.multipart?(F.open("post",g,!0),b.each(a.settings.headers,function(a,b){F.setRequestHeader(b,
a)}),r=new e.FormData,b.each(b.extend(s,a.settings.multipart_params),function(a,b){r.append(b,a)}),r.append(a.settings.file_data_name,m),F.send(r,{runtime_order:a.settings.runtimes,required_caps:a.settings.required_features,preferred_caps:J,swf_url:a.settings.flash_swf_url,xap_url:a.settings.silverlight_xap_url})):(g=b.buildUrl(a.settings.url,b.extend(s,a.settings.multipart_params)),F.open("post",g,!0),F.setRequestHeader("Content-Type","application/octet-stream"),b.each(a.settings.headers,function(a,
b){F.setRequestHeader(b,a)}),F.send(m,{runtime_order:a.settings.runtimes,required_caps:a.settings.required_features,preferred_caps:J,swf_url:a.settings.flash_swf_url,xap_url:a.settings.silverlight_xap_url})))}var g=a.settings.url,h=a.settings.chunk_size,k=a.settings.max_retries,l=a.features,p=0,q;c.loaded&&(p=c.loaded=h?h*Math.floor(c.loaded/h):0);q=c.getSource();a.settings.resize.enabled&&m(q,"send_binary_string")&&~e.inArray(q.type,["image/jpeg","image/png"])?s.call(this,q,a.settings.resize,function(a){q=
a;c.size=a.size;f()}):f()}function y(a,b){c(b)}function z(a){if(a.state==b.STARTED)O=+new Date;else if(a.state==b.STOPPED)for(var c=a.files.length-1;0<=c;c--)a.files[c].status==b.UPLOADING&&(a.files[c].status=b.QUEUED,f())}function B(){F&&F.abort()}function x(b){f();n(function(){a.call(b)},1)}function A(d,e){e.code===b.INIT_ERROR?d.destroy():e.file&&(e.file.status=b.FAILED,c(e.file),d.state==b.STARTED&&(d.trigger("CancelUpload"),n(function(){a.call(d)},1)))}function D(a){a.stop();b.each(G,function(a){a.destroy()});
G=[];E.length&&(b.each(E,function(a){a.destroy()}),E=[]);N.length&&(b.each(N,function(a){a.destroy()}),N=[]);J={};M=!1;O=F=null;H.reset()}var L=b.guid(),C,G=[],J={},E=[],N=[],O,H,M=!1,F;C={runtimes:e.Runtime.order,max_retries:0,chunk_size:0,multipart:!0,multi_selection:!0,file_data_name:"file",flash_swf_url:"js/Moxie.swf",silverlight_xap_url:"js/Moxie.xap",filters:{mime_types:[],prevent_duplicates:!1,max_file_size:0},resize:{enabled:!1,preserve_headers:!0,crop:!1},send_file_name:!0,send_chunk_number:!0};
u.call(this,d,null,!0);H=new b.QueueProgress;b.extend(this,{id:L,uid:L,state:b.STOPPED,features:{},runtime:null,files:G,settings:C,total:H,init:function(){var a=this;"function"==typeof C.preinit?C.preinit(a):b.each(C.preinit,function(b,c){a.bind(c,b)});q.call(this);C.browse_button&&C.url?r.call(this,C,function(c){"function"==typeof C.init?C.init(a):b.each(C.init,function(b,c){a.bind(c,b)});c?(a.runtime=e.Runtime.getInfo(g()).type,a.trigger("Init",{runtime:a.runtime}),a.trigger("PostInit")):a.trigger("Error",
{code:b.INIT_ERROR,message:b.translate("Init error.")})}):this.trigger("Error",{code:b.INIT_ERROR,message:b.translate("Init error.")})},setOption:function(a,b){u.call(this,a,b,!this.runtime)},getOption:function(a){return a?C[a]:C},refresh:function(){E.length&&b.each(E,function(a){a.trigger("Refresh")});this.trigger("Refresh")},start:function(){this.state!=b.STARTED&&(this.state=b.STARTED,this.trigger("StateChanged"),a.call(this))},stop:function(){this.state!=b.STOPPED&&(this.state=b.STOPPED,this.trigger("StateChanged"),
this.trigger("CancelUpload"))},disableBrowse:function(a){M=a!==p?a:!0;E.length&&b.each(E,function(a){a.disable(M)});this.trigger("DisableBrowse",M)},getFile:function(a){var b;for(b=G.length-1;0<=b;b--)if(G[b].id===a)return G[b]},addFile:function(a,c){function d(a,b){var c=[];e.each(k.settings.filters,function(b,d){h[d]&&c.push(function(c){h[d].call(k,b,a,function(a){c(!a)})})});e.inSeries(c,b)}function f(a){var g=e.typeOf(a);if(a instanceof e.File){if(!a.ruid&&!a.isDetached()){if(!p)return!1;a.ruid=
p;a.connectRuntime(p)}f(new b.File(a))}else a instanceof e.Blob?(f(a.getSource()),a.destroy()):a instanceof b.File?(c&&(a.name=c),l.push(function(b){d(a,function(c){c||(G.push(a),m.push(a),k.trigger("FileFiltered",a));n(b,1)})})):-1!==e.inArray(g,["file","blob"])?f(new e.File(null,a)):"node"===g&&"filelist"===e.typeOf(a.files)?e.each(a.files,f):"array"===g&&(c=null,e.each(a,f))}var k=this,l=[],m=[],p;p=g();f(a);l.length&&e.inSeries(l,function(){m.length&&k.trigger("FilesAdded",m)})},removeFile:function(a){a=
"string"==typeof a?a:a.id;for(var b=G.length-1;0<=b;b--)if(G[b].id===a)return this.splice(b,1)[0]},splice:function(a,c){var d=G.splice(a===p?0:a,c===p?G.length:c),e=!1;return this.state==b.STARTED&&(b.each(d,function(a){if(a.status===b.UPLOADING)return e=!0,!1}),e&&this.stop()),this.trigger("FilesRemoved",d),b.each(d,function(a){a.destroy()}),e&&this.start(),d},bind:function(a,c,d){var e=this;b.Uploader.prototype.bind.call(this,a,function(){var a=[].slice.call(arguments);return a.splice(0,1,e),c.apply(this,
a)},0,d)},destroy:function(){this.trigger("Destroy");C=H=null;this.unbindAll()}})};b.Uploader.prototype=e.EventTarget.instance;b.File=function(){var d={};return function(a){b.extend(this,{id:b.guid(),name:a.name||a.fileName,type:a.type||"",size:a.size||a.fileSize,origSize:a.size||a.fileSize,loaded:0,percent:0,status:b.QUEUED,lastModifiedDate:a.lastModifiedDate||(new Date).toLocaleString(),getNative:function(){var a=this.getSource().getSource();return-1!==e.inArray(e.typeOf(a),["blob","file"])?a:null},
getSource:function(){return d[this.id]?d[this.id]:null},destroy:function(){var a=this.getSource();a&&(a.destroy(),delete d[this.id])}});d[this.id]=a}}();b.QueueProgress=function(){var b=this;b.size=0;b.loaded=0;b.uploaded=0;b.failed=0;b.queued=0;b.percent=0;b.bytesPerSec=0;b.reset=function(){b.size=b.loaded=b.uploaded=b.failed=b.queued=b.percent=b.bytesPerSec=0}};f.plupload=b})(window,mOxie);$.telligent=$.telligent||{};$.telligent.evolution=$.telligent.evolution||{};V("components composers events lib modules plugins lib.messageLinks lib.sheetProvider lib.sheet lib.actionSheet module.maxlength lib.touchEventAdapter".split(" "),
function(f,e,p,l,n,h,b,d,a,c,k,g,m,q){m(document).ready(function(){g.adapt();d.sheet=new a({parent:m("body"),enablePan:!0,maxHeightPerent:0.8,cssClass:"sheet",backgroundColor:"#333",backgroundOpacity:0.75,animationDuration:250,onOpening:function(){m.telligent.evolution.messaging.publish("sheet.opening")},onClosing:function(){m.telligent.evolution.messaging.publish("sheet.closing")},onOpened:function(){m.telligent.evolution.messaging.publish("sheet.opened")},onClosed:function(){m.telligent.evolution.messaging.publish("sheet.closed")}});
d.actionSheet=new c({sheet:d.sheet});(new b({parent:"body"})).handle("click");m.telligent.evolution.ui.render();k.shim();m.fn.evolutionValidation.init()})},jQuery,window)})();
